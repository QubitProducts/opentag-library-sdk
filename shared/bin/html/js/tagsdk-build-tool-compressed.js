(function(){Function.prototype.bind=Function.prototype.bind||function(b){var h=this;return function(){return h.apply(b,arguments)}}})();var global=this;try{global=(0,eval)("this")||function(){return this}()||window}catch(e$$12){}global.VERSION="1.0.2-b1";var EMPTY_FUN=function(){},UNDEF=void 0;global.APP_PATH=global.APP_PATH||"/";global.LIBRARIES_REPO_LOC=global.LIBRARIES_REPO_LOC||"/";
(function(){var b,h;(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),g=this,n=function(){},c=function(){return g.apply(this instanceof n?this:a,b.concat(Array.prototype.slice.call(arguments)))};n.prototype=this.prototype;c.prototype=new n;return c})})();var d={__anonymous__:!0},k=null;try{k=(0,eval)("this")||
function(){return this}()}catch(l){}var d=k,e=d.qubit||{};d.qubit||(d.qubit=e);if(e.VERSION&&"3.0.2-r6"!==e.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+e.VERSION)}catch(m){}e.VERSION="3.0.2-r6";try{module.exports=d}catch(p){}var r=function(){};(function(){function a(){}function b(c,f,g,n,e){c=c.split(".");var v=a.NAMESPACE_BASE||d,h=null,l=null;e&&(v=k);e=v;v=g||v;for(g=0;g<c.length-1;g+=1)l=c[g],v[l]=v[l]||{},v=v[l];h=v;l=c[c.length-1];k.TAGSDK_NS_OVERRIDE&&(n=!1);void 0!==
f?void 0!==h[l]&&n||(h[l]=f):h[l]=h[l]||{};f&&(f.CLASSPATH=c.join("."),c.splice(c.length-1,1),f.PACKAGE_NAME=c.join("."));return{root:e,object:h,instance:h[l]}}a.global=function(){return k};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,f,g,n){return b(a,f,g,n,!0)};a.namespace=function(a,f,g,n){return b(a,f,g,n,!1)};a.clientNamespace=function(c,f,g,n){return a.namespace(a.clientSpaceClasspath()+
"."+c,f,g,n)};a.clazz=function(c,f,g,n,b){a.namespace(c,f,n,!0);"function"===typeof g&&(f.SUPER=g,f.superclass=g,f.prototype=new g(b),f.prototype.SUPER=g,f.prototype.CLASS=f);c=c.split(".");f.prototype?(f.prototype.CLASSPATH=c.join("."),f.prototype.CLASS_NAME=c[c.length-1],c.splice(c.length-1,1),f.prototype.PACKAGE_NAME=c.join(".")):(f.CLASSPATH=c.join("."),f.STATIC_NAME=c[c.length-1],c.splice(c.length-1,1),f.PACKAGE_NAME=c.join("."));return f};a.clazz("qubit.Define",a);a.clientClazz=function(c,f,
g,n,b){return a.clazz(a.clientSpaceClasspath()+"."+c,f,g,n,b)};a.STANDARD_VS_NS="qubit.vs";a.vendorsSpaceClasspath=function(c){var f=e.VENDOR_SPACE_CP,f=void 0===f||null===f?a.STANDARD_VS_NS:f;return c?f?f+"."+c:c:f};var g=a.vendorsSpaceClasspath(),n;n=g?a.namespace(g,{},null,!0).instance:a.global();a.getVendorSpace=function(){return n};a.vendorNamespace=function(c,f,g,n){c=a.vendorsSpaceClasspath(c);return a.namespace(c,f,g,n)};a.vendorClazz=function(c,f,g,n,b){c=a.vendorsSpaceClasspath(c);return a.clazz(c,
f,g,n,b)}})();(function(){function a(a){}for(var b={},g=0;93>g;g++)b["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(g)]=g;e.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=b;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(g,c,f,b,q){if(f){var d=new Date;d.setTime(d.getTime()+864E5*
f);f="; expires="+d.toGMTString()}else f="";q||(g=a.encode(g),c=a.encode(c));g=g+"="+c+f+"; path=/;";b&&(g+=" domain="+b);document.cookie=g};a.get=function(g,c){for(var f=g+"=",b=document.cookie.split(";"),q=0;q<b.length;q++){for(var d=b[q];" "===d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(f))return f=d.substring(f.length,d.length),c||(f=a.decode(f)),f}return null};a.getAllForName=function(g,c){if(!g)return[];for(var f=g+"=",b=document.cookie.split(";"),q=[],d=0;d<b.length;d++){for(var e=
b[d];" "===e.charAt(0);)e=e.substring(1,e.length);0===e.indexOf(f)&&(e=e.substring(f.length,e.length),c&&(e=a.decode(e)),q.push(e))}return q};a.getAll=function(g){for(var c=document.cookie.split(";"),f=[],b=0;b<c.length;b++){for(var q=c[b];" "===q.charAt(0);)q=q.substring(1,q.length);var d=q.substring(0,q.indexOf("=")),q=q.substring(d.length+1,q.length);g&&(q=a.decode(q));f.push([d,q])}return f};a.rm=function(g,c){a.set(g,"",-1,c)}})();(function(){function a(){}function b(a,c){for(var g=q.length,
f=0;f<g;f++)if(a===q[f][0])return q[f][1];q[q.length]=[a,c];return!1}function g(a,c,f,n,A){var e=!1,h=!1,y=!1,t=!1,k=!1,l=k=!1;c&&(e=(k=!!c.all)||c.nodes,t=k||c.win,h=k,l=!!c.emptyForMaxDeep,y=c.noFunctions&&!k,void 0!==c.noOwn&&(h=!!c.noOwn),void 0!==c.noFunctions&&(y=!!c.noFunctions),void 0!==c.win&&(t=!!c.win),void 0!==c.nodes&&(e=!!c.nodes),k=!!c.copyReference);if(void 0===f||f)void 0!==f&&f--;else return l?void 0:a;if(!(a&&a instanceof Object))return a;if(!e){try{if(a instanceof Node)return a}catch(M){if(a instanceof
ActiveXObject&&void 0!==a.nodeType)return a}if(a===document)return a}if(!t&&a===d)return a;e=a instanceof Array?[]:{};a instanceof Date&&(e=new Date(a));!y&&a instanceof Function&&(y=String(a).replace(/\s+/g,""),e=y.indexOf("{[nativecode]}")+14===y.length?function(){return a.apply(A||this,arguments)}:function(){return a.apply(this,arguments)});void 0===n&&(q=[],n=0);if(y=b(a,e))return y;if(e instanceof Array)for(y=0;y<a.length;y++)e[e.length]=a[y]===a[y]?g(a[y],c,f,n+1,a):a[y];else{var y=0,B;for(B in a){if(h||
a.hasOwnProperty(B))e[B]=a[B]===a[B]?g(a[B],c,f,n+1,a):a[B];y++}}c.proto&&(e.prototype=g(a.prototype,c,f,n+1,a));k&&(e.___copy_ref=a);return e}function n(a,c,f,g,b,q,A,e){f=f||{};void 0===f.hasOwn&&(f.hasOwn=!0);if(!f.objectsOnly||a instanceof Object)if(void 0===e||e){void 0!==e&&e--;if(!f||!f.nodes)try{if(a instanceof Node)return}catch(v){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return}if(a!==d){void 0===g&&(h=[],g=0);var t;a:{for(t=0;t<g&&t<h.length;t++)if(a===h[t]){t=!0;break a}t=!1}if(!(t||
(h[g]=a,b=b||a,b&&q&&b[q]!==b[q]||c(a,b,q,A)))){q=0;t="";for(var k in a){if(!f.hasOwn||a.hasOwnProperty(k))try{var l=a[k];f.track&&(t=A?A+"."+k:k);n(l,c,f,g+1,b,k,t,e)}catch(B){}q++}}}}}var c=e.Define,f=e.Cookie,d=c.global();c.clazz("qubit.opentag.Utils",a);a.global=c.global;a.namespace=c.namespace;a.clazz=c.clazz;a.getObjectUsingPath=function(a,c){c=c||d;for(var f=a.split("."),g=0;g<f.length;g++)c&&f[g]&&(c=c[f[g]]);return c};a.getParentObject=function(c){var u=c.lastIndexOf(".");c=c.substring(0,
u);return a.getObjectUsingPath(c)};a.variableExists=function(a){return void 0!==a&&null!==a};a.ANON_VARS=[];a.getAnonymousAcessor=function(c){var u=a.indexInArray(c,a.ANON_VARS);-1===u&&(u=a.addToArrayIfNotExist(a.ANON_VARS,c));return"qubit.opentag.Utils.ANON_VARS["+u+"]"};a.replaceAll=function(a,c,f){return a.replace(new RegExp(c.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),f)};a.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};a.getUrl=
function(){return document.location.href};a.getQueryParam=function(c){var u,f,g,b;u=a.getUrl();if(0<u.indexOf("?"))for(b=u.substring(u.indexOf("?")+1).split("&"),u=0,f=b.length;u<f;u+=1)if(g=b[u],0<g.indexOf("=")&&(g=g.split("="),2===g.length&&g[0]===c))return g[1];return null};a.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:null};var q=[];a.objectCopy=function(a,c){c=c||{};var f=g(a,c,c.maxDeep);q=[];return f};var h=[];a.traverse=function(a,c,f){n(a,
c,f,void 0,void 0,void 0,void 0,f.maxDeep)};a.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};a.expressionToFunction=function(c,f){return a.gevalAndReturn("function ("+(f||"")+") {"+c+"}").result};a.defineWrappedClass=function(a,f,g,b,n){var q=function(){return n?n.apply(this,arguments):f.apply(this,arguments)};c.clazz(a,q,f,b);for(var A in g)g.hasOwnProperty(A)&&"CONSTRUCTOR"!==A&&(q.prototype[A]=g[A]);return q};a.copyAandAddFromB=function(a,c,f){a=this.objectCopy(a,
{maxDeep:f||8});for(var g in c)c.hasOwnProperty(g)&&(a[g]=c[g]);return a};a.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);var c=[],f;for(f in a)a.hasOwnProperty(f)&&(c[c.length]=f);return c}throw"keys() called on non-object!";};a.getSrcElement=function(a){var c;a=a||window.event;a.srcElement?c=a.srcElement:a.target&&(c=a.target);return c};a.addToArrayIfNotExist=function(a,c,f){for(var g=0,b=!1;g<a.length;g+=1)if(f&&f(a[g],c)||a[g]===c){b=!0;break}b||(a[a.length]=c,
g=-1);return g};a.indexInArray=function(a,c){for(var f=0,g=!1;f<a.length;f++)if(a[f]===c){g=!0;break}return g?f:-1};a.removeFromArray=function(a,c){for(var f=0,g=0;f<a.length;f+=1)a[f]===c&&(a.splice(f,1),g++);return g};a.addClass=function(c,f){var g;try{c.classList.add(f)}catch(b){null===c.className?c.className=f:(g=c.className.split(" "),a.addToArrayIfNotExist(g,f),c.className=g.join(" "))}};a.removeClass=function(c,f){var g;try{c.classList.remove(f)}catch(b){null===c.className?c.className="":(g=
c.className.split(" "),a.removeFromArray(g,f),c.className=g.join(" "))}};a.gevalAndReturn=function(c){var f=k;f.qubitopentagutilsgevalandreturn__var_test__=void 0;f.qubitopentagutilsgevalandreturn__var_test__error=void 0;a.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+c+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");c=f.qubitopentagutilsgevalandreturn__var_test__;var g=f.qubitopentagutilsgevalandreturn__var_test__error;try{f.qubitopentagutilsgevalandreturn__var_test__=
void 0,f.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete f.qubitopentagutilsgevalandreturn__var_test__,delete f.qubitopentagutilsgevalandreturn__var_test__error}catch(b){}return{result:c,error:g}};a.trim=function(a){try{return String(a).trim()}catch(c){return String(a).replace(/^\s+|\s+$/g,"")}};a.setIfUnset=function(a,c){if(a&&c)for(var f in c)c.hasOwnProperty(f)&&!a.hasOwnProperty(f)&&(a[f]=c[f])};a.overrideFromBtoA=function(a,c){if(a&&c)for(var f in c)c.hasOwnProperty(f)&&(a[f]=
c[f]);return a};a.geval=function(a){return window&&window.execScript?window.execScript(""===a?" ":a):d.eval.call(d,a)};var t=[];a.bodyAvailable=function(a){if(document.body){if(t){for(var c=0;c<t.length;c++)try{t[c]()}catch(f){}t=!1}a()}else t.push(a)};a.rmCookiesMatching=function(a){for(var c=f.getAll(),g=0;g<c.length;g++){var b=c[g][0];0===b.match(a)&&f.rm(b)}};var l=[],B=!1,m=!1;a.bodyReady=function(a){if(m)return a&&a(),!0;if(B=B||!(!document.body||"complete"!==document.readyState)){m=!0;for(var c=
0;c<l.length;c++)try{l[c]()}catch(f){}a&&a()}else a&&l.push(a);return B};var A=d.onload;d.onload=function(c){a.bodyReady();A&&A(c)};(function(){var c,f=!1,g=1,b,n,q,A;n=function(a){!0===a&&(g-=1);if(!g||!0!==a&&!f){if(!document.body)return setTimeout(n,1);f=!0;if(!0!==a&&(g-=1,0<g))return;for(;0<b.length;)a=b.shift(),a()}};A=function(){if(!f){try{document.documentElement.doScroll("left")}catch(a){setTimeout(A,1);return}n()}};q=function(){if(!b){b=[];if("complete"===document.readyState)return setTimeout(n,
1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",n,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",c);window.attachEvent("onload",n);var a=!1;try{a=null===window.frameElement||void 0===window.frameElement}catch(f){}document.documentElement.doScroll&&a&&A()}}};document.addEventListener?c=function(){document.removeEventListener("DOMContentLoaded",c,!1);n()}:document.attachEvent&&(c=function(){"complete"===document.readyState&&
(document.detachEvent("onreadystatechange",c),n())});(function(a){q();f?setTimeout(a,1):b.push(a)})(function(){B=!0;a.bodyReady()})})()})();(function(){function a(a){a&&(this._rate=a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}e.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&
(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var b=this.timers[a];if((new Date).valueOf()>=
b.time){try{b.execute()}catch(c){}this.timers.splice(a,1);--a}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=function(a,b,c){c||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},c=a.__maxFrequent__timer_opentag_qubit_);var f=c.____last__timed__max__frequent____;if(!f||(new Date).valueOf()-f>b)f=(new Date).valueOf(),c.____last__timed__max__frequent____=f,a()};a.prototype.runIfNotScheduled=function(a,
b,c){c=c||a;if(c.__lastRun__&&(new Date).valueOf()<b+c.__lastRun__)return this.schedule(a,b,c);c.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,b,c){if(c.___scheduled___)return!1;c.___scheduled___=(new Date).valueOf();this.setTimeout(function(){c.___scheduled___=!1;c.__lastRun__=(new Date).valueOf();a()},b);return!0};var b=1;a.prototype.setTimeout=function(a,n){var c={id:b++,time:(new Date).valueOf()+ +n,execute:a};this.timers.push(c);this.startPooling(n);return c};
a.prototype.setInterval=function(a,b){var c=setInterval(a,b);this.inervals.push(c);return c}})();(function(){e.Define.namespace("qubit.opentag.Timed",new e.opentag.Timer({rate:37,dynamic:!0}));var a=e.opentag.Timed;a.tillTrue=function(b,g,n){var c=function(){b()?g():a.setTimeout(c,n||33)};c()}})();var s;s=s||{};s.fileLoader={};s.fileLoader.load=function(a,b,g,n,c,f){var d,q,e,h;h=!1;e=function(c){return function(){h||(h=!0,c&&!q&&(q={url:document.location.href}),g(a,q,c))}};try{b&&(d=b(a))}catch(k){d=
!1,g(a,"Exception loading pre",!0)}finally{!1!==d&&(b=s.fileLoader.createScriptEl(a,c,!1,f),g&&(b.onload=e(!1),b.onerror=e(!0),b.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(function(){e(!1)()},1)}),n||(n=window.document.getElementsByTagName("head")[0]),n.appendChild(b))}};s.fileLoader.createScriptEl=function(a,b,g,n){var c,f=document.createElement("script");f.type="text/javascript";f.src=s.fileLoader.tidyUrl(a)+(g?"?"+(new Date).getTime():"");
!1!==b?(f.async="true",f.defer="true"):(f.async="false",!1!==f.async&&(f.async=!1),f.defer="false",!1!==f.defer&&(f.defer=!1));for(c in n)n.hasOwnProperty(c)&&f.setAttribute(c,n[c]);return f};s.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.config={order:0,include:!0,name:"Filter-"+g++,script:void 0,session:void 0};this.session=null;if(a){for(var f in a)a.hasOwnProperty(f)&&(this.config[f]=a[f]);a.session&&this.setSession(a.session);
this.register(this)}}var b=e.opentag.Utils,g=0,n=[];e.Define.clazz("qubit.opentag.filter.BaseFilter",a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var c=a.state.PASS;
if(this.config.disabled)return a.state.DISABLED;this.config.script&&(c=this.config.script.call(this,c));isNaN(+c)&&(c=a.state.FAIL);this.lastState=+c;return c};a.getFilters=function(){return n};a.prototype.register=function(){a.register(this)};a.register=function(a){b.addToArrayIfNotExist(n,a)}})();e.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",
ALL_URLS:"ALL_URLS"});(function(){function a(b){this._lockObject={};var c={patternType:g.CONTAINS,pattern:""};if(b)for(var f in b)b.hasOwnProperty(f)&&(c[f]=b[f]);a.SUPER.call(this,c)}var b=e.opentag.Utils,g=e.opentag.filter.pattern.PatternType;e.Define.clazz("qubit.opentag.filter.URLFilter",a,e.opentag.filter.BaseFilter);a.prototype.PATTERNS=g;a.prototype.getURL=function(a){return a||b.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var c=!0,f=this.config.pattern;switch(this.config.patternType){case g.CONTAINS:c=
0<=a.toLowerCase().indexOf(f.toLowerCase());break;case g.MATCHES_EXACTLY:c=a.toLowerCase()===this.config.pattern.toLowerCase();break;case g.STARTS_WITH:c=0===a.toLowerCase().indexOf(f.toLowerCase());break;case g.ENDS_WITH:c=a.lastIndexOf(f.toLowerCase())+f.length===a.length;break;case g.REGULAR_EXPRESSION:c=(new RegExp(f)).test(a);break;case g.ALL_URLS:c=!0}return c}})();(function(){function a(c){var f={};if(c){for(var g in c)c.hasOwnProperty(g)&&("customStarter"===g&&c[g]?this.customStarter=c[g]:
"customScript"===g&&c[g]&&(this.customScript=c[g]),f[g]=c[g]);this.uid="f"+n++}this.tagsToRun=[];a.SUPER.call(this,f)}var b=e.opentag.filter.BaseFilter,g=e.opentag.Utils,n=0;e.Define.clazz("qubit.opentag.filter.Filter",a,e.opentag.filter.URLFilter);a.prototype.customStarter=function(a,f,g){f(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(c){var f=
!0;try{this.customScript&&(void 0===this._matchState&&(this._matchState=!!this.customScript(this.getSession())),f=this._matchState)}catch(g){f=!1}return f&&a.SUPER.prototype.match.call(this,c)};a.prototype.runTag=function(c){g.addToArrayIfNotExist(this.tagsToRun,c);if(this.starterExecuted)!0===this.reRun?c.run():c.runOnce();else if(!this._starterWasRun){this._starterWasRun=!0;var f=function(a){this.reRun=a;this.starterExecuted=(new Date).valueOf();this._processQueuedTagsToRun()}.bind(this);this.customStarter?
this.customStarter(this.getSession(),f,c):a.prototype.customStarter(this.getSession(),f,c)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++){var f=this.tagsToRun[a];!0===this.reRun?f.run():f.runOnce()}};a.prototype.getState=function(c){c&&this.setSession(c);c=a.SUPER.prototype.getState.call(this);if(c===b.state.DISABLED)return b.state.DISABLED;c===b.state.PASS&&this.isSession()&&(c=b.state.SESSION);this.config.script&&(c=this.config.script.call(this,c,this.getSession()));
return this.lastState=c};a.prototype.reset=function(){this._matchState=void 0;a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=void 0;this.tagsToRun=[];this.reRun=void 0}})();s.GlobalEval={};s.GlobalEval.globalEval=function(a){window.execScript?window.execScript(""===a?" ":a):window.eval.call(window,a)};s.HtmlInjector={};s.HtmlInjector.inject=function(a,b,g,n,c){var f,d,q,e;if(0<=g.toLowerCase().indexOf("<script")){c=document.createElement("div");c.innerHTML="a"+g;d=c.getElementsByTagName("script");
q=[];g=0;for(f=d.length;g<f;g+=1)q.push(d[g]);e=[];g=0;for(f=q.length;g<f;g+=1){d=q[g];var h={attributes:s.HtmlInjector.getAttributes(d)};d.src?h.src=d.src:h.script=d.innerHTML;e.push(h);d.parentNode.removeChild(d)}c.innerHTML&&0<c.innerHTML.length&&(c.innerHTML=c.innerHTML.substring(1));s.HtmlInjector.doInject(a,b,c);s.HtmlInjector.loadScripts(e,0,n,a)}else c=document.createElement("div"),c.innerHTML=g,s.HtmlInjector.doInject(a,b,c),n&&n()};s.HtmlInjector.doInject=function(a,b,g){if(0<g.childNodes.length){for(var d=
document.createDocumentFragment();0<g.childNodes.length;)d.appendChild(g.removeChild(g.childNodes[0]));b?s.HtmlInjector.injectAtStart(a,d):s.HtmlInjector.injectAtEnd(a,d)}};s.HtmlInjector.injectAtStart=function(a,b){0===a.childNodes.length?a.appendChild(b):a.insertBefore(b,a.childNodes[0])};s.HtmlInjector.injectAtEnd=function(a,b,g){g||(g=1);a===document.body&&"complete"!==document.readyState&&50>g?setTimeout(function(){s.HtmlInjector.injectAtEnd(a,b,g+1)},100):a.appendChild(b)};s.HtmlInjector.loadScripts=
function(a,b,g,d){var c,f,e=!1;for(c=a.length;b<c;b+=1)if(f=a[b],f.src){e=!0;break}else s.GlobalEval.globalEval(f.script);e&&s.fileLoader.load(f.src,null,function(){s.HtmlInjector.loadScripts(a,b+1,g,d)},d,!1,f.attributes);g&&b===c&&g()};s.HtmlInjector.getAttributes=function(a){var b,g,d,c,f={};if(a){g=a.attributes;b=g.length;for(a=0;a<b;a++)d=g[a].value,c=g[a].name.toLowerCase(),""===d||"id"!==c&&"class"!==c&&"charset"!==c&&"data-"!==c.substr(0,5)||(f[c]=d);return f}};(function(){function a(){l=
l||{write:document.write,writeln:document.writeln}}function b(){document.write=l.write;document.writeln=l.writeln;l=null}var g=e.opentag.filter.BaseFilter,d=e.opentag.Utils,c=s.HtmlInjector,f=s.fileLoader,h=e.opentag.filter.Filter,q=function(){};e.Define.clazz("qubit.opentag.TagsUtils",q);var y=!1;q.bodyLoaded=function(){return y?!0:y=!(!document.body||"loading"===document.readyState)};q.bodyAvailable=function(a){return!!document.body};var t={};q.loadScript=function(a){var c=a.url,b=function(f,b,
g){t[c].error=b;g?(t[c].state="failure",a.onerror()):(t[c].state="success",a.onsuccess())};if(t[c]){if(a.noMultipleLoad)return b(c,t[c].error,"failure"===t[c].state);t[c].count+=1}else t[c]={count:1,state:null};var g=!a.async,d=q.bodyLoaded();g&&!d?q.writeScriptURL(c,function(a,f){b(c,f,!a)}):f.load(c,!1,b,a.node,a.async)};var l=null;q.redirectDocumentWritesToArray=function(c,f){a();document.write=function(a){c.push(a)};document.writeln=function(a){c.push(a)}};q.flushDocWritesArray=function(a,c,f,
b,g){if(c&&a){a=a.splice(0,a.length);try{return q.injectHTML(c,f,a.join("\n"),g||r),!0}catch(d){}}else return!1;g&&g();return!0};q.unlockDocumentWrites=function(){l&&b()};var B=q.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",m={};e.Define.namespace(B,m,k,!0);var A=0,w=(new Date).valueOf();q.writeScriptURL=function(c,g){var u="_"+w+"_"+A++,e=B+"."+u,h=!1;m[u]=function(a){h||(h=!0,a?g(!1,"error while loading script "+c):g(!0),m[u]=void 0,delete q.writeScriptURL.callbacks[u])};var y=
'if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+e+"(true)} catch (ex) {}}",k="try{"+e+"(false)}catch(ex){}",e="try{"+e+"(true)}catch(ex){}";c=f.tidyUrl(c);y="<script onload='"+k+"'  onerror='"+e+"' onreadystatechange='"+y+"' type='text/javascript'  src='"+c+"'>\x3c/script>";l?(b(),document.write(y),a()):document.write(y);d.bodyReady(function(){h||(h=!0,g(!0))})};q.writeScriptURL.callbacks={};var u=g.state.SESSION,C=g.state.PASS,z=g.state.FAIL;q.filtersState=function(a,
c,f,b){a=a.sort(function(a,c){try{var f=c.config.order,b=a.config.order;isNaN(-b)&&(b=0);isNaN(-f)&&(f=0);return f-b}catch(g){return 0}});var d=C;if(!a||0===a.length)return d;for(var d=null,w=!1,q=!1,A=0,e,n,y=[],k,t,l=0;l<a.length;l++)if(k=a[l],k.setSession(c),k.match())if(e=k.getState(),0<e){if(0===A||A>e)A=e}else e===g.state.DISABLED?w=!0:e===u?(q=!0,n=d=k,y.push(k)):d=k;else t=k;a=!1;null===d?(a=!0,d=w?C:z):d=d.config.include?e:e===C?z:C;0<A&&(d===C||a)&&(d=A);if(d===u||d===C&&q){if(!n.config.include)return z;
d=u;if(n instanceof h&&n.isSession()&&b)for(b=0;b<y.length;b++)try{y[b].runTag(f)}catch(v){}}f.config.dedupe&&d===C&&t&&t instanceof h&&t.isSession()&&(f.sendDedupePing=!0,d=z);return d};q.injectHTML=function(a,f,b,g){return c.inject(a,f?0:1,b,g||r)};q.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();
(function(){function a(b){this.config={};this.parameters=null;if(b){this.uniqueId="BV"+g++;a.ALL_VARIABLES[this.uniqueId]=this;for(var c in b)this.config[c]=b[c];void 0!==b.value&&(this.value=b.value);void 0!==b.defaultValue&&(this.defaultValue=b.defaultValue);return a.register(this)}}var b=e.opentag.Utils,g=0;e.Define.clazz("qubit.opentag.pagevariable.BaseVariable",a);a.ALL_VARIABLES={};a.pageVariables=[];a.register=function(b){if(b instanceof a){for(var c=0;c<a.pageVariables.length;c++){var f=a.pageVariables[c];
if(b===f)return f}a.pageVariables.push(b);return b}return null};a.prototype.getValue=function(){return this.value};a.prototype.setValue=function(a){this.value=a};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var c=b.variableExists(this.getValue());a&&(c=c||b.variableExists(this.getDefaultValue()));return c};a.prototype.getRelativeValue=function(a,c){var f=this.getValue();b.variableExists(f)||
(f=c);var g;a&&!b.variableExists(f)&&(g=this.getDefaultValue(),b.variableExists(g)&&(f=g));return f};a.prototype.replaceToken=function(a,c,f,g){var d=this.exists();f=d?this.getValue():f;a="\\$\\{"+a+"\\}";return g||f instanceof Array?(g=d?this.getValueAccessorString():b.getAnonymousAcessor(f),c.replace(new RegExp(a,"g"),g)):c.replace(new RegExp(a,"g"),f)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=
function(){return this.getAccessorString()+".getValue()"}})();(function(){function a(b){this._lockExprObject={};a.SUPER.apply(this,arguments)}var b=e.opentag.Utils;e.Define.clazz("qubit.opentag.pagevariable.Expression",a,e.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var g,d;try{if(-1===this.value.indexOf("[#]")){var c=b.gevalAndReturn(this.value);g=c.result;this.failMessage=null;d=c.error}else g=a.parseUVArray(this.value)}catch(f){d=f}d&&(g="could not read value of expression: \n"+
this.value+"\nexact cause: "+d,this.failMessage!==g&&(this.failMessage=g),g=null);return g};a.parseUVArray=function(a){var d=a.split("[#]");a=b.gevalAndReturn(d[0]).result;var c=[],d=d[1];0===d.indexOf(".")&&(d=d.replace(".",""));for(var f=0;f<a.length;f++){var e=b.getObjectUsingPath(d,a[f]);c.push(e)}return c};a.prototype.replaceToken=function(b,d,c,f){this.getValue()instanceof Array&&(f=!0);return a.SUPER.prototype.replaceToken.call(this,b,d,c,f)}})();(function(){function a(b){a.SUPER.apply(this,
arguments)}var b=e.opentag.Utils;e.Define.clazz("qubit.opentag.pagevariable.DOMText",a,e.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){return b.getElementValue(this.value)}})();(function(){function a(b){a.SUPER.apply(this,arguments);this._lockObject={}}var b=e.opentag.Timed;e.Define.clazz("qubit.opentag.pagevariable.Cookie",a,e.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=e.Cookie.get(this.value);b.maxFrequent(function(){}.bind(this),2E3,this._lockObject);
return a}})();(function(){function a(b){a.SUPER.apply(this,arguments)}var b=e.opentag.Utils;e.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,e.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){return b.getQueryParam(this.value)}})();(function(){function a(){}function b(a,c){var f=[];try{var g=a.parameters;if(g)for(var d=0;d<g.length;d++)a.getVariableForParameter(g[d])===c&&f.push(g[d])}catch(w){}return f}var g=e.opentag.Utils,d=e.opentag.TagsUtils,c=e.opentag.pagevariable.BaseVariable,
f=e.opentag.pagevariable.Expression,h=e.opentag.pagevariable.DOMText,q=e.opentag.pagevariable.Cookie,y=e.opentag.pagevariable.URLQuery;e.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,c,f,b){if(b=void 0!==b?b:a.getHtml()){var g="END"===a.config.locationPlaceHolder,w=d.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{w?d.injectHTML(w,g,b,function(){a.injectHTMLNotFinished=!1;if(c)try{c()}catch(b){}}.bind(a)):f&&"loading"===document.readyState?(document.write(b),a.injectHTMLNotFinished=
!1):a.injectHTMLFailed=(new Date).valueOf()}catch(u){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(a){for(var c=a.getPageVariables(),f=[],g=0;g<c.length;g++)for(var d=c[g],w=b(a,d),u=0;u<w.length;u++)f.push({parameter:w[u],variable:d});return f};a.allParameterVariablesReadyForTag=function(a,c){for(var f=!0,g=a.getPageVariables(),d=0;d<g.length;d++){var w=g[d];try{var u=b(a,w),e=w.exists();!e&&c&&(0<u.length&&(e=!!u[0].defaultValue),
e=e||w.exists(!0));if(!e){f=!1;break}}catch(q){f=!1;break}}return f};a.validateAndGetVariableForParameter=function(c){c.hasOwnProperty("variable")&&c.variable&&(c.variable=a.initPageVariable(c.variable));return c.variable};a.initPageVariable=function(a){if(!a||a instanceof c)return a;if("string"===typeof a){var b=g.getObjectUsingPath(a);if(b&&b instanceof c)return b}switch(a.type){case "2":return new f(a);case "3":return new y(a);case "4":return new q(a);case "5":return new h(a);case "EPRESSION":return new f(a);
case "URL_PARAMETER":return new y(a);case "COOKIE_VALUE":return new q(a);case "DOM_VALUE":return new h(a);default:return new c(a)}}})();(function(){function a(a){this.calls={}}var b=e.Define,g=e.opentag.Utils;a.prototype.on=function(a,c){this.calls[a]=this.calls[a]||[];return g.addToArrayIfNotExist(this.calls[a],c)};a.prototype.call=function(a){if(a=this.calls[a])for(var c=0;c<a.length;c++)try{a[c]()}catch(b){}};a.prototype.remove=function(a,c){return g.removeFromArray(this.calls[a],c)};a.prototype.removeAll=
function(a){var c=0,b;for(b in this.calls)this.calls.hasOwnProperty(b)&&(c+=g.removeFromArray(this.calls[b],a));return c};b.clazz("qubit.Events",a)})();(function(){function a(a){this.urlsFailed=this.urlsLoaded=0;this.events=new e.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+h++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,
locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1};this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=this.genericDependencies||[];if(a){if(!a.name){var c="Tag-"+h++;this.config.name=c}this.addState("INITIAL");for(var b in a)this.config[b]=a[b];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&
(this.dependencies=a.dependencies.concat(this.dependencies));a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function b(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),c=this._bodyNeededButNotAvailable();a||c?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?
(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?this._markLoadedSuccesfuly():(this.addState("TIMED_OUT"),this.loadingDependenciesFailed=(new Date).valueOf(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(b.bind(this),65)}}var g=e.opentag.Utils,d=e.opentag.TagsUtils,c=e.opentag.Timed,f=e.opentag.TagHelper,h=0;e.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=
r;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?this.config.html:this.htmlContent?g.trim(this.htmlContent):null};a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(c){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this._onError(c)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var c=+this.config.timeout,b=this.dependencies;
if(-1!==c&&0<b.length){var f=0;a=a||[];if(-1===g.indexInArray(a,this)){a[a.length]=this;for(var d=0;d<b.length;d++){var e=b[d]._getTimeout(a);e>f&&(f=e)}0<f&&(c+=f)}else return 0}return c};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=r;a.prototype._flushDocWrites=function(a){var c=!0;this._docWriteNotFlushed=!1;try{var b=d.getHTMLLocationForTag(this);b&&this._securedWrites&&0<this._securedWrites.length&&((c=d.flushDocWritesArray(this._securedWrites,b,"END"===this.config.locationPlaceHolder,
this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=(new Date).valueOf())}catch(f){this._onError(f)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(c=!1,this._docWriteNotFlushed=(new Date).valueOf());return c};a.prototype.log=r;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.onBefore()}catch(a){this._onError(a)}};a.prototype.onBefore=r;a.prototype.after=
function(a){this.afterRun=(new Date).valueOf();try{this.onAfter(a)}catch(c){this._onError(c)}};a.prototype.onAfter=function(a){};a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.runCounter=0;a.prototype.run=function(){if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;
this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=(new Date).valueOf();for(var a=this.dependencies,c=0;c<a.length;c++)try{a[c].events.on("success",
this._depLoadedHandler)}catch(b){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,c=0;c<a.length;c++)if(a[c]!==this&&!(0<+a[c].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,b){this._wasTimed=(new Date).valueOf();return c.setTimeout(a,b)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=function(){this.cancelled?this._handleCancel():this.loadedDependencies?
this.execute():this.loadingDependenciesFailed?(this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();a=!1;try{a=this.before()}catch(c){this._onError(c)}if(a){this._markFailure();
this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(b){this.executedWithErrors=
(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),d.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};
a.prototype.onFinished=r;a.prototype.onCancel=r;a.prototype.onFinished=r;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=
function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};
a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];
try{this.onStateChange(a)}catch(c){this._onError(c)}}};a.prototype.onStateChange=r;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){this._securedWrites||(this._securedWrites=[],d.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype.allDependenciesLoaded=
function(a,c){return 0===this.getDependenciesToBeLoaded(a,c).length};a.prototype.getDependenciesToBeLoaded=function(a,c){var b=c||[];this.injectionLocationReady()||b.push("injection location");var f,g=this.dependencies;for(f=0;f<g.length;f++)g[f]!==this&&(0<+g[f].scriptExecuted||b.push("dependant Tag with name -> "+(g[f].config?g[f].config.name:"anonymous")));for(f=0;f<this.genericDependencies.length;f++)this.genericDependencies[f](this)||b.push("this.genericDependencies["+f+"] (index: "+f+")");return b};
a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?!1:this._isBodyLocationNeeded()&&!d.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;
return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!g.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?
!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!d.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,c){return this.addDependenciesList(a,e.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(c,b){if(c&&0!==c.length){this.failedDependenciesToParse||
(this.failedDependenciesToParse=[]);for(var f=this.dependencies,d=0;d<c.length;d++){var e=c[d],h=!1;if(e instanceof a)f.push(e);else if("string"===typeof e){var A=e;b&&(e=b+"."+e);var w=g.getObjectUsingPath(e);w?w instanceof a?f.push(w):h=!0:this.failedDependenciesToParse.push(A)}else h=!0;h&&(this.badDepsObjects=this.badDepsObjects||[],g.addToArrayIfNotExist(this.badDepsObjects,e))}}};a.prototype._loadDependencies=function(a){a=a||[];var c=this.dependencies;if(-1===g.indexInArray(a,this)){a[a.length]=
this;for(var b=0;b<c.length;b++)c[b].load(a)}};a.prototype.onError=r;a.prototype._onError=function(a){try{this.onError(a)}catch(c){}};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=r;a.prototype.onScriptsLoadSuccess=r;a.prototype.onScriptLoadError=r;a.prototype.onAllDependenciesLoaded=r;a.prototype.onBeforeLoad=r;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");
try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(c){throw c;}b.call(this)}};a.prototype._singleUrlLoadHandler=function(a,c,b){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===c.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{b&&b(!0)}catch(f){this._onError(f)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);
this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,b&&b(!1)}catch(g){this._onError(g)}finally{this.onScriptLoadError(a)}}};a.prototype.loadURLs=function(a,c){var b=a||this.config.url;this.addState("LOADING_URL");try{!b||b instanceof Array||(b=[b]);for(var f=0;f<b.length;f++){this.loadURLsNotFinished=!0;var g=b[f],g=this.prepareURL(g);this.loadURL(g,function(a){this._singleUrlLoadHandler(a,b,c)}.bind(this))}}catch(d){this.loadURLsNotFinished=!1,
this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(d)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,c,b){this.addState("LOADING_URL");d.loadScript({onsuccess:function(){try{c&&c(!0)}catch(a){}}.bind(this),onerror:function(){try{c&&c(!1)}catch(a){}}.bind(this),url:a,node:b||this.config.urlLocation,async:this.isLoadingAsynchronously(),
noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=this.loadingTimedOut=this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=
void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=this._lastRun=this.isRunning=this.waitForDependenciesFinished=void 0;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};
a.prototype.injectHTML=function(a){var c=!this.docWriteAsksToWaitForBody(),b=this.prepareHTML(this.getHtml());b&&f.injectHTMLForLoader(this,a,c,b)};a.prototype.clone=function(){return new a(this.config)}})();(function(){function a(c){g.setIfUnset(c,{filterTimeout:c&&c.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:c&&c.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=
[];this.session=null;if(c){this.addState("INITIAL");try{a.register(this)}catch(b){}this.setupConfig(c);this.uniqueRefString=null;if(c.init)try{c.init.call(this,c)}catch(f){}this.onTagInit()}}function b(a,c){var g=a.namedVariables,d=f.initPageVariable(g[c]);return g[c]=d}var g=e.opentag.Utils,d=e.opentag.TagsUtils,c=e.opentag.filter.BaseFilter,f=e.opentag.TagHelper,h=e.opentag.pagevariable.BaseVariable,k=e.Cookie,l=e.Define;l.clazz("qubit.opentag.BaseTag",a,e.opentag.GenericLoader);a.prototype.setupConfig=
function(a){if(a){a.filters&&this.addFilters(a.filters);a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var c in a.variables)if(a.variables.hasOwnProperty(c)){var b=this.getParameterByTokenName(c);if(b){var f=a.variables[c];b.variable=f;void 0!==f.defaultValue&&(b.defaultValue=f.defaultValue);void 0!==f.uv&&(b.uv=f.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,c){var f=this.getParameterByTokenName(a);if(f)return void 0===c&&this.loadingTimedOut&&(c=!0),this.getParameterValue(f,
c);if((f=this.namedVariables)&&f[a]&&(f=b(this,a)))return f.getRelativeValue(c)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();if(this.config.runner){var a=!1;try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(c){}return a}this._runner=!1;return this.start()};
a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=
function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===c.state.SESSION)this.addState("AWAITING_CALLBACK"),
this.awaitingCallback=(new Date).valueOf();else if(a===c.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(b){}this.run()}else if(a===c.state.FAIL)this._markFiltersFailed(),this._markFinished();else if(0<a){var f=this.config.filterTimeout;if(0>f||(new Date).valueOf()-this.filtersRunTriggered>f){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(g){}}this._setTimeout(this.runIfFiltersPass.bind(this),
a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(d){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,
FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(c){a.SUPER.prototype.addState.call(this,c);try{a.onStateChange(this)}catch(b){}this.stateStack=[];c=this.STATE;var f=this.state,g=this.stateStack;f&c.INITIAL&&g.push("Initial state.");f&c.FILTER_ACTIVE&&g.push("Tag running with filters pass triggered.");f&c.FILTERS_FAILED&&g.push("Filters failed to pass.");f&c.AWAITING_CALLBACK&&g.push("Awaiting callback to run this tag. Not pooling.");
f&c.STARTED&&g.push("Tag is initialized and loading has been started.");f&c.LOADING_DEPENDENCIES&&g.push("Dependencies are being loaded.");f&c.LOADED_DEPENDENCIES&&g.push("Dependencies loading process has been finished.");f&c.LOADING_URL&&g.push("External URL is being loaded.");f&c.LOADED_URL&&g.push("External URL has been loaded.");f&c.EXECUTED&&g.push("Main script has been executed.");f&c.EXECUTED_WITH_ERRORS&&g.push("Main script has been executed but errors occured.");f&c.FAILED_TO_LOAD_DEPENDENCIES&&
g.push("Dependencies has failed to load.");f&c.FAILED_TO_LOAD_URL&&g.push("URL location failed to load.");f&c.FAILED_TO_EXECUTE&&g.push("Script failed to execute.");f&c.TIMED_OUT&&g.push("Script timed out awaiting for dependencies.");f&c.UNEXPECTED_FAIL&&g.push("Script occured UNEXPECTED exception and is failed.");f&c.CANCELLED&&g.push("Tag has been cancelled.")};a.prototype.onTagInit=r;a.onStateChange=r;a.prototype.onFiltersDelayed=r;a.prototype.onFiltersPassed=r;a.prototype.onFiltersCheck=r;a.prototype.state=
a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return f.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(c,b){var f=b||[];this.arePageVariablesLoaded(c)||f.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,c,f)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;
a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,l.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=this.addVariablesMap(a,l.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));return this.getPageVariables()};a.prototype.addVariablesMap=function(a,c){if(a){var b=
{},f=this.namedVariables,d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];if(e instanceof h)f[d]=e;else if("string"===typeof e){var k=e;c&&(e=c+"."+e);g.getObjectUsingPath(e)?f[d]=e:b[d]=k}}return b}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===
typeof this.config.script)this.script=this.config.script;else{var c=this.replaceTokensWithValues(String(this.config.script));this.script=g.expressionToFunction(c).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var c=this.parameters;if(c)for(var b=0;b<c.length;b++){var f=this.getVariableForParameter(c[b]);if(f){var g=c[b].token,d=this.valueForToken(g);a=f.replaceToken(g,a,d)}}return a};a.prototype.getParameter=
function(a){var c=this.parameters,b=null;if(c)for(var f=0;f<c.length;f++)c[f].name===a&&(b=c[f]);return b};a.prototype.setParameterValueByTokenName=function(a,c){var b=this.getParameterByTokenName(a);return null!==b?(b.variable={value:c},!0):!1};a.prototype.getParameterValue=function(a,c){var b="string"===typeof a?this.getParameter(a):a;if(b){var f=this.getVariableForParameter(b);if(f)try{var d;c&&""!==b.defaultValue&&(d=g.gevalAndReturn(b.defaultValue).result);return d=f.getRelativeValue(c,d)}catch(e){}}};
a.prototype.filtersState=function(a){return d.filtersState(this.filters,this.session,this,a)};a.prototype.addFilter=function(a){g.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var c=0;c<a.length;c++)this.addFilter(a[c])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,l.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=
null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=function(a,b){for(var f=[],d=0;d<a.length;d++)try{var e=a[d],h=null;"string"===typeof e&&(h=e,b&&(e=b+"."+e),e=g.getObjectUsingPath(e));"function"===typeof e&&(e=new e);!e instanceof c&&(e=null);e?this.addFilter(e):h&&g.addToArrayIfNotExist(f,h)}catch(k){this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[d])}return f};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this._runner=this.filtersRunTriggered=
this._runOnceIfFiltersPassTriggered=this.pingSent=this.dedupePingSent=this.filtersPassed=void 0};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=function(a){var c=null;if(this.parameters)for(var b=this.parameters,f=0;f<b.length;f++)b[f].token===a&&(c=b[f]);return c};a.prototype.removeFilter=function(a){g.removeFromArray(this.filters,a)};var t=0,m=[],B={},p={};a.register=function(a){var c=g.addToArrayIfNotExist(m,
a);a._tagIndex=-1===c?m.length-1:c;a.config.id?(c="Q"+a.config.id,p[c]=a,a.uniqueId=c):p[a.CLASSPATH]=a};a.getById=function(a){return p[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(c){a.unregister(c||this)};a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){g.removeFromArray(m,a);a._tagIndex=-1};a.getTags=function(){return m};a.getAccessorsMap=function(){return B};a.prototype.getTags=function(){return m};a.prototype.getPageVariables=
function(){var a=this.parameters,c=[];if(a)for(var f=0;f<a.length;f++){var d=this.getVariableForParameter(a[f]);null!==d&&g.addToArrayIfNotExist(c,d)}if(this.namedVariables)for(var e in this.namedVariables)g.addToArrayIfNotExist(c,b(this,e));return c};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+t++,B[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var c,
g=this.namedVariables;g&&g[a.token]&&(c=b(this,a.token));c||(c=f.validateAndGetVariableForParameter(a));return c};a.prototype.printVariablesState=function(){for(var a=[],c=f.getAllVariablesWithParameters(this),b=0;b<c.length;b++){var g=c[b].parameter,d=c[b].variable,e;e=g&&g.token?this.valueForToken(g.token):d.getRelativeValue(!0);g={name:d.config.name,exists:d.exists(),token:g?g.token:null,value:e,variable:d};a.push(g)}return a};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};
a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?this.config.id:0===String(this.CLASSPATH).indexOf(l.STANDARD_CS_NS)?this.CLASSPATH.substring(l.STANDARD_CS_NS.length+1):this.CLASSPATH+"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),c=!!k.get("qubit.tag.forceAllToRun");c||(c=!!k.get("qubit.tag.forceRunning_"+a));return c};a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();
k.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){k.set("qubit.tag.forceAllToRun","true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();k.set("qubit.tag.disableRunning_"+a,"true")};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();k.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!k.get("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=function(){k.rm("qubit.tag.forceAllToRun")};
a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();k.rm("qubit.tag.forceRunning_"+a)};a.rmAllDisablingCookies=function(){g.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=function(){g.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()}})();(function(){var a=e.opentag.Utils,b=e.opentag.filter.BaseFilter,g=function(){};e.Define.clazz("qubit.opentag.Tags",g);g.getById=function(a){return e.opentag.BaseTag.getById(String(a))};g.getAllTagsByState=
function(){return e.opentag.Container.getAllTagsByState(g.getTags())};g.findTagByName=function(a){for(var b=this.getTags(),g=[],d=0;d<b.length;d++)b[d].config.name===a&&g.push(b[d]);return g};g.findTagByMatch=function(a){for(var b=this.getTags(),g=[],d=0;d<b.length;d++)b[d].config.name.match(a)&&g.push(b[d]);return g};g.findTagContainers=function(a){for(var b=g.getContainers(),d=[],e=0;e<b.length;e++){var h=b[e].tags,k;for(k in h)if(h[k]===a){d.push(b[e]);break}}return d};g.getTags=function(){return e.opentag.BaseTag.getTags()};
g.resetAllTags=function(){for(var a=g.getTags(),b=0;b<a.length;b++)a[b].reset()};g.getContainersPageVariables=function(){for(var a=g.getContainers(),b=[],d=0;d<a.length;d++)b=b.concat(a.getPageVariables());return b};g.getAllPageVariables=function(){for(var a=g.getTags(),b=[],d=0;d<a.length;d++)b=b.concat(a[d].getPageVariables());return b};g.cancelAll=function(){for(var a=g.getTags(),b=0;b<a.length;b++)a[b].cancel()};g.resetAll=function(){for(var a=g.getTags(),b=0;b<a.length;b++)a[b].reset()};g.getPageVariableByName=
function(a){for(var b=g.getAllPageVariables(),d=[],e=0;e<b.length;e++)b[e].config.name===a&&d.push(b[e]);return d};g.getLoadTime=function(a){var b=a.beforeRun,g=a.runIsFinished;return isNaN(g)?{tag:a,loadTime:null}:{tag:a,loadTime:g-b}};g.getLoadTimes=function(a){var b=[];if(a instanceof e.opentag.BaseTag)return b.push([g.getLoadTime(a[d])]),b;a=a||g.getTags();if(a instanceof Array)for(d=0;d<a.length;d++)a[d]instanceof e.opentag.BaseTag&&b.push(g.getLoadTime(a[d]));else for(var d in a)a[d]instanceof
e.opentag.BaseTag&&b.push(g.getLoadTime(a[d]));return b};g.forceAllContainersAndTagsToRunIfDisabled=function(){e.opentag.Container.setCookieForDisabledContainersToRun();e.opentag.BaseTag.setCookieForcingTagsToRun()};g.rmAllContainersAndTagsForcingFlags=function(){e.opentag.Container.rmCookieForDisabledContainersToRun();e.opentag.BaseTag.rmAllCookiesForcingTagToRun()};g.getContainers=function(){return e.opentag.Container.getContainers()};g.findAllTagsByClassPath=function(c){var b=[],d=[];try{d.push(e.opentag.CustomTag),
d.push(e.opentag.LibraryTag)}catch(h){}for(var k=g.getTags(),n=0;n<k.length;n++){var l=k[n];0>a.indexInArray(d,l)&&0===l.PACKAGE_NAME.indexOf(c)&&b.push(l)}return b};g.findAllTags=function(a,b){var d=e.opentag.BaseTag,h=[];try{h.push(e.opentag.CustomTag),h.push(e.opentag.LibraryTag)}catch(k){}return g.findAllInstances(a,d,h,b)};var d=function(c,b,g,d){var e=[];"string"===typeof c&&(c=a.getObjectUsingPath(c));if(c){var h={objectsOnly:!0};d&&(h.maxDeep=!0);d=function(c,d,h,k){if(b(c)){for(d=0;d<g.length;d++)if(g[d]===
c)return!0;a.addToArrayIfNotExist(e,c);return!0}return!1}.bind(this);a.traverse(c,d,h)}return e};g.findAllInstances=function(a,b,g,e){return d(a,function(a){return a instanceof b},g,e)};g.findAllInheriting=function(a,b,g,e){return d(a,function(a){return a.prototype instanceof b},g,e)};g.findAllFilters=function(a,f){var d=[];try{d.push(e.opentag.filter.Filter),d.push(e.opentag.filter.URLFilter)}catch(h){}return g.findAllInheriting(a,b,d,f)}})();b={};h=void 0;b.update=function(){var a,b;b=function(){return Math.floor(1+
65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+b()+b()+b());return window.__pageViewId__};s.PostData=function(a,b,g){var d,c,f,e,h,k,l;l=2;h=!1;k=function(){0<l&&setTimeout(function(){h||(l-=1,d())},5E3)};c=navigator.userAgent.toLowerCase();f=-1!==c.indexOf("msie");c.indexOf("msie 9");c=-1!==c.indexOf("msie 7")||-1!==c.indexOf("msie 6");e=("https:"===document.location.protocol?"https:":"http:")+a;g=g||"POST";d=function(){var a;
try{a=null;try{a=new XMLHttpRequest}catch(c){}a&&!f?a.open(g,e,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(g,e)):a=null;try{a.withCredentials=!1}catch(d){}a.setRequestHeader&&a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");a.onload=function(){h=!0};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(b)}catch(n){try{try{s.fileLoader.load(e)}catch(w){window.console&&window.console.log&&window.console.log(n)}}catch(u){}}k()};
c?s.fileLoader.load(e):d()};(function(){function a(){}e.Define.clazz("qubit.opentag.Ping",a);a.prototype.send=function(d,g){for(var e=d.config,c="c="+e.clientId+"&p="+d.getContainerId()+"&l="+e.tellLoadTimesProbability+"&pv="+b.update()+"&d=",f=[],h=0;h<g.length;h++){var k=g[h].tag,l=g[h].loadTime;if(null!==l&&!isNaN(l)){var t=a.getPingID(k);!k.pingSent&&t&&null!==l&&void 0!==t&&(f.push('"'+t+'":'+l),k.pingSent=!0)}}e.pingServerUrl&&0<f.length&&(c+=encodeURIComponent("{"+f.join(",")+"}"),s.PostData("//"+
e.pingServerUrl+"/tag2?"+c,null,"GET"))};a.prototype.sendErrors=function(a,b){};a.prototype.sendDedupe=function(d,g){for(var e=d.config,c="c="+e.clientId+"&p="+d.getContainerId()+"&l="+e.tellLoadTimesProbability+"&pv="+b.update()+"&dd=",f=[],h=0;h<g.length;h++){var k=g[h],l=a.getPingID(k);void 0===l||k.dedupePingSent||(f.push(l),k.dedupePingSent=!0)}0<f.length&&e.pingServerUrl&&(c+=encodeURIComponent("["+f.join(",")+"]"),s.PostData("//"+e.pingServerUrl+"/tag2?"+c,null,"GET"))};a.getPingID=function(a){if(a.config.id)return a.config.id;
var b=a.PACKAGE_NAME.lastIndexOf(".");return-1!==b?a.PACKAGE_NAME.substring(b+1):a.PACKAGE_NAME}})();h={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var b,g;b=e.Cookie.get(h._cookieName);g=e.Cookie.get(h._sessionCookie);if(b){if(b=parseInt(b,10),!g||parseInt(g,10)<(new Date).getTime()-18E5)b+=1}else b=1;e.Cookie.set(h._cookieName,b,365,a);e.Cookie.set(h._sessionCookie,(new Date).getTime().toString(),null,a);return b}};var x={};(function(){function a(a){return 10>a?"0"+a:a}function b(a){c.lastIndex=
0;return c.test(a)?'"'+a.replace(c,function(a){var c=h[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function g(c,d){var h,l,n,w,u=f,q,z=d[c];if(z instanceof Date)h=z,z=isFinite(h.valueOf())?h.getUTCFullYear()+"-"+a(h.getUTCMonth()+1)+"-"+a(h.getUTCDate())+"T"+a(h.getUTCHours())+":"+a(h.getUTCMinutes())+":"+a(h.getUTCSeconds())+"Z":null;else if(z instanceof String||z instanceof Number||z instanceof Boolean)z=z.valueOf();"function"===typeof k&&
(z=k.call(d,c,z));switch(typeof z){case "string":return b(z);case "number":return isFinite(z)?String(z):"null";case "boolean":case "null":return String(z);case "object":if(!z)return"null";f+=e;q=[];if("[object Array]"===Object.prototype.toString.apply(z)){w=z.length;for(h=0;h<w;h+=1)try{q[h]=g(h,z)||"null"}catch(m){q[h]='{"stack_exceeded": null}'}n=0===q.length?"[]":f?"[\n"+f+q.join(",\n"+f)+"\n"+u+"]":"["+q.join(",")+"]";f=u;return n}if(k&&"object"===typeof k)for(w=k.length,h=0;h<w;h+=1){if("string"===
typeof k[h]){l=k[h];try{n=g(l,z)}catch(p){n='{"stack_exceeded": null}'}n&&q.push(b(l)+(f?": ":":")+n)}}else for(l in z)if(Object.prototype.hasOwnProperty.call(z,l)){try{n=g(l,z)}catch(r){n='{"stack_exceeded": null}'}n&&q.push(b(l)+(f?": ":":")+n)}n=0===q.length?"{}":f?"{\n"+f+q.join(",\n"+f)+"\n"+u+"}":"{"+q.join(",")+"}";f=u;return n}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f,e,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof x.stringify&&(x.stringify=function(a,c,b){var d;e=f="";if("number"===typeof b)for(d=0;d<b;d+=1)e+=" ";else"string"===typeof b&&(e=b);if((k=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return g("",{"":a})});"function"!==typeof x.parse&&(x.parse=function(a,c){function b(a,f){var d,g,e=a[f];if(e&&"object"===typeof e)for(d in e)Object.prototype.hasOwnProperty.call(e,
d)&&(g=b(e,d),void 0!==g?e[d]=g:delete e[d]);return c.call(a,f,e)}var f;a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+a+")"),"function"===typeof c?b({"":f},""):f;throw new SyntaxError("JSON.parse");})})();(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=
a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=d,this.dict=f}function b(a,c){for(var f in c)if(a===c[f])return f;return null}for(var d=[],h=Math.pow(2,8),c=0;c<h;c++)d.push(String.fromCharCode(c));for(var f={},h=0;h<d.length;h++)f[d[h]]=h;e.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var c=this.alphabet.length,b={},f=[],d=0,g=a.charAt(d++),e,h=this.dict;e=a.charAt(d++);){var k=g+e;if(h.hasOwnProperty(k)||b.hasOwnProperty(k))g=
k;else{var u=h.hasOwnProperty(g)?h[g]:b[g];if(void 0===u)throw"Dictionary base is to small for those contents: "+g;f.push(u);b[k]=c++;g=e}}""!==g&&f.push(b.hasOwnProperty(g)?b[g]:h[g]);return f};a.prototype.decode=function(a){for(var c=this.dict,f=this.alphabet.length,d,g={},e=b(a[0],c),h=e,k=[e],w=1;w<a.length;w++){var u=a[w];d=b(u,c);null===d&&(g.hasOwnProperty(u)&&(d=g[u]),null===d&&(d=h+e));k.push(d);e=d.charAt(0);g[f++]=h+e;h=d}return k.join("")}})();(function(){function a(a){}for(var b={},d=
0;45>d;d++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d)]=d;for(var h={},d=0;45>d;d++)h['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(d)]=d;for(var c={},d=0;45>d;d++)c["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(d);var f="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),k=f.length,l=new e.compression.LZW({});e.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,c){for(var b=
(c||l).encode(a),d=[],f=0;f<b.length;f++)d.push(String.fromCharCode(b[f]));return d.join("")};a.prototype.compressAnsi=function(a,b){for(var d=(b||l).encode(a),g=[],e=0;e<d.length;e++){var h;h=d[e];var w=0,u=0>h;u&&(h=-h);var n="",v=!0;do w=h%k,v?(n=c[f[w]],v=!1):n=f[w]+n,h=(h-w)/k;while(0<h);h=u?"-"+n:n;g.push(h)}return g.join("")};a.prototype.decompressAnsi=function(a,c){for(var d=[],f="",g=0;g<a.length;g++){var e=a.charAt(g);if(h.hasOwnProperty(e)){for(var e=f+e,f="",w=0,u=0,C=!0,z=0;z<e.length;z++){var m=
e.charAt(e.length-1-z);C&&(C=!1,m="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(h[m]));w+=b[m]*Math.pow(k,u++)}e=w;d.push(e)}else f+=e}return(c||l).decode(d)};a.prototype.decompress=function(a,c){for(var b=[],d=0;d<a.length;d++)b.push(a.charCodeAt(d));return(c||l).decode(b)}})();(function(){function a(a){for(var b=[],d=0;d<a.length;d++){var f=c(a[d][0]);b.push([new RegExp(f,"g"),"*"+a[d][1]])}return b}function b(a,c){for(var d=0;d<c.length;d++)if(c[d][1]===a)return c[d][0];return null}function d(c){this._regexDefs=
t;this._defs=m;c&&c.definitions&&(this._regexDefs=a(c.definitions),this._defs=c.definitions)}function h(a,c){for(var b=[],d=0;d<a.length;d++){var f=!0;c&&(f=a.charCodeAt(d)<=c);var g=l.cookieAlphabetMap.hasOwnProperty(a.charAt(d));f&&!g?b.push("*"+a.charCodeAt(d)+"."):b.push(a.charAt(d))}return b.join("")}function c(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function f(a){for(var c={},b="",d=0;d<a.length;d++){var f=a.charAt(d);p[f]?b+=f:(isNaN(c[b])&&(c[b]=a.split(b).length-1),b="")}a=
[];for(var g in c)c.hasOwnProperty(g)&&(b=c[g],b>=s&&g.length>=r&&a.push([g,b]));return a=a.sort(function(a,c){return a[0].length===c[0].length?0:c[0].length>a[0].length?1:-1})}var k=e.Define,l=e.Cookie,m=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww",
"10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'",
"i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],t=a(m);k.clazz("qubit.opentag.compression.Encoder",d);d.prototype.encode=function(a,b){for(var d=a.replace(/\*/g,"**"),g=f(d),e=0;e<this._regexDefs.length;e++)var k=this._regexDefs[e],d=d.replace(k[0],k[1]);d=d.replace(/;/g,"*-");d=d.replace(/&/g,"*.");d=d.replace(/\\/g,"*/");d=d.replace(/=/g,"*+");d=d.replace(/\n/g,"*N");d=d.replace(/ /g,"*_");d=d.replace(/\t/g,"*T");d=d.replace(/"/g,"*Q");e=f(d);e.concat(g);for(var g=
d.replace(/@/g,"@@"),k=[],l=0,q=0;l<e.length;l++){var v=new RegExp(c(e[l][0]),"g"),v=g.replace(v,"@"+q+"-");v!==g&&(k.push(e[l][0]),q++,g=v)}e=[g,k];g=e[1];(k=0<g.length)&&(d=e[0]);d=b?h(d,b):h(d);return k?"Y"+g.join("*")+"@"+d:"N"+d};for(var p={},k=0;65>k;k++)p["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(k)]=!0;var r=4,s=2;d.prototype.decode=function(a){var c=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var d=a.indexOf("@");if(0<=d&&(c=a.substring(1,
d),c=c.split("*"),a=a.substring(d+1),c&&0!==c.length&&a)){for(var d="",f=!1,g=!1,e="",h=0;h<a.length;h++){var k=a.charAt(h);"@"===k||f||g?f||g?(f=!1,"@"===k?d+="@":isNaN(+("-"+k))?g?(d=c&&"-"===k&&c[+e]?d+c[+e]:d+("@"+e+k),e="",g=!1):d+="@"+k:(g=!0,e+=k)):f=!0:d+=k}e&&(d+="@"+e);f&&(d+="@");a=d}}c="";f=d=!1;g="";for(e=0;e<a.length;e++)h=a.charAt(e),"*"===h||d||f?d||f?(d=!1,isNaN(+("-"+h))?f?(c="."===h?c+String.fromCharCode(+g):"-"===h&&b(g+"-",this._defs)?c+b(g+"-",this._defs):c+("*"+g+h),g="",f=
!1):"*"===h?c+="*":"-"===h?c+=";":"/"===h?c+="\\":"."===h?c+="&":"+"===h?c+="=":"N"===h?c+="\n":"_"===h?c+=" ":"T"===h?c+="\t":"Q"===h?c+='"':null!==b(h,this._defs)?(h=b(h,this._defs),c+=h):c+="*"+h:(g+=h,f=!0)):d=!0:c+=h;g&&(c+="*"+g);d&&(c+="*");return c}})();(function(){function a(a){this.testBinary=!1;this.binSupported=d;a&&(this.compressor=new e.compression.Compressor,this.encoder=new e.opentag.compression.Encoder({}))}var b=e.Cookie,d=!1;e.Define.clazz("qubit.opentag.compression.CookieCompressor",
a);a.prototype.compress=function(a,c){if("string"!==typeof a||""===a)return a;var d=this.encoder.encode(a),g;if(this.binSupported||this.testBinary){g=this.compressor.compress(d);g='"B'+this.encoder.encode(g,128)+'"';b.set("__qtag_test_bin__",g,void 0,void 0,!0);var e=b.get("__qtag_test_bin__",!0);b.rm("__qtag_test_bin__");e&&e!==g&&(g=null)}e=this.encoder.encode(this.compressor.compressAnsi(d));d=!c&&d.length<=e.length?"E"+d:"C"+e;return g&&g.length<d.length?g:d};a.prototype.decompress=function(a){if("string"!==
typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var c=a.charAt(0);a=a.substring(1);switch(c){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);default:throw"This code is not supported! Code: "+c;}}})();(function(){var a=e.Cookie,b=e.opentag.Utils,d=function(){};e.Define.clazz("qubit.opentag.Session",
d);var k=new e.opentag.compression.CookieCompressor({});d.readCompressedCookie=function(c){c=a.get(c,!0);return k.decompress(c)};d.setupSession=function(c){var f=c.config,e,l,m,t,p;e={};e.sessionCount=h.update(f.cookieDomain);p="qtag_"+c.getContainerId();var r="x_qtag_"+c.getContainerId();m=a.get(p);c=!!m;null===m&&(m=a.get(r,!0),m=k.decompress(m));if(m)try{m=x.parse(m)}catch(s){m={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else m={sc:0,sessionCount:0,
pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};l=(new Date).getTime();e.sessionCount!==parseInt(m.sc,10)?(m.sessionStartTime=l,m.sc=e.sessionCount,m.sessionCount+=1,m.referrer.push({url:d.getReferrer(),landing:b.getUrl().substring(0,300),time:l}),m.sessionLandingPage=b.getUrl().substring(0,300)):d.isReferrerDifferent()&&!d.referrerIsSameAsPrevious(m.referrer,l,18E5)&&(m.referrer.push({url:d.getReferrer(),landing:b.getUrl().substring(0,300),time:l}),m.sessionLandingPage=b.getUrl().substring(0,
300),m.sessionStartTime=l,m.sessionCount+=1);e.sessionCount=m.sessionCount;e.sessionStartTime=m.sessionStartTime;e.pageStartTime=l;m.pageViews+=1;e.pageViews=m.pageViews;e.sessionLandingPage=m.sessionLandingPage;e.referrer=m.referrer;5<e.referrer.length&&e.referrer.splice(2,e.referrer.length-5);t=x.stringify(m);for(l=0;k.compress(t).length>f.maxCookieLength&&5>l;)3<=m.referrer.length?m.referrer.splice(2,1):2===m.referrer.length?m.referrer=[m.referrer[0]]:1===m.referrer.length&&(m.referrer=[]),t=x.stringify(m),
l+=1;e.referrer=m.referrer;c&&a.rm(p);p=k.compress(t);a.rm(r);0<f.maxCookieLength&&a.set(r,p,365,f.cookieDomain,!0);e.setVariable=function(c,b,d){m.__v[c]=[b,d?d:0];c=k.compress(x.stringify(m));0<f.maxCookieLength?a.set(r,c,365,f.cookieDomain,!0):a.rm(r)};e.getCookie=function(c,b){var d=a.get(c,!0);if(d&&(b||0===c.indexOf("x_")))try{d=k.decompress(d)}catch(f){}else null!==d&&(d=a.decode(d));return d};e.getVariable=function(a){var c;if(a=m.__v[a])if(c=a[1],0===c||c>(new Date).getTime())return a[0];
return null};e.on=function(a,c,b){c.attachEvent?c.attachEvent("on"+a,b):c.addEventListener&&c.addEventListener(a,b,!1)};e.getTagCookie=function(){return d.readCompressedCookie(r)};return d.lastSession=e};d.referrerIsSameAsPrevious=function(a,f,e){var h,k;return 0<a.length?(h=d.getReferrer(),k=b.getUrl().substring(0,300),a=a[a.length-1],a.url===h&&a.landing===k&&a.time+e>f):!1};d.isReferrerDifferent=function(){var a,b;b=d.getReferrer();a=b.indexOf("://");if(-1===a)return!0;try{return 0!==b.substring(a+
3).indexOf(d.getDomain())?!0:!1}catch(e){return!0}};d.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};d.getDomain=function(){return document.location.host}})();(function(){function a(c){g.setIfUnset(c,a.defaultConfig);if(this.singleton){var b=e.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,d);if(b.__instance)return b.__instance;b.__instance=this}a.SUPER.call(this,c)}function b(a,d){var e=a.toString(),e=e.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,
""),e=e.substring(0,e.lastIndexOf("}")),e=e.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),e=e.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),e=e.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),e=e.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),e=e.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3"),e=
e.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3"),e=d.replaceTokensWithValues(e);g.geval(e)}var g=e.opentag.Utils,h=e.Define;e.Define.clazz("qubit.opentag.LibraryTag",a,e.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var c=this.config;
if(c&&c.pre)if("function"===typeof c.pre)this.pre=c.pre;else{var d=this.replaceTokensWithValues(String(c.pre));this.pre=g.expressionToFunction(d).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?b(this.pre,this):this.pre()}catch(e){return!0}return!1};a.prototype.after=function(c){a.SUPER.prototype.after.call(this,c);try{var d=this.config;if(d&&d.post)if("function"===typeof d.post)this.post=d.post;else{var e=this.replaceTokensWithValues(String(d.post));this.post=
g.expressionToFunction(e).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?b(this.post,this):this.post(c)}catch(h){}};a.define=function(c,b){c=c.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");c=e.Define.vendorsSpaceClasspath(c);var d={};b.getDefaultConfig&&(d=b.getDefaultConfig());var l=b.CONSTRUCTOR,m={},v;for(v in b)"config"!==v&&(m[v]=b[v]);m=e.opentag.Utils.defineWrappedClass(c,a,m,k,function(a){a=a||{};a=g.overrideFromBtoA(d,a);var c=
e.opentag.LibraryTag.call(this,a);l&&l.call(this,a);if(c)return c});v=h.STANDARD_VS_NS+".";0!==c.indexOf(v)&&g.namespace(v+c,m);return m};a.getLibraryByClasspath=function(a){return g.getObjectUsingPath(a,e.Define.getVendorSpace())}})();(function(){function a(){}var b=e.opentag.LibraryTag,d=e.Define;a.library=function(){return b.define.apply(b,arguments)};a.libraryRef=function(){return b.getLibraryByClasspath.apply(b.getLibraryByClasspath,arguments)};d.namespace("qubit.Quick",a)})();(function(){function a(c){this.runQueue=
[];this.tags={};this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1};this.ignoreTagsState=!1;if(c){this.setConfig(c);c.name||(this.config.name="Cont-"+s++);a.register(this);a.NO_PINGS&&(this.config.noPings=!0);this.ping=new e.opentag.Ping(this.config);var b=this.sendPings.bind(this);this._pingAsyncCallback=function(){k.setTimeout(b,5)};if(c.init)try{c.init.call(this,
c)}catch(d){}}return this}function b(a,c,d){a[d]&&(A[d]=A[d]||1,d+="("+A[d]+")",A[d]++);a[d]=c}var d=e.opentag.Utils,h=e.opentag.filter.BaseFilter,c=e.opentag.filter.Filter,f=e.opentag.BaseTag,k=e.opentag.Timed,l=e.opentag.Tags,m=e.opentag.Session,p=e.Cookie,s=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var c=a.getContainers(),b=0;b<c.length;b++)try{c[b].run()}catch(d){}}.bind(this)}catch(B){}e.Define.clazz("qubit.opentag.Container",a);var x=[];a.register=function(a){d.addToArrayIfNotExist(x,
a)};a.prototype.isTellingLoadTimes=function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=!0;this.unregister();if(a)for(var c in this.tags)a=this.tags[c],a instanceof f&&(a.destroy(),this.tags[c]=null,delete this.tags[c]);c=this.PACKAGE_NAME.split(".");c=c[c.length-1];a=d.getParentObject(this.PACKAGE_NAME);a[c]=null;delete a[c]};a.findContainersByName=function(a){for(var c=this.getContainers(),b=[],d=0;d<c.length;d++)c[d].config.name===
a&&b.push(c[d]);return b};a.getById=function(a){for(var c=this.getContainers(),b=0;b<c.length;b++)if(c[b].getContainerId()===a)return c[b];return null};a.prototype.unregister=function(c){a.unregister(this,c)};a.unregister=function(a,c){d.addToArrayIfNotExist(x,a);d.removeFromArray(x,a);if(c)for(var b in this.tags){var e=this.tags[b];e instanceof f&&(e.unregister(),this.tags[b]=null,delete this.tags[b])}};a.prototype.hasConsent=function(){return"Accepted"===p.get("qubitconsent")};a.prototype.register=
function(c){a.register(c||this)};a.getContainers=function(){return x};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){var c=a.config.name;if(!this.tags[c]){this.tags[c]=a;try{this.onTagRegistered(a)}catch(b){}}};a.prototype.registerTags=function(a){for(var c=0;c<a.length;c++)this.registerTag(a[c])};a.prototype.setConfig=function(a){for(var c in a)this.config[c]=a[c]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};
a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.getTagByname=function(a){return this.tags[a]};a.prototype.containerScriptLoadedSynchronously=function(){var a,c,b,d,f;d=document.getElementsByTagName("script");a=0;for(c=d.length;a<c;a+=1)if(b=d[a],(f=b.getAttribute("src"))&&0<f.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===b.getAttribute("async")&&(!1===b.getAttribute("defer")||""===b.getAttribute("defer")||null===b.getAttribute("defer"));
return!0};a.prototype.prepareSessionIfNeeded=function(){var b=this.config.trackSession;if(!0!==b&&!1!==b){var b=this.tags,d;for(d in b)if(b.hasOwnProperty(d)){for(var f=b[d].getFilters(),e=0;e<f.length;e++){var g=f[e];if(g instanceof c&&g.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}}else this.trackSession=b;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&(this.session=m.setupSession(this))};a.prototype.runTags=function(c,b){if(this.destroyed)throw"Container has been destroyed.";
if(b||!a.LOCKED&&!d.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(f){}var e=!this.containerScriptLoadedSynchronously(),h="runIfFiltersPass";c&&c.command&&(h=c.command);this.runningStarted=(new Date).valueOf();var l={};this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();for(var n=this.getTagsInOrder(),m=0;m<n.length;m++)try{var q=n[m],v=q.config.name;if(this.includedToRun(q)){var p=q.resolveDependencies();
if(0<p.length)for(var r=0;r<p.length;r++){var t=p[r],s=t.config.name;!l[s]&&this.tags[s]&&(l[s]=t,this._tagRunner(t,h,e))}l[v]||(l[v]=q,this._tagRunner(q,h,e))}}catch(y){}k.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),1100);this.waitForAllTagsToFinish()}};a.prototype.getTagsInOrder=function(){var a=[],c;for(c in this.tags){var b=this.tags[c],d=b.config.priority;if(0<+d){for(var f=0,e=0;e<a.length;e++){var g=a[e];if(g)if(g=+g.config.priority,0<g&&g>d)f++;else break}a.splice(f,0,b)}else a.push(b)}return a};
a.prototype._tagRunner=function(a,c,b){try{this.includedToRun(a)&&(b&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||this.session,a[c]())}catch(d){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(c){if(!c)return!1;var b=c.config;if(b.inactive||b.disabled&&!c.cookieSaysToRunEvenIfDisabled()||
c.disabledByCookie())return!1;b=a.consentIsGiven||!b.needsConsent||this.hasConsent();c=c.state===f.prototype.STATE.INITIAL;return this.ignoreTagsState||b&&c};a.prototype.scanForTags=function(a,c){a&&(this.tags={});var b;b=c&&"object"===typeof c?this.findAllTags(c):this.findAllTagsByClassPath();this.registerTags(b);return b};a.prototype.findAllTags=function(a,c){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllTags(a,c)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;
return l.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,c){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllFilters(a,c)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=(new Date).valueOf(),this.sendPingsNotTooOften(),
this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,k.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=r;a.prototype.resetAllTags=function(){for(var a in this.tags)this.tags.hasOwnProperty(a)&&this.tags[a].reset()};a.prototype.reset=function(){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=
void 0;this.resetAllTags()};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};k.runIfNotScheduled(this._pingAsyncCallback,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;if(this.isTellingLoadTimes()){var c=this.getAllTagsByState(),b=this,d;c.run&&(d=l.getLoadTimes(c.run),this.lastPingsSentTime=(new Date).valueOf(),this.ping.send(this,d));d=l.getLoadTimes();var f=[];for(a=0;a<d.length;a++)(function(a){a=d[a].tag;a.config.dedupe&&a.sendDedupePing&&
f.push(a)})(a);0<f.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,f));if(c.other){d=l.getLoadTimes(c.other);var e=[];for(a=0;a<d.length;a++)(function(a){var c=d[a].tag;e.push(d[a]);var f=c.onAfter;c.onAfter=function(a){f.call(c,a);b.sendPingsNotTooOften()}})(a);0<e.length&&this.ping.send(this,e)}if(c.awaiting){d=l.getLoadTimes(c.awaiting);var g=[];for(a=0;a<d.length;a++)(function(a){var c=d[a].tag;g.push(d[a]);var f=c.onAfter;c.onAfter=function(a){f.call(c,a);
b.sendPingsNotTooOften()}})(a);0<g.length&&this.ping.send(this,g)}}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){var c=null,d=null,e=null,g=null,k=null,l=null,m=f.prototype.STATE.EXECUTED_WITH_ERRORS,q;for(q in a){var p=a[q];if(p instanceof f){var r=p.config.name;0<p.scriptExecuted?(c=c||{},b(c,p,r)):p.locked?(l=l||{},b(l,p,r)):0>p.scriptExecuted||p.state>=m?(g=g||{},b(g,p,r)):p.filtersState()===h.state.SESSION||0<p.filtersState()?
(e=e||{},b(e,p,r)):p.config.needsConsent?(k=k||{},b(k,p,r)):(d=d||{},b(d,p,r))}}return{run:c,failed:g,awaiting:e,consent:k,locked:l,other:d}};var A={};a.prototype.allTagsFinished=function(){for(var a in this.tags)if(this.tags.hasOwnProperty(a)){var c=this.tags[a];if(c instanceof e.opentag.BaseTag){var b=c.filtersState();if(!c.config.disabled){var d=0>c.filtersState()&&!c.locked,f=!(c.finished()||c.config.runner&&!c.isRunning);if(d&&f&&(c=0<+c.awaitingDependencies,b!==h.state.SESSION&&!c))return!1}}}return!0};
a.prototype.getPageVariables=function(){var a=[],c;for(c in this.tags)if(this.tags.hasOwnProperty(c))for(var b=this.tags[c].getPageVariables(),f=0;f<b.length;f++)d.addToArrayIfNotExist(a,b[f]);return a};a.getPageVariableByName=function(a){for(var c=this.getAllPageVariables(),b=[],d=0;d<c.length;d++)c[d].config.name===a&&b.push(c[d]);return b};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=
function(){return!!p.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){p.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=function(){p.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){d.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){p.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=function(){p.rm("qubit.opentag.forceContainerRunning")}})();
(function(){function a(d){b.setIfUnset(d,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,d)}var b=e.opentag.Utils;e.Define.clazz("qubit.opentag.CustomTag",a,e.opentag.LibraryTag)})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},b,d="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(b,c,d){if(null===d)return"null"===c?!1:!0;if(void 0===
d)return c===d?!1:!0;c=x.parse(c);c=a._getNested(c,b);b=a._getNested(d,b);return!a._jsonIsEqual(c,b)};a._processCallbacks=function(){var b;if(a.early_callbacks&&0<a.early_callbacks.length){for(b=0;b<a.early_callbacks.length;b+=1)a.push(a.early_callbacks[b]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(b,c){for(var d=a._keyStringToArr(c),
e;0<d.length;)if(e=d.shift(),b.hasOwnProperty(e))b=b[e];else return;return b};a._jsonIsEqual=function(b,c){"string"!==typeof b&&(b=x.stringify(b,a._stripEvents));"string"!==typeof c&&(c=x.stringify(c,a._stripEvents));return b===c};a._stripEvents=function(a,c){if("events"!==a)return c};a._on=function(b,c){var d;d=b.split(":");b=d[0];d=d[1];a.callbacks[b]=a.callbacks[b]||[];d?a.callbacks[b].push({keyString:d,func:c}):a.callbacks[b].push({func:c})};a._trigger=function(d,c){var e,g;if(a.callbacks[d])for(e=
0;e<a.callbacks[d].length;e+=1)"function"===typeof a.callbacks[d][e].func&&((g=a.callbacks[d][e].keyString)?"change"===d&&a._targetChanged(g,a.currentUV,b)&&a.callbacks[d][e].func(c):a.callbacks[d][e].func(c))};a._eventsPush=function(d){var c,e;b.events[b.events.length]=d;d.time=d.time||(new Date).getTime();if(a.callbacks.event)for(c=0,e=a.callbacks.event.length,c;c<e;c+=1)a.callbacks.event[c].func(d);d.has_fired=!0};a._getUnfiredEvents=function(){for(var d=0,d=0;d<b.events.length;d+=1)b.events[d].has_fired||
(a.unfired_events.push(b.events.splice(d,1)[0]),d-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)b.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){b.events=b.events||[];-1!==b.events.push.toString().indexOf("[native code]")&&(b.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,b)&&(a._trigger("change",b),a.currentUV=x.stringify(b,a._stripEvents))};
a._setUVLocation=function(b){d=b;a._initUV()};a._initUV=function(){window[d]=window[d]||{events:[]};b=window[d];b.events||(b.events=[])};a.push=function(b){a._isArray(b)&&("on"===b[0]?a._on(b[1],b[2]):"trigger"===b[0]&&b[1]&&a._trigger(b[1]))};a.init=function(b,c){c&&(d=c);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,b||a.start()):c&&window.uv_listener._setUVLocation(d)};a.start=function(){a.currentUV=x.stringify(b,
a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};s.UVListener=a})();(function(){function a(){}function b(a,d,e){!e||void 0!==a[d]&&""!==a[d]&&null!==a[d]||(a[d]=e)}var d=e.Cookie,h=e.opentag.Utils;a.run=function(){var c=!1,b;b=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1;if(!b){b=!1;if(d.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))b=!0;!b&&(b=!1,d.get("opentag_debug")||
0<=document.location.href.indexOf("opentag_debug"))&&(b=!0);b&&(k.TAGSDK_NS_OVERRIDE=e.DEBUG_MODE?!1:!0,c=!0);e.DEBUG_MODE&&(k.TAGSDK_NS_OVERRIDE=!1);try{s.UVListener.init()}catch(h){}a.runAllContainers(c)}};a.runAllContainers=function(c){try{for(var d=e.opentag.Container.getContainers(),g=0;g<d.length;g++){var l=d[g],m=l.config;if(!l.runningStarted&&!l.configuredInMain){m.scanTags=!0;var p=h.getParentObject(l.PACKAGE_NAME).ClientConfig;p&&b(l.config,"clientId",p.id);var r=h.getParentObject(l.PACKAGE_NAME).SystemDefaults;
r&&(b(m,"pingServerUrl",r.pingServerUrl),b(m,"tellLoadTimesProbability",r.tellLoadTimesProbability));l.configuredInMain=!0;c?(l.destroy(!0),a.loadDebugVersion(l)):k.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=e.opentag.RUN_STOPPED_EXECUTON;e.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{l.run()}}}(l):l.run()}}}catch(s){}};a.loadDebugVersion=function(a){var b=document.createElement("script"),d,g=a.config.scriptURL,h;(h=e.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&
h.clientId?h=h.clientId:(h=a.PACKAGE_NAME.split("."),h=h[h.length-2].substring(1));a=a.getContainerId();g&&(d=g,d.lastIndexOf("-debug.js")!==d.length-9&&(d=d.substring(0,d.length-3),d+="-debug.js"));b.src=d&&"//d3c3cq33003psk.cloudfront.net/opentag-"+h+"-"+a+"-debug.js"!==d?d:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+h+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(b)};e.Define.namespace("qubit.opentag.Main",a)})();(function(){function a(b){a.SUPER.apply(this,arguments)}
e.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,e.opentag.pagevariable.Expression)})()})();function fitTextarea(b){"textarea"===b.tagName.toLowerCase()&&(b.style.overflow="hidden",b.style.height="0px",b.scrollHeight,b.style.height=25+b.scrollHeight+"px",b.style.overflow="")}function nextNode(b){for(;!b.tagName;)b=b.nextSibling;return b}
function toggleShowSibling(b,h){for(var d=h||b.nextSibling;d&&!d.style;)d=d.nextSibling;if(d){var k=!1;d.cmNode&&"none"===d.cmNode.style.display?(d.cmNode.style.display="",k=!0):d.cmNode||"none"!==d.style.display?(d.style.display="none",d.cmNode&&(d.cmNode.style.display="none")):(d.style.display="",k=!0,"TEXTAREA"===d.tagName&&attachEditor(d),fitTextarea(d));(d=b.children[0])&&"true"===d.getAttribute("plus")&&(d.innerHTML=k?"-":"+")}}
function attachEditor(b){b.cm=CodeMirror.fromTextArea(b,{lineNumbers:!0,mode:"javascript",theme:"ambiance",tabMode:"indent",matchBrackets:!0,extraKeys:{"Ctrl-Q":function(b){b.foldCode(b.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]});b.cm.on("change",function(){b.value=b.cm.getValue()});b.cmNode=b.nextSibling}
function getParametersAndConfigForTagNode(b,h,d){var k=b.getElementsByTagName("input");b=b.reference.config;for(var l=0;l<k.length;l++){if(!h&&-1!==k[l].className.indexOf("red"))return"red";if(void 0!==k[l].pindex){var e=k[l].pindex;b.parameters[e].inputVariable=k[l].value;b.parameters[e].variable=void 0;if(k[l].value)try{var m=qubit.opentag.Utils.gevalAndReturn(k[l].value),m=m?m.result:m;b.parameters[e].variable={value:m}}catch(p){logError("Error reading configuration"+p)}}else if(!d&&void 0!==k[l].cname)switch(e=
k[l].cname,e){case "url":case "html":case "urlLocation":case "vendor":case "imageUrl":case "url":b[e]=k[l].value;break;default:try{b[e]=qubit.opentag.Utils.gevalAndReturn(k[l].value).result}catch(r){}}}return d?{parameters:b.parameters}:b}function applyParametersAndConfigToTag(b,h){b.parameters=h.parameters;for(var d in h)b[d]=h[d]}
function classPath(b){if(b){b=b.split(".");for(var h=0;h<b.length;h++){var d=b[h],d=d.replace(/\s+/g,"_"),d=d.replace(/[\W+]/g,"");d.match(/^\d+/)&&(d="_"+d);b[h]=d}return b.join(".").replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".")}return b}function getLibraryReferenceNode(b){for(;null!==b&&!b.reference;)b=b.parentNode;return b}window.__tmp__qubit__test_page_8_=null;
function extractFunctionOrString(b){var h=qubit.opentag.Utils.trim(b);return 0===h.indexOf("function")?(qubit.opentag.Utils.geval("window.__tmp__qubit__test_page_8_="+h),window.__tmp__qubit__test_page_8_):b}var IS_IE=!1;-1!==navigator.appName.indexOf("Internet Explorer")&&(IS_IE=!0);
function getXMLHttpRequest(){var b;try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(h){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{b=new XMLHttpRequest}catch(k){throw"Your browser does not support AJAX!";}}}IS_IE?window.onerror=function(){}:b.onerror=function(){};return b}
function GET(b,h,d){var k=getXMLHttpRequest();k.onreadystatechange=function(){4===k.readyState&&h(k.responseText,k)};d=void 0===d?!0:d;try{k.onerror=function(b){logError("Error while sending GET:"+b)}}catch(l){}b=fakeParam(b);k.open("GET",b,d);k.send()}
function POST(b,h,d,k){var l=getXMLHttpRequest();l.onreadystatechange=function(){4===l.readyState&&d(l.responseText,l)};k=void 0===k?!0:k;try{l.onerror=function(b){logError("Error while sending POST:"+b)}}catch(e){}b=fakeParam(b);l.open("POST",b,k);l.setRequestHeader("Content-type","application/x-www-form-urlencoded");l.send(h)}function fakeParam(b){return b&&-1!==b.lastIndexOf("?")?b+"&fparam="+(new Date).getTime()*Math.random():b+"?fparam="+(new Date).getTime()*Math.random()}
function theProgressBar(b,h){var d=!1,k=document.getElementById("progress-bar-template").innerHTML;if(d)return!1;theProgressBar.title=b;var d=!0,l=document.createElement("div");l.className="progress-bar";l.innerHTML=k;document.body.appendChild(l);l.bar=l.children[0].children[0];l.titleNode=l.bar.children[0];l.titleNode.innerHTML=theProgressBar.title;l.progress=l.bar.children[1];var e=function(){var b=h();100<=b?(l.titleNode.innerHTML=theProgressBar.title+" 100% Done.",l.progress.style.width="100%",
setTimeout(function(){d=!1;document.body.removeChild(l)},200)):(l.titleNode.innerHTML=theProgressBar.title+" "+Math.floor(b)+"%",l.progress.style.width=Math.floor(b)+"%",setTimeout(e,20))};e();return!0}
function qconsole(){this.init=function(){if(!this.initialized){this.initialized=!0;var b=document.getElementById("console-template").innerHTML;this.container=document.createElement("div");this.container.className="qconsole";this.container.innerHTML=b;this.msgContainer=this.container.children[1];document.body.appendChild(this.container);this.msgContainer.scrollTop=this.msgContainer.scrollHeight;var h=this;this.container.ondblclick=function(){info("[double click] Clearing & hiding console...");h.clear();
h.hide()}}};this.log=function(b){var h=document.getElementById("console-msg-template").innerHTML,d=document.createElement("div");d.className="msg";d.innerHTML=h;d.msg=d.children[1];d.header=d.children[0];d.msg.innerHTML=" >>> "+b;this.msgContainer.appendChild(d);this.msgContainer.scrollTop=this.msgContainer.scrollHeight};this.clear=function(){this.msgContainer.innerHTML=""};this.show=function(){qubit.opentag.Utils.addClass(this.container,"shown");qubit.opentag.Utils.removeClass(this.container,"hidden");
this.hidden=!1};this.hide=function(){qubit.opentag.Utils.removeClass(this.container,"shown");qubit.opentag.Utils.addClass(this.container,"hidden");this.hidden=!0};this.init()}var Utils=qubit.opentag.Utils;
function runTagHandler(b){var h=getParametersAndConfigForTagNode(b);if("red"===h)logError("Please fill all highlighed parameter values.\n They are required for tag to run.",2E3);else{var d=APP_PATH+"getClassPath?classPath=libraries."+b.reference.PACKAGE_NAME+".local&file=UVConf.js";GET(d,function(k,l){var e=!0;200!==l.status&&(e=!1,log("UVConfig not found. Proceeding normally."));try{e&&(log("Evaluating UVConf.js from "+d),qubit.opentag.Utils.geval(k))}catch(m){error("Exception while running UVConf.js: "+
m)}finally{runTag(b,h)}})}}
function runTag(b,h){try{var d={},k=b.classReference,l=b.reference;applyParametersAndConfigToTag(d,h);try{for(var e=d.parameters,m=0;m<e.length;m++)for(var p=e[m],r=0;r<l.config.parameters.length;r++){var s=l.config.parameters[r];if(s.token===p.token){p.uv=s.uv;break}}}catch(x){}var a=l.preNode.value;String(a)!==l.config.pre&&String(a)!==String(l.pre)&&(d.pre=extractFunctionOrString(a));var v=l.postNode.value;String(v)!==l.config.post&&String(v)!==String(l.post)&&(d.post=extractFunctionOrString(v));
var g=l.scriptNode.value;String(g)!==l.config.script&&String(g)!==String(l.script)&&(d.script=extractFunctionOrString(g));var n=new k(d);info("triggering run() for "+n.config.name+" ...");n.run();info("Currently executed tag instance is exposed as <pre>window.instance<pre>Please open web console to see more logs.<br/>To view library the logs run:<pre>instance.log.rePrint(5);</pre>in web console.",5E3);window.instance=n}catch(c){logError("Error while executing configuration:"+c)}}
function saveConfig(b){b=getLibraryReferenceNode(b);var h=b.reference;b=getParametersAndConfigForTagNode(b,!0,!0);for(var d=0;d<b.parameters.length;d++)b.parameters[d].variable=void 0,delete b.parameters[d].variable;b=json.serialize({parameters:b.parameters},{prettyPrint:!0});d=h.PACKAGE_NAME+".local";b=encodeURIComponent("//:include tagsdk-current.js\n"+("qubit.opentag.Utils.namespace('"+d+"');\n")+d+".Config = "+b+";");POST(APP_PATH+"saveConfig","classPath=libraries."+h.PACKAGE_NAME+".local&config="+
b,function(b,d){var e=qubit.opentag.Utils.gevalAndReturn(b);e&&e.result.ok?info("Saved"):logError(b)})}
function saveNewVersion(b,h){(h||window.event).ignoreEvent=!0;b=getLibraryReferenceNode(b);var d=b.reference,k=prompt("Please enter the name of the new version, eg 'v1'.\n\n");if(k){var k=classPath(k),d=d.PACKAGE_NAME,l=d.split(".");POST(APP_PATH+"saveNewVersion","location=libraries&classPath="+d+"&version="+(l[0]+"."+l[1])+"."+k,function(b,d){var h=qubit.opentag.Utils.gevalAndReturn(b);h&&h.result.ok?(info("Created new version."),info("Rebuilding system...",1E4),rebuildAndReload()):logError("Error while creating new version: "+
b)})}}function rebuildAndReload(){if(window.buildLocationString){var b="path="+encodeURIComponent(window.buildLocationString);GET(APP_PATH+"rebuild?"+b,function(b,d){var k=qubit.opentag.Utils.gevalAndReturn(b);k&&k.result.ok?(info("System has been rebuilt for "+window.buildLocationString,1E4),info("Reloading page."),location.reload()):logError("Rebuild failed! "+b)})}}var editUVURL=LIBRARIES_REPO_LOC+"shared/templates/UVConf.js";
function editUVURLHandler(b){GET(editUVURL,function(h,d){200!==d.status?logError(h):editUV(b,h)})}function editUV(b,h){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME+".local","UVConf.js",!0,h)}function openInEditorHandler(b){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME,"Tag.js",!1)}
function openInEditorAndCreate(b,h,d,k){k="classPath="+b+"&file="+h+"&create="+!!d+"&data="+encodeURIComponent(k);POST(APP_PATH+"openInEditor",k,function(b,d){var h=qubit.opentag.Utils.gevalAndReturn(b);h&&h.result.ok||(logError(b),logError("Make sure that CLASSPATH of your library matches its location!"))})}
function reloadTagHandler(b){var h=qubit.opentag.Utils,d=b.reference,k=b.libraryWidget,l=b.classReference.versionClassPath,e="classPath=libraries."+d.PACKAGE_NAME+"&file=Tag.js";reloadTests(b);POST(APP_PATH+"getClassPath",e,function(e,p){200!==p.status&&logError("Error loading tag: "+e);try{var r=getParametersAndConfigForTagNode(b,!0,!0);try{h.getObjectUsingPath(d.PACKAGE_NAME).Tag=void 0}catch(s){}qubit.opentag.Utils.geval(e);var x=h.getObjectUsingPath(d.PACKAGE_NAME+".Tag");x.versionClassPath=l;
k.renderLibraryToNode(x,null,null,r)}catch(a){logError("Error loading tag: "+a)}})}function cancelEvent(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}var Utils=qubit.opentag.Utils,testSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/TestsSuite.js";function addEditTests(b){GET(testSuiteCodeTemplateURL,function(h,d){200!==d.status?logError(h):addEditStandardTests(b,h)})}
function addEditStandardTests(b,h){if(b=getLibraryReferenceNode(b)){var d=b.reference,k=h.replace("_PACKAGE_",d.PACKAGE_NAME),k=k.replace("_TAG_",d.PACKAGE_NAME+".Tag"),l=d.PACKAGE_NAME.split(".").join("/"),k=k.replace("_TAGPATH_",l+"/Tag.js");openInEditorAndCreate("libraries."+d.PACKAGE_NAME+".local","TestsSuite.js",!0,k)}}var bddSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/BDDSuite.js";
function addEditDescribeTests(b){GET(bddSuiteCodeTemplateURL,function(h,d){200!=d.status?logError(h):addEditBDDTests(b,h)})}function addEditBDDTests(b,h){if(b=getLibraryReferenceNode(b)){var d=b.reference,k=h.replace("_PACKAGE_",d.PACKAGE_NAME),k=k.replace("_TAG_",d.PACKAGE_NAME+".Tag"),l=d.PACKAGE_NAME.split(".").join("/"),k=k.replace("_TAGPATH_",l+"/Tag.js");openInEditorAndCreate("libraries."+d.PACKAGE_NAME+".local","BDDSuite.js",!0,k)}}function reloadTests(b){_reloadTest(b,"BDDSuite.js")}
function _reloadTest(b,h){var d=qubit.opentag.Utils,k=b.reference,l=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+k.PACKAGE_NAME+".local&file="+h,function(e,h){200!==h.status&&log("Error loading test (probably no tests). "+e);try{var p=getParametersAndConfigForTagNode(b,!0,!0);try{d.getObjectUsingPath(k.PACKAGE_NAME).local.TestsSuite=void 0}catch(r){}qubit.opentag.Utils.geval(e);var s=d.getObjectUsingPath(k.PACKAGE_NAME+".Tag");l.renderLibraryToNode(s,null,null,p)}catch(x){log("Error loading test: "+
x)}finally{reloadBDDTests(b)}})}
function reloadBDDTests(b){var h=qubit.opentag.Utils,d=b.reference,k=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+d.PACKAGE_NAME+".local&file=BDDSuite.js",function(l,e){200!==e.status&&log("Error loading test (probably no tests). "+l);try{var m=getParametersAndConfigForTagNode(b,!0,!0);try{h.getObjectUsingPath(d.PACKAGE_NAME).local.BDDSuite=void 0}catch(p){}qubit.opentag.Utils.geval(l);var r=h.getObjectUsingPath(d.PACKAGE_NAME+".Tag");k.renderLibraryToNode(r,null,null,m)}catch(s){log("Error loading test: "+
s)}})}var testsRunning=!1;
function runAllTests(b){if(testsRunning)info("Wait for currently running tests to finish.");else{testsRunning=!0;for(var h=document.getElementsByTagName("div"),d=0,k=0,l=[],e=0;e<h.length;e++){var m=h[e];"true"===m.getAttribute("library-node")&&(++d,l.push(m))}var p=function(e){try{var h=l[e];h&&runTestsHandler(h,function(){++k;k<d&&setTimeout(function(){p(k)},5);k===d&&(testsRunning=!1,b&&b())})}catch(m){}};p(0);theProgressBar("Running test suites...",function(){return 0===k?0:k/d*100})}}
function runTestsHandler(b,h){try{var d=b.reference,k=qubit.opentag.Utils,l=k.getObjectUsingPath(d.PACKAGE_NAME+".local.TestsSuite"),e=k.getObjectUsingPath(d.PACKAGE_NAME+".local.BDDSuite"),m=function(){var d=!1;l&&!l.isFinished()?d=!0:e&&!e.isFinished&&(d=!0);if(!d){d=!1;if(e)for(var m=e.children,p=0;p<m.length;p++)if("failed"===m[p].result.status){d=!0;break}m=!1;l&&l.failedTests&&0<l.failedTests.length&&(m=!0);if(e||l)m||d?k.addClass(b,"tests-failed"):k.addClass(b,"tests-passed");h&&h()}};l||e?
(l&&runSuite(l,m),e&&runBDDSuite(e,m)):(h&&h(),k.addClass(b,"tests-notests"),log("No tests detected for "+d.config.name))}catch(p){logError("Error while executing tests suite:"+p)}}function runSuite(b,h){b?(b.onFinished=function(){h&&h()},b.run()):h&&h()}function runBDDSuite(b,h){if(b){var d=b.resultCallback;b.resultCallback=function(){d.apply(b,arguments);b.isFinished=!0;if(h)try{h()}catch(k){window.log("Error while running test:"+k)}};b.execute()}else h&&(b.isFinished=!0,h())}Utils=qubit.opentag.Utils;
function toggleUVSelector(b){"Close UV Browser"===b.innerHTML?(document.getElementById("uv-selector-holder").innerHTML="",b.innerHTML="Browse UV"):(openUVVariableSelector(),b.innerHTML="Close UV Browser")}function openUVVariableSelector(){var b=document.getElementById("uv-selector-holder");b.innerHTML="";renderUVSelector(b)}var uvPopupTemplate=document.getElementById("uv-popup-template").innerHTML;
function renderUVSelector(b,h){b.innerHTML="";var d=document.createElement("div");d.innerHTML=uvPopupTemplate;b.appendChild(d);var k=d.children[0].children[1].children[0].children[0],l=d.children[0].children[2];loadUVVariables(function(){for(var b=window.UVS,d=0;d<b.length;d++)(function(b){b.onclick=function(){l.value=b.expr;l.className="result";h&&h(b.expr)}})(renderUVSelectorItemYoNode(k,b[d]))})}var uvPopupItemTemplate=document.getElementById("uv-popup-item-template").innerHTML;
function renderUVSelectorItemYoNode(b,h){var d=document.createElement("div");d.innerHTML=uvPopupItemTemplate;var k=d.children[0].children[1];d.children[0].children[0].innerHTML=h.name;k.innerHTML=h.description;d.expr=h.expression;b.appendChild(d);return d}
function loadUVVariables(b){window.UVS?b&&b(UVS):GET(LIBRARIES_REPO_LOC+"shared/bin/html/data/uv.data",function(h,d){200!==d.status&&log("Error loading UV data: "+h);try{for(var k=h.split("\n"),l=[],e={},m=0;m<k.length;m++){var p=k[m].split("\t"),r={name:p[1],expression:p[2],description:p[3]};e[r.expression]=r;l.push(r)}window.UVS=l;window.EUVS=e;b(l)}catch(s){logError("Error loading UVs: "+s)}})}
(function(){function b(a,b){for(var d=0;d<b.length;d++)if("function"===typeof b[d]&&a instanceof b[d])return!0;return!1}function h(a,b){for(var d=0;d<b.length;d++)if(typeof a===b[d])return!0;return!1}function d(a,b){for(var d=0;d<b.length;d++)b[d]===a&&b.splice(d,1);return b}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}function l(a,b){return a?" "+b:b}function e(a,b,d,e,c){var f=" ";""===d&&(f="");return(d||e?0===c.length?[f,a,c.join(","),b]:[f,a,"\n",d,p,c.join(",\n"+
d+p),"\n",d,b]:[a,c.join(","),b]).join("")}var m={};m.checkIfInstanceOf=b;var p="  ",r=function(a,m,g,n,c){if(isNaN(c)||!(n>=c)){var f,s,q,y,t=!1,x,B=!0,G=!1,A=!1,w=!1,u=!1;m&&(m.prettyPrint&&(u=!0),m.raw&&(G=m.raw),m.excludedInstances&&(f=m.excludedInstances),m.excludedTypes&&(s=m.excludedTypes),m.excludedNames&&(q=m.excludedNames),m.own&&(y=m.hasOwn),m.fakeFunctions&&(A=m.fakeFunctions),m.realFunctions&&(w=m.realFunctions),m.includeFunctions&&(t=m.includeFunctions),m.excludeOnTrue&&(x=m.excludeOnTrue),
m.dateAsString&&(B=m.dateAsString));var C="",z="";if(u){for(u=0;u<n;u++)C+=p;z="\n"}if(a instanceof Date)return!G||B?k(a.toISOString()):a.valueOf();if(t||"function"!==typeof a){if("number"===typeof a)return l(C,String(a));if("string"===typeof a)return l(C,k(a));if(null===a)return l(C,"null");if(void 0===a)return G?l(C,"undefined"):void 0;if("boolean"===typeof D)return l(C,String(a));if(t&&"function"===typeof a&&A)return"(function(){})";if(t&&"function"===typeof a&&w)return l(C,a.toString());a:{if(a instanceof
Object)for(D=0;D<g.length;D++)if(g[D]===a){D=!0;break a}D=!1}if(!D){g.push(a);++n;if(a instanceof Array){q=[];for(u=0;u<a.length;u++){if(x)try{if(x(a))continue}catch(N){}if(!f||!b(a,f))if(!s||!h(a,s)){try{var E=r(a[u],m,g,n,c)}catch(J){return d(a,g),k(String(J))}void 0!==E&&q.push(E)}}d(a,g);return e("[","]",C,z,q)}var E=[],F;for(F in a){var D=a[F];if(!y||a.hasOwnProperty(F)){if(x)try{if(x(a))continue}catch(O){}if(!f||!b(D,f))if(!s||!h(D,s)){if(t=q)a:{for(t=0;t<q.length;t++)if(F===q[t]){t=!0;break a}t=
!1}if(!t)try{var I=r(D,m,g,n,c);if(void 0!==I){var K='"'+F.replace(/\"/g,'\\"')+'":'+I;E.push(K)}}catch(L){return d(a,g),k(String(L))}}}}d(a,g);return e("{","}",C,z,E)}}}};m.serialize=function(a,b){var d;b&&(d=b.level);return r(a,b,[],0,d)};var s=(0,eval("this"))||function(){return this}()||this.window;m.parse=function(a){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,"")))throw"insecure json!";a="json.___tmp = ("+a+")";s.execScript?s.execScript(a):s.eval.call(s,a);return m.___tmp};
s.json=m;try{module.exports=m}catch(x){}})();
(function(){function b(b){b&&(this.parentContainer=b.parentContainer,this.container=b.container,this.className=b.className,this.maxTime=b.maxTime,this.closeable=b.closeable,this.init())}b.prototype.init=function(){this.container=this.container||document.createElement("div");this.container.className+=" qubit-notification "+(this.className?this.className:"")};b.prototype.drawCloseButton=function(){var b=this;this.closeable&&(this.closeButton=document.createElement("div"),0===this.container.childNodes.length?
this.container.appendChild(this.closeButton):this.container.insertBefore(this.closeButton,this.container.childNodes[0]),this.closeButton.className="notification-close-button",this.closeButton.onclick=function(){b.destroy()})};b.prototype.show=function(){this.container.style.display=""};b.prototype.hide=function(){this.container.style.display="none"};b.prototype.setContent=function(b){this.content!==b&&(this.content=b,this.container.innerHTML="","object"===typeof b?this.container.appendChild(b):this.container.innerHTML=
b,this.drawCloseButton());return b};b.prototype.paint=function(){this.painted||(this.parentContainer.appendChild(this.container),this.painted=!0)};b.prototype.destroy=function(){try{if(this.onDestroy)this.onDestroy()}finally{this.container.parentNode&&this.container.parentNode.removeChild(this.container)}};window.Notification=b})();
(function(){function b(b){b&&(this.maxTime=+b.maxTime||6E4,this.notifiers={},this.className=b.className,this.parentContainer=b.parentContainer||document.body,this.container=b.container||document.createElement("div"),this.init())}var h=window.Notification;b.prototype.notify=function(b,k,l,e,m){if(!this.notifiers[b]){l=new h({parentContainer:this.container,maxTime:l,className:e,closeable:m});var p=this;l.onDestroy=function(){delete p.notifiers[b]};this.notifiers[b]=l;l.paint()}this.notifiers[b].show();
this.notifiers[b].setContent(k);this.notifiers[b].timestamp=(new Date).valueOf()};b.prototype.done=function(b,h,l){this.notify(b,h);var e=this;setTimeout(function(){e.notifiers[b]&&(e.notifiers[b].destroy(),delete e.notifiers[b])},l)};b.prototype.init=function(){this.setParentContainer(this.parentContainer);var b=this,h;h=function(){b.container&&b.container.parentNode&&(b.oldNotifiersCheck(),setTimeout(h,500))};h()};b.prototype.setParentContainer=function(b){this.parentContainer=b;this.parentContainer.appendChild(this.container);
this.container.className.lastIndexOf(" qubit-notificationmanager"===-1)&&(this.container.className+=" qubit-notificationmanager "+this.className)};b.prototype.oldNotifiersCheck=function(){var b,h;for(b in this.notifiers)this.notifiers.hasOwnProperty(b)&&(h=this.notifiers[b].maxTime||this.maxTime,(new Date).valueOf()-this.notifiers[b].timestamp>h&&this.notifiers[b].destroy())};b.prototype.clear=function(){for(var b in this.notifiers)this.notifiers.hasOwnProperty(b)&&this.notifiers[b].destroy()};window.NotificationManager=
b})();var Utils=qubit.opentag.Utils,parameterTemplate=document.getElementById("parameter-template").innerHTML,parametersTemplate=document.getElementById("parameters-template").innerHTML;function Parameters(b){b&&(this.config=b,this.init())}Utils.clazz("ui.Parameters",Parameters);Parameters.prototype.paint=function(){this.painted=!0;this.config.parentContainer.appendChild(this.container)};
Parameters.prototype.init=function(){var b=document.createElement("div");b.innerHTML=parametersTemplate;b.className="parameters-container";this.container=b;for(var h=b.children[1].children[0],d=b.children[1].children[1],k=this.config.params,l=0;l<k.length;l++){var b=document.createElement("div"),e=k[l];b.innerHTML=parameterTemplate;var m=b.getElementsByTagName("input")[0];m.pindex=l;b.paramNode=m;b.uvNode=b.getElementsByTagName("input")[1];b.getElementsByTagName("label")[0].innerHTML=e.name+" (token: <pre style='display:inline'>"+
e.token+"</pre>)";var p=!1;e.uv?(p=!0,b.uvNode.value=e.uv):(Utils.addClass(b.uvNode,"no-uv"),b.uvNode.value="edit script to set universal variable");e=void 0!==e.inputVariable?e.inputVariable:"";m.value=e;m.className=e||p?"":"red";p&&(m.setAttribute("onfocus",null),m.setAttribute("onblur",null));h.appendChild(b)}0===k.length?(d.style.display="none",h.innerHTML="<div class='no-params'>No parameters defined.</div>"):d.style.display=""};var excluded="parameters PACKAGE dependencies CONSTRUCTOR dedupe priv name description inactive vendor loadDependenciesOnLoad variables".split(" ");
function propertyExcludedFromConfig(b){for(var h=0;h<excluded.length;h++)if(b===excluded[h])return!0;return!1}var hidden=["filterTimeout","isPrivate",,"usesDocumentWrite","timeout","singleton","locationPlaceHolder","locationDetail","locationObject","noMultipleLoad","__proto__"];function propertyHiddenFromConfig(b){for(var h=0;h<hidden.length;h++)if(b===hidden[h])return!0;return!1}
function prepareConfigElement(b,h,d){var k=document.createElement("div");k.innerHTML=d;k.children[0].className="config";k.getElementsByTagName("input")[0].cname=b;k.getElementsByTagName("label")[0].innerHTML=b;void 0!==h&&(k.getElementsByTagName("input")[0].value=h);k.getElementsByTagName("input")[0].entered=!0;return k}var configTemplate=document.getElementById("config-template").innerHTML,hiddenConfigTemplate=document.getElementById("toggled-config-template").innerHTML;
function addConfig(b,h){var d=document.createElement("div");d.innerHTML=hiddenConfigTemplate;d.className="config-header";var k=d.children[0].children[0];k.innerHTML="<span plus='true'>+</span> Configuration";toggleShowSibling(k);var l=d.children[0].children[1];b.appendChild(d);for(var e in h)propertyExcludedFromConfig(e)||propertyHiddenFromConfig(e)||(k=prepareConfigElement(e,h[e],configTemplate),l.appendChild(k));d=document.createElement("div");d.innerHTML=hiddenConfigTemplate;d.className="config-header";
l.appendChild(d);k=d.children[0].children[0];l=d.children[0].children[1];toggleShowSibling(k);k.innerHTML="<span plus='true'>+</span> Advanced";for(e in h)!propertyExcludedFromConfig(e)&&propertyHiddenFromConfig(e)&&(k=prepareConfigElement(e,h[e],configTemplate),l.appendChild(k))}var prePostTemplate=document.getElementById("pre-post-script-template").innerHTML;
function addPrePostTemplate(b,h){var d=document.createElement("div");d.innerHTML=prePostTemplate;var k=d.getElementsByTagName("textarea"),l=k[0],e=k[1],k=k[2],m=h.config.post?h.config.post:String(h.post),p=h.config.script?h.config.script:String(h.script);l.value=String(h.config.pre?h.config.pre:String(h.pre));e.value=String(m);k.value=String(p);l.style.display="none";e.style.display="none";k.style.display="none";h.preNode=l;h.postNode=e;h.scriptNode=k;b.appendChild(d)}var testTemplate=document.getElementById("unit-test-template").innerHTML;
function addTest(b,h){var d=document.createElement("div");d.innerHTML=testTemplate;d.className="unit-test";h.testNode=d;h.statusNode=d.children[0];h.nameNode=d.children[1];h.nameNode.innerHTML=h.name;h.onFinished=function(){this.failed?Utils.addClass(this.statusNode,"failed"):this.passed&&Utils.addClass(this.statusNode,"passed")};b.appendChild(d)}
function addBDDTest(b,h){var d=document.createElement("div");d.innerHTML=testTemplate;d.className="unit-test";h.testNode=d;h.statusNode=d.children[0];h.nameNode=d.children[1];h.nameNode.innerHTML=h.description;var k=h.resultCallback;h.resultCallback=function(b){k.apply(h,arguments);"failed"===h.result.status?Utils.addClass(h.statusNode,"failed"):"passed"===h.result.status&&Utils.addClass(h.statusNode,"passed")};b.appendChild(d)}var testsSuiteTemplate=document.getElementById("unit-tests-suite-template").innerHTML;
function addTestsSuite(b,h){var d=document.createElement("div");d.className="unit-tests-suite";d.innerHTML=testsSuiteTemplate;var k=Utils.getObjectUsingPath(h.PACKAGE_NAME+".local.TestsSuite"),l=Utils.getObjectUsingPath(h.PACKAGE_NAME+".local.BDDSuite");b.appendChild(d);renderTestsToNode(d.children[1],k,l)}
function renderTestsToNode(b,h,d){b.innerHTML="";if(d){d.unitTestsNode=b;d=d.children;for(var k=0;k<d.length;k++)addBDDTest(b,d[k])}if(h)for(h.unitTestsNode=b,d=h.tests,k=0;k<d.length;k++)addTest(b,d[k])}function prepareVendorNode(b){var h=document.createElement("div");h.innerHTML="<a class='plain' href='#-2'>"+b+"</a>";h.className="vendor";h.children[0].onclick=function(){var b=this.ishidden?"show":"hide";this.ishidden=!this.ishidden;this.parentNode.className="vendor "+b};return h}
function findTags(b,h){h=h||[];Utils.traverse(b,function(d,k,l,e){d&&d.prototype&&"superclass"!==l&&d.prototype instanceof qubit.opentag.BaseTag&&d!==qubit.opentag.BaseTag&&d!==qubit.opentag.LibraryTag&&d!==qubit.opentag.CustomTag&&b.Tag!==d&&h.push(d)},{objectsOnly:!0,track:!0});return h}
(function(){function b(b){this.config=b||{};b&&(this.libraryNode=document.createElement("div"),this.config.parentContainer.appendChild(this.libraryNode),this.init(this.paint.bind(this)))}var h=document.getElementById("library-template").innerHTML,d=qubit.opentag.Utils;d.clazz("ui.Library",b);b.prototype.paint=function(b){this.painted=!0;this.renderLibraryToNode(this.config.libraryClass,this.libraryNode,b||"hide")};b.prototype.init=function(b){var h=APP_PATH+"getClassPath?classPath=libraries."+this.config.libraryClass.prototype.PACKAGE_NAME+
".local&file=Config.js";try{GET(h,function(e){try{d.geval(e)}catch(h){}b&&b()})}catch(e){(b,e)&&b()}};b.prototype.renderLibraryToNode=function(b,l,e,m){m=m||{};var p=new b;p.unregister();if(m.parameters&&p.config.parameters)for(var r=0;r<m.parameters.length;r++)for(var s=m.parameters[r].token,x=0;x<p.config.parameters.length;x++)p.config.parameters[x].token===s&&(p.config.parameters[x].inputVariable=m.parameters[r].inputVariable);m=p.PACKAGE_NAME+"."+p.CLASS_NAME;l||(l=document.getElementById(m),
d.removeClass(l,"tests-failed"),d.removeClass(l,"tests-passed"),d.removeClass(l,"tests-notests"));l.setAttribute("library-node","true");l.innerHTML=h;r="";b.versionClassPath&&(r=b.prototype.PACKAGE_NAME.replace(b.versionClassPath+".",""),r=r.replace(/\._(\d)/g,".$1"),r="<span class='version-title'> ("+r+") </span>");l.children[0].children[1].innerHTML=p.config.name+r+"<a href='#-3' onclick='saveNewVersion(this, arguments[0]);'> clone </a>";d.addClass(l,"library");e&&d.addClass(l,e);l.reference=p;
l.libraryWidget=this;l.classReference=b;l.id=m;b=p.config.parameters;e=l.children[7].children[0];l=l.children[7].children[1];try{var a=d.getObjectUsingPath(p.PACKAGE_NAME+".local.Config");if(a&&a.parameters)for(var v=a.parameters,a=0;a<b.length;a++){var g=b[a];for(m=0;m<v.length;m++)if(g.token&&g.token===v[m].token){var n=b[a].inputVariable,c=b[a].uv;b[a]=v[m];n&&(b[a].inputVariable=n);c&&(b[a].uv=c);break}}}catch(f){}e.children[0].innerHTML=(p.config.imageUrl?"<img class='logo' src='"+p.config.imageUrl+
"' align='right' />":"")+p.config.description;(new ui.Parameters({parentContainer:l,params:b})).paint();addConfig(l,p.config);addPrePostTemplate(l,p);addTestsSuite(l,p)}})();qubit.VENDOR_SPACE_CP="";Utils=qubit.opentag.Utils;window.LIBRARIES={};
function renderAllLibrariesToPage(){var b=document.getElementById("libraries");b.innerHTML="";var h=[],d=qubit.vs;if(!d)try{d=qubit.vs}catch(k){}for(var l in d)if("PACKAGE_NAME"!==l&&"CLASSPATH"!==l){var e=d[l],m=prepareVendorNode(l),p;for(p in e)try{var r=e[p].Tag,s=[l,p].join(".");if(r){var x=new r({}),s=r.prototype.PACKAGE_NAME;x.unregister();x instanceof qubit.opentag.LibraryTag&&h.push([m,r,x])}for(var a=findTags(e[p]),v=0;v<a.length;v++){var g=new a[v]({});g.unregister();a[v].versionClassPath=
s;h.push([m,a[v],g])}}catch(n){window.console&&console.log?(console.log("Failed to load tag configuration, possible syntax error:"+n),info("Failed to load tag configuration, possible syntax error:"+n)):logError("Failed to load tag configuration, possible syntax error:"+n)}h.sort(function(a,b){var c=a[1],d=b[1],e=a[2].config,f=b[2].config;return e.name===f.name?(f=e="",c.versionClassPath&&(e=c.prototype.PACKAGE_NAME.replace(c.versionClassPath+".","")),d.versionClassPath&&(f=d.prototype.PACKAGE_NAME.replace(d.versionClassPath+
".","")),compareVersions(e,f)):e.name>f.name?1:e.name===f.name?0:-1});c+=h.length;b.appendChild(m)}var c=h.length,f=0;theProgressBar("Rendering...",function(){return f/c*100});var H=!1;(function(a){var b=0,c=function(){for(var d=0;8>d;d++){f++;if(b===a.length){H||setTimeout(bodyLoaded,200);H=!0;return}var e=a[b][1],g=new ui.Library({parentContainer:a[b][0],libraryClass:e});LIBRARIES[e.PACKAGE_NAME+"."+e.CLASS_NAME]=g;b++}setTimeout(c,4)};c()})(h)}var total=1,counted=0;
function loadAllLibs(b){GET(LIBRARIES_REPO_LOC+"shared/bin/html/scripts.txt",function(h){var d=[];h=h.split(",");h.push("shared/bin/html/js/build-location.js");total=1;counted=0;if(!b){b=[];for(var k=0;k<h.length;k++)h[k]&&-1==h[k].indexOf("shared/js/tagsdk-current.js")&&b.push(h[k])}theProgressBar("Loading scipts",function(){return 0===counted?0:counted/(b.length+total)*100});var l=0,e=function(){if(l!==b.length){var h=l;l++;var k=LIBRARIES_REPO_LOC+b[h];setTimeout(function(){_loadSingle(k,h,e,b,
d)},0)}};e()})}
function compareVersions(b,h){var d=b.replace(/\./g,".").split("."),k=h.replace(/\./g,".").split("."),l=null;if(d.length&&k.length){var e=d[0].replace(/[^\d+]/g,".").split("."),e=e[e.length-1],m=k[0].replace(/[^\d+]/g,".").split("."),m=m[m.length-1],p=d[0].substring(0,d[0].lastIndexOf(e)),r=k[0].substring(0,k[0].lastIndexOf(m));p!==r||isNaN(+e)||isNaN(+m)?d[0]>k[0]?l=!0:d[0]<k[0]&&(l=!1):+e<+m?l=!0:+e>+m&&(l=!1)}if(null===l)for(e=1;e<d.length&&e<k.length;e++)if(m=k[e],p=d[e],"0"!==p.charAt(0)&&"0"!==
m.charAt(0)||0===e||(p="0."+p,m="0."+m),!isNaN(+p)&&!isNaN(+m))if(+p<+m){l=!0;break}else{if(+p>+m){l=!1;break}}else if(p<m){l=!0;break}else if(p>m){l=!1;break}d.length!==k.length&&null===l&&(l=d.length<k.length);return!0===l?1:null===l?0:-1}function _loadSingle(b,h,d,k,l){GET(b,function(e,m){try{l[h]={expr:e,url:b},log(b),counted++,k.length===counted&&_allScriptsFetched(l)}finally{d&&d()}})}
function _allScriptsFetched(b){for(var h=0;h<b.length;h++)try{eval(b[h].expr)}catch(d){logError("Failed to load: "+b[h].url+"\nException: "+d)}theProgressBar.title+=", rendering... ";listScripts(b);setTimeout(function(){counted++;renderAllLibrariesToPage();window.toggleConsole();qubit.opentag.Log.LEVEL=3;qubit.opentag.Log.COLLECT_LEVEL=5},50)}
function keepRunningTests(){-1!==location.href.indexOf("runTests=true")&&(info("Running tests..."),runAllTests(function(){countdown("Automatically running tests... ",10);setTimeout(keepRunningTests,1E4)}))}function countdown(b,h,d){if(!(0>=h)){info(b+h+(d||""),1E3,"countdown");var k=h-1;setTimeout(function(){countdown(b,k)},1E3)}}function listScripts(b){}function bodyLoaded(){setTimeout(keepRunningTests,1E3)}
window.Main=function(){window.qlog=new qconsole;window.toggleConsole=function(){qlog.hidden?qlog.show():qlog.hide()};window.logError=function(b,h){log("<span style='color: red'>"+b+"</span>");info("<span style='color: #FF766F'>"+b+"</span>",h||5E3)};window.info=function(b,h,d){DefaultNotificationsMgr.notify(d||(new Date).valueOf(),b,h||2800,"",!0);log(b)};window.log=function(b){qlog.log(b)};Suite.log=Test.log=function(b){log(b)};loadAllLibs();window.DefaultNotificationsMgr=new NotificationManager({maxTime:4E3})};
