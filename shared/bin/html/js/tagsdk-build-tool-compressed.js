(function(){Function.prototype.bind=Function.prototype.bind||function(b){var f=this;return function(){return f.apply(b,arguments)}}})();var global=this;try{global=(0,eval)("this")||function(){return this}()||window}catch(e$$12){}global.VERSION="1.0.2-b1";var EMPTY_FUN=function(){},UNDEF=void 0;global.APP_PATH=global.APP_PATH||"/";global.LIBRARIES_REPO_LOC=global.LIBRARIES_REPO_LOC||"/";
(function(){var b,f;function c(){var a=F.uv;if(!a||!a.emit)return!1;if(!D){D=!0;for(var b=0;b<C.length;b++){var h=C[b];h.on?a.on.apply(a,h.on):h.emit&&a.emit.apply(a,h.emit)}a.on(/.*/,function(a){var d=a.meta.type,e=E[d];e?(e.current=a,e.history.push(a)):E[d]={current:a,history:[a]}}).replay();H=!0}return!0}(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var b=Array.prototype.slice.call(arguments,1),h=this,t=function(){},d=function(){return h.apply(this instanceof t?this:a,b.concat(Array.prototype.slice.call(arguments)))};t.prototype=this.prototype;d.prototype=new t;return d})})();var g={__anonymous__:!0},m=null;try{m=(0,eval)("this")}catch(p){}if(!m)try{m=function(){return this}()}catch(q){}var g=m,k=g.qubit||{};g.qubit||(g.qubit=k);if(k.VERSION&&"3.2.0"!==k.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+k.VERSION)}catch(z){}k.VERSION=
"3.2.0";try{"object"===typeof module&&(module.exports=g)}catch(B){}var v=function(){};(function(){function a(){}function b(d,e,h,t,n){d=d.split(".");var c=a.NAMESPACE_BASE||g,k=null,f=null;n&&(c=m);n=c;c=h||c;for(h=0;h<d.length-1;h+=1)f=d[h],c[f]=c[f]||{},c=c[f];k=c;f=d[d.length-1];m.TAGSDK_NS_OVERRIDE&&(t=!1);void 0!==m.TAGSDK_NS_FORCED_OVERRIDE_OPTION&&(t=!m.TAGSDK_NS_FORCED_OVERRIDE_OPTION);void 0!==e?void 0!==k[f]&&t||(k[f]=e):k[f]=k[f]||{};e&&(e.CLASSPATH=d.join("."),d.splice(d.length-1,1),e.PACKAGE_NAME=
d.join("."));return{root:n,object:k,instance:k[f]}}a.global=function(){return m};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,e,h,t){return b(a,e,h,t,!0)};a.namespace=function(a,e,h,t){return b(a,e,h,t,!1)};a.clientNamespace=function(d,e,b,h){return a.namespace(a.clientSpaceClasspath()+"."+d,e,b,h)};a.clazz=function(d,e,b,h,n){a.namespace(d,e,h,!0);"function"===
typeof b&&(e.SUPER=b,e.superclass=b,e.prototype=new b(n),e.prototype.SUPER=b,e.prototype.CLASS=e);d=d.split(".");e.prototype?(e.prototype.CLASSPATH=d.join("."),e.prototype.CLASS_NAME=d[d.length-1],d.splice(d.length-1,1),e.prototype.PACKAGE_NAME=d.join(".")):(e.CLASSPATH=d.join("."),e.STATIC_NAME=d[d.length-1],d.splice(d.length-1,1),e.PACKAGE_NAME=d.join("."));return e};a.clazz("qubit.Define",a);a.clientClazz=function(d,e,b,h,n){return a.clazz(a.clientSpaceClasspath()+"."+d,e,b,h,n)};a.STANDARD_VS_NS=
"qubit.vs";a.vendorsSpaceClasspath=function(d){var e=k.VENDOR_SPACE_CP,e=void 0===e||null===e?a.STANDARD_VS_NS:e;return d?e?e+"."+d:d:e};var h=a.vendorsSpaceClasspath(),t;t=h?a.namespace(h,{},null,!0).instance:a.global();a.getVendorSpace=function(){return t};a.vendorNamespace=function(d,e,b,h){d=a.vendorsSpaceClasspath(d);return a.namespace(d,e,b,h)};a.vendorClazz=function(d,e,b,h,n){d=a.vendorsSpaceClasspath(d);return a.clazz(d,e,b,h,n)}})();(function(){function a(a){}for(var b={},h=0;93>h;h++)b["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(h)]=
h;k.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=b;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(b,d,e,h,c){if(e){var n=new Date;n.setTime(n.getTime()+864E5*e);e="; expires="+n.toGMTString()}else e="";c||(b=a.encode(b),d=a.encode(d));b=b+"="+d+e+"; path=/;";h&&(b+=" domain="+h);document.cookie=b};a.get=function(b,d){for(var e=b+"=",
h=document.cookie.split(";"),c=0;c<h.length;c++){for(var n=h[c];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return e=n.substring(e.length,n.length),d||(e=a.decode(e)),e}return null};a.getAllForName=function(b,d){if(!b)return[];for(var e=b+"=",h=document.cookie.split(";"),c=[],n=0;n<h.length;n++){for(var f=h[n];" "===f.charAt(0);)f=f.substring(1,f.length);0===f.indexOf(e)&&(f=f.substring(e.length,f.length),d&&(f=a.decode(f)),c.push(f))}return c};a.getAll=function(b){for(var d=
document.cookie.split(";"),e=[],h=0;h<d.length;h++){for(var c=d[h];" "===c.charAt(0);)c=c.substring(1,c.length);var n=c.substring(0,c.indexOf("=")),c=c.substring(n.length+1,c.length);b&&(c=a.decode(c));e.push([n,c])}return e};a.rm=function(b,d){a.set(b,"",-1,d)}})();(function(){function a(d,l,e){this.collectLogs=!!a.isCollecting();this.collectLocally=e;this.collection=[];this.getPrefix=function(){var a="";l&&("function"===typeof l?a=l(this.ref):l.CLASS_NAME?a=l.CLASS_NAME:l.constructor&&l.constructor.name&&
(a=l.constructor.name),a&&(a+=" -> "));return(d||"")+a}}function b(e,l,x,u,h,n,t,c){var L=d>=c;if(0<=a.getCollectLevel()||L)l=h?[u,t,x]:[l+e.getPrefix()+u,n,x],l[3]=c,e.collect(l,c),L&&e.printMessage.apply(e,l)}var h=k.Define,t=null;h.clazz("qubit.opentag.Log",a);a.LEVEL_FINEST=4;a.LEVEL_FINE=3;a.LEVEL_INFO=2;a.LEVEL_WARN=1;a.LEVEL_ERROR=0;a.LEVEL_NONE=-1;a.MAX_LOG_LEN=1E4;a.prototype.MAX_LOG_LEN=-1;var d=a.LEVEL_NONE,e=a.LEVEL_NONE,c=!0;a.setLevelFromCookie=function(){var d=k.Cookie.get("qubit.opentag.Log.LEVEL");
if(d&&(d=+d,!isNaN(d)&&0<d)){var l=a.LEVEL_FINE;a.setCollectLevel(d>l?d:l);a.setLevel(+d)}};a.setCollecting=function(a){c=!!a};a.isCollecting=function(){return c||a.COLLECT};a.setLevel=function(a){d=+a};a.setCollectAndLevel=function(d){a.setLevel(d);a.setCollectLevel(d)};a.getLevel=function(){return d};a.setCollectLevel=function(a){e=+a};a.getCollectLevel=function(){return e};var f=[];a.logsCollection=f;a.rePrintAll=function(e,l,b,u){var h=d;void 0!==e&&(d=e);try{if(a.isCollecting()){try{b||t.clear()}catch(n){}var c=
u||a.logsCollection,L=0;for(b=0;b<c.length;b++)(function(u){var b=c[u];u=b[3];void 0!==u&&d>=u&&(L++,l?k.opentag.Timed.setTimeout(function(){void 0!==e&&(d=e);try{a.print.apply(a,b)}finally{d=h}},L*l):a.print.apply(a,b))})(b)}}catch(f){}finally{d=h}};var n=h.global(),y=!!(n.webkitMediaStream||n.webkitURL||n.mozContact);a.isStyleSupported=function(){return y};var g={};a.setConsole=function(a){return t=a||g};a.delayPrint=-1;var m=(new Date).valueOf();a.prototype.printMessage=function(d,l,e,u){if(0<
a.delayPrint){var b=a.delayPrint,h=m-(new Date).valueOf();0<h&&(b+=h);try{k.opentag.Timed.setTimeout(function(){this.print(d,l,e,u)}.bind(this),b)}catch(n){setTimeout(function(){this.print(d,l,e,u)}.bind(this),b)}m=(new Date).valueOf()+b}else this.print(d,l,e,u)};a.prototype.print=function(d,l,e,u){a.print(d,l,e,u)};a.print=function(e,l,b,u){if(!(void 0!==u&&d<u))try{if(t&&t.log)if(l&&a.isStyleSupported())if(b&&t[b])t[b]("%c"+e,l);else t.log("%c"+e,l);else if(b&&t[b])t[b](e);else t.log(e)}catch(h){}};
a.prototype.collect=function(d,l){void 0===l&&(l=a.getCollectLevel());var e=!1,u=this.collectLogs&&a.isCollecting()&&a.getCollectLevel()>=+l;u&&(f.push(d),e=!0);this.collectLocally&&u&&(this.collection.push(d),e=!0);0<a.MAX_LOG_LEN&&f.length>a.MAX_LOG_LEN&&f.splice(0,f.length-a.MAX_LOG_LEN);if(0<a.MAX_LOG_LEN||0<this.MAX_LOG_LEN)u=a.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(u=this.MAX_LOG_LEN),this.collection.length>u&&this.collection.splice(0,this.collection.length-u);return e?d:null};a.clearAllLogs=function(){try{t.clear()}catch(a){}finally{f.splice(0,
f.length)}};a.getCollectedByLevel=function(a,l){l=l||f;for(var d=[],u=0;u<l.length;u++){var e=l[u];e[0][4]===a&&d.push(e)}return d};a.prototype.rePrint=function(d,l,e){a.rePrintAll(d,l,!e,this.collection)};a.prototype.FINEST=function(d,l){b(this,"FINEST: ",!1,d,l,"color:#CCCCCC;",!1,a.LEVEL_FINEST)};a.prototype.FINE=function(d,l){b(this,"FINE: ",!1,d,l,"color:#999999;",!1,a.LEVEL_FINE)};a.prototype.INFO=function(d,l,e){b(this,"INFO: ","info",d,l,e,e,a.LEVEL_INFO)};a.prototype.WARN=function(d,l){b(this,
"WARN: ","warn",d,l,"color:#26A110;",!1,a.LEVEL_WARN)};a.prototype.ERROR=function(d,l){b(this,"ERROR: ","error",d,l,"color:red;",!1,a.LEVEL_ERROR)};a.setConsole(h.global().console);a.setLevelFromCookie()})();(function(){function a(a,l){for(var d=f.length,e=0;e<d;e++)if(a===f[e][0])return f[e][1];f[f.length]=[a,l];return!1}function b(l,d,e,h,x){var n=!1,t=!1,k=!1,y=!1,g=!1,m=g=!1;d&&(n=(g=!!d.all)||d.nodes,y=g||d.win,t=g,m=!!d.emptyForMaxDeep,k=d.noFunctions&&!g,void 0!==d.noOwn&&(t=!!d.noOwn),void 0!==
d.noFunctions&&(k=!!d.noFunctions),void 0!==d.win&&(y=!!d.win),void 0!==d.nodes&&(n=!!d.nodes),g=!!d.copyReference);if(void 0===e||e)void 0!==e&&e--;else return m?void 0:l;if(!(l&&l instanceof Object))return l;if(!n){try{if(l instanceof Node)return l}catch(I){if(l instanceof ActiveXObject&&void 0!==l.nodeType)return l}if(l===document)return l}if(!y&&l===c)return l;n=l instanceof Array?[]:{};l instanceof Date&&(n=new Date(l));!k&&l instanceof Function&&(k=String(l).replace(/\s+/g,""),n=k.indexOf("{[nativecode]}")+
14===k.length?function(){return l.apply(x||this,arguments)}:function(){return l.apply(this,arguments)});void 0===h&&(f=[],h=0);if(k=a(l,n))return k;if(n instanceof Array)for(k=0;k<l.length;k++)n[n.length]=l[k]===l[k]?b(l[k],d,e,h+1,l):l[k];else{var k=0,A;for(A in l){if(t||l.hasOwnProperty(A))n[A]=l[A]===l[A]?b(l[A],d,e,h+1,l):l[A];k++}}d.proto&&(n.prototype=b(l.prototype,d,e,h+1,l));g&&(n.___copy_ref=l);return n}function h(a,l,d,e,b,x,t,f){d=d||{};void 0===d.hasOwn&&(d.hasOwn=!0);if(!d.objectsOnly||
a instanceof Object)if(void 0===f||f){void 0!==f&&f--;if(!d||!d.nodes)try{if(a instanceof Node)return}catch(k){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return}if(a!==c){void 0===e&&(n=[],e=0);var y;a:{for(y=0;y<e&&y<n.length;y++)if(a===n[y]){y=!0;break a}y=!1}if(!(y||(n[e]=a,b=b||a,b&&x&&b[x]!==b[x]||l(a,b,x,t)))){x=0;y="";for(var g in a){if(!d.hasOwn||a.hasOwnProperty(g))try{var w=a[g];d.track&&(y=t?t+"."+g:g);h(w,l,d,e+1,b,g,y,f)}catch(m){}x++}}}}}var t=k.Define,d=k.Cookie,e=function(){},
c=t.global();t.clazz("qubit.opentag.Utils",e);e.global=t.global;e.namespace=t.namespace;e.clazz=t.clazz;e.getObjectUsingPath=function(a,l){l=l||c;for(var d=a.split("."),e=0;e<d.length;e++)l&&d[e]&&(l=l[d[e]]);return l};e.getParentObject=function(a){var l=a.lastIndexOf(".");a=a.substring(0,l);return e.getObjectUsingPath(a)};e.variableExists=function(a){return void 0!==a&&null!==a};e.ANON_VARS=[];e.getAnonymousAcessor=function(a){var l=e.indexInArray(a,e.ANON_VARS);-1===l&&(l=e.addToArrayIfNotExist(e.ANON_VARS,
a));return"qubit.opentag.Utils.ANON_VARS["+l+"]"};e.replaceAll=function(a,l,d){return a.replace(new RegExp(l.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),d)};e.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};e.getUrl=function(){return document.location.href};e.getQueryParam=function(a){var l,d,b,h;l=e.getUrl();if(0<l.indexOf("?"))for(h=l.substring(l.indexOf("?")+1).split("&"),l=0,d=h.length;l<d;l+=1)if(b=h[l],0<b.indexOf("=")&&(b=
b.split("="),2===b.length&&b[0]===a))return b[1];return null};e.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:null};var f=[];e.objectCopy=function(a,l){l=l||{};var d=b(a,l,l.maxDeep);f=[];return d};var n=[];e.traverse=function(a,l,d){h(a,l,d,void 0,void 0,void 0,void 0,d.maxDeep)};e.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};e.expressionToFunction=function(a,l){return e.gevalAndReturn("function ("+(l||"")+
") {"+a+"}").result};e.defineWrappedClass=function(a,l,d,e,b){var h=function(){return b?b.apply(this,arguments):l.apply(this,arguments)};t.clazz(a,h,l,e);for(var n in d)d.hasOwnProperty(n)&&"CONSTRUCTOR"!==n&&(h.prototype[n]=d[n]);return h};e.copyAandAddFromB=function(a,l,d){a=this.objectCopy(a,{maxDeep:d||8});for(var e in l)l.hasOwnProperty(e)&&(a[e]=l[e]);return a};e.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);var l=[],d;for(d in a)a.hasOwnProperty(d)&&(l[l.length]=
d);return l}throw"keys() called on non-object!";};e.getSrcElement=function(a){var l;a=a||window.event;a.srcElement?l=a.srcElement:a.target&&(l=a.target);return l};e.addToArrayIfNotExist=function(a,l,d){for(var e=0,b=!1;e<a.length;e+=1)if(d&&d(a[e],l)||a[e]===l){b=!0;break}b||(a[a.length]=l,e=-1);return e};e.indexInArray=function(a,l){for(var d=0;d<a.length;d++)if(a[d]===l)return d;return-1};e.existsInArray=function(a,l){for(var d=0;d<a.length;d++)if(a[d]===l)return!0;return!1};e.removeFromArray=function(a,
l){for(var d=0,e=0;d<a.length;)a[d]===l?(a.splice(d,1),e++):d++;return e};e.addClass=function(a,l){var d;try{a.classList.add(l)}catch(b){null===a.className?a.className=l:(d=a.className.split(" "),e.addToArrayIfNotExist(d,l),a.className=d.join(" "))}};e.removeClass=function(a,l){var d;try{a.classList.remove(l)}catch(b){null===a.className?a.className="":(d=a.className.split(" "),e.removeFromArray(d,l),a.className=d.join(" "))}};e.gevalAndReturn=function(a){var l=m;l.qubitopentagutilsgevalandreturn__var_test__=
void 0;l.qubitopentagutilsgevalandreturn__var_test__error=void 0;e.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+a+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");a=l.qubitopentagutilsgevalandreturn__var_test__;var d=l.qubitopentagutilsgevalandreturn__var_test__error;try{l.qubitopentagutilsgevalandreturn__var_test__=void 0,l.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete l.qubitopentagutilsgevalandreturn__var_test__,delete l.qubitopentagutilsgevalandreturn__var_test__error}catch(b){}return{result:a,
error:d}};e.trim=function(a){try{return String(a).trim()}catch(l){return String(a).replace(/^\s+|\s+$/g,"")}};e.setIfUnset=function(a,l){if(a&&l)for(var d in l)l.hasOwnProperty(d)&&!a.hasOwnProperty(d)&&(a[d]=l[d])};var y=Math.floor(1E12*Math.random());e.UUID=function(){c.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__||(c.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__=(new Date).valueOf());return y+"."+ ++c.__qubit_uuid_cnt_43567bdfhgtb4vt5yeh978__};e.overrideFromLeftToRight=function(a,l){if(a&&l)for(var d in l)l.hasOwnProperty(d)&&
(a[d]=l[d]);return a};e.geval=function(a){return window&&window.execScript?window.execScript(""===a?" ":a):c.eval.call(c,a)};var g=[];e.bodyAvailable=function(a){if(document.body){if(g){for(var l=0;l<g.length;l++)try{g[l]()}catch(d){}g=!1}a()}else g.push(a)};e.rmCookiesMatching=function(a){for(var l=d.getAll(),e=0;e<l.length;e++){var b=l[e][0];0===b.match(a)&&d.rm(b)}};var A=[],M=!1,l=!1;e.bodyReady=function(a){if(l)return a&&a(),!0;if(M=M||!(!document.body||"complete"!==document.readyState)){l=!0;
for(var d=0;d<A.length;d++)try{A[d]()}catch(e){}a&&a()}else a&&A.push(a);return M};var x=c.onload;c.onload=function(a){try{e.bodyReady()}catch(l){try{window.qubit.opentag.Utils.bodyReady()}catch(d){}}var b=!1;try{b=x}catch(h){}b&&b(a)};(function(){var a,l=!1,d=1,b,h,n,x;h=function(a){!0===a&&(d-=1);if(!d||!0!==a&&!l){if(!document.body)return setTimeout(h,1);l=!0;if(!0!==a&&(d-=1,0<d))return;for(;0<b.length;)a=b.shift(),a()}};x=function(){if(!l){try{document.documentElement.doScroll("left")}catch(a){setTimeout(x,
1);return}h()}};n=function(){if(!b){b=[];if("complete"===document.readyState)return setTimeout(h,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",h,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",a);window.attachEvent("onload",h);var l=!1;try{l=null===window.frameElement||void 0===window.frameElement}catch(d){}document.documentElement.doScroll&&l&&x()}}};document.addEventListener?a=function(){document.removeEventListener("DOMContentLoaded",
a,!1);h()}:document.attachEvent&&(a=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),h())});(function(a){n();l?setTimeout(a,1):b.push(a)})(function(){M=!0;e.bodyReady()})})()})();var r={};(function(){function a(a){return 10>a?"0"+a:a}function b(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var d=f[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function h(d,t){var f,k,l,x,u=e,g,w=t[d];if(w instanceof
Date)f=w,w=isFinite(f.valueOf())?f.getUTCFullYear()+"-"+a(f.getUTCMonth()+1)+"-"+a(f.getUTCDate())+"T"+a(f.getUTCHours())+":"+a(f.getUTCMinutes())+":"+a(f.getUTCSeconds())+"Z":null;else if(w instanceof String||w instanceof Number||w instanceof Boolean)w=w.valueOf();"function"===typeof n&&(w=n.call(t,d,w));switch(typeof w){case "string":return b(w);case "number":return isFinite(w)?String(w):"null";case "boolean":case "null":return String(w);case "object":if(!w)return"null";e+=c;g=[];if("[object Array]"===
Object.prototype.toString.apply(w)){x=w.length;for(f=0;f<x;f+=1)try{g[f]=h(f,w)||"null"}catch(m){g[f]='{"stack_exceeded": null}'}l=0===g.length?"[]":e?"[\n"+e+g.join(",\n"+e)+"\n"+u+"]":"["+g.join(",")+"]";e=u;return l}if(n&&"object"===typeof n)for(x=n.length,f=0;f<x;f+=1){if("string"===typeof n[f]){k=n[f];try{l=h(k,w)}catch(r){l='{"stack_exceeded": null}'}l&&g.push(b(k)+(e?": ":":")+l)}}else for(k in w)if(Object.prototype.hasOwnProperty.call(w,k)){try{l=h(k,w)}catch(p){l='{"stack_exceeded": null}'}l&&
g.push(b(k)+(e?": ":":")+l)}l=0===g.length?"{}":e?"{\n"+e+g.join(",\n"+e)+"\n"+u+"}":"{"+g.join(",")+"}";e=u;return l}}var t=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,c,f={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;"function"!==typeof r.stringify&&(r.stringify=function(a,
d,b){var t;c=e="";if("number"===typeof b)for(t=0;t<b;t+=1)c+=" ";else"string"===typeof b&&(c=b);if((n=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return h("",{"":a})});"function"!==typeof r.parse&&(r.parse=function(a,d){function e(a,b){var h,n,t=a[b];if(t&&"object"===typeof t)for(h in t)Object.prototype.hasOwnProperty.call(t,h)&&(n=e(t,h),void 0!==n?t[h]=n:delete t[h]);return d.call(a,b,t)}var b;a=String(a);t.lastIndex=0;t.test(a)&&(a=
a.replace(t,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),"function"===typeof d?e({"":b},""):b;throw new SyntaxError("JSON.parse");})})();var s;s=s||{};(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},b,h="universal_variable";
a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(b,d,e){if(null===e)return"null"===d?!1:!0;if(void 0===e)return d===e?!1:!0;d=r.parse(d);d=a._getNested(d,b);b=a._getNested(e,b);return!a._jsonIsEqual(d,b)};a._processCallbacks=function(){var b;if(a.early_callbacks&&0<a.early_callbacks.length){for(b=0;b<a.early_callbacks.length;b+=1)a.push(a.early_callbacks[b]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,
"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(b,d){for(var e=a._keyStringToArr(d),h;0<e.length;)if(h=e.shift(),b.hasOwnProperty(h))b=b[h];else return;return b};a._jsonIsEqual=function(b,d){"string"!==typeof b&&(b=r.stringify(b,a._stripEvents));"string"!==typeof d&&(d=r.stringify(d,a._stripEvents));return b===d};a._stripEvents=function(a,d){if("events"!==a)return d};a._on=function(b,d){var e;e=b.split(":");b=e[0];e=e[1];a.callbacks[b]=
a.callbacks[b]||[];e?a.callbacks[b].push({keyString:e,func:d}):a.callbacks[b].push({func:d})};a._trigger=function(h,d){var e,c;if(a.callbacks[h])for(e=0;e<a.callbacks[h].length;e+=1)"function"===typeof a.callbacks[h][e].func&&((c=a.callbacks[h][e].keyString)?"change"===h&&a._targetChanged(c,a.currentUV,b)&&a.callbacks[h][e].func(d):a.callbacks[h][e].func(d))};a._eventsPush=function(h){var d,e;b.events[b.events.length]=h;h.time=h.time||(new Date).getTime();if(a.callbacks.event)for(d=0,e=a.callbacks.event.length,
d;d<e;d+=1)a.callbacks.event[d].func(h);h.has_fired=!0};a._getUnfiredEvents=function(){for(var h=0,h=0;h<b.events.length;h+=1)b.events[h].has_fired||(a.unfired_events.push(b.events.splice(h,1)[0]),h-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)b.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){b.events=b.events||[];-1!==b.events.push.toString().indexOf("[native code]")&&(b.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&
0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,b)&&(a._trigger("change",b),a.currentUV=r.stringify(b,a._stripEvents))};a._setUVLocation=function(b){h=b;a._initUV()};a._initUV=function(){window[h]=window[h]||{events:[]};b=window[h];b.events||(b.events=[])};a.push=function(b){a._isArray(b)&&("on"===b[0]?a._on(b[1],b[2]):"trigger"===b[0]&&b[1]&&a._trigger(b[1]))};a.init=function(b,d){d&&(h=d);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||
null,window.uv_listener=a,b||a.start()):d&&window.uv_listener._setUVLocation(h)};a.start=function(){a.currentUV=r.stringify(b,a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};s.UVListener=a})();(function(){function a(a){a&&(this._rate=a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}k.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=
[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=
(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var b=this.timers[a];if((new Date).valueOf()>=b.time){try{b.execute()}catch(d){}this.timers.splice(a,1);--a}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=function(a,b,d){d||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},d=a.__maxFrequent__timer_opentag_qubit_);var e=d.____last__timed__max__frequent____;if(!e||(new Date).valueOf()-
e>b)e=(new Date).valueOf(),d.____last__timed__max__frequent____=e,a()};a.prototype.runIfNotScheduled=function(a,b,d){d=d||a;if(d.__lastRun__&&(new Date).valueOf()<b+d.__lastRun__)return this.schedule(a,b,d);d.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,b,d){if(d.___scheduled___)return!1;d.___scheduled___=(new Date).valueOf();this.setTimeout(function(){d.___scheduled___=!1;d.__lastRun__=(new Date).valueOf();a()},b);return!0};var b=1;a.prototype.setTimeout=function(a,
c){var d={id:b++,time:(new Date).valueOf()+ +c,execute:a};this.timers.push(d);this.startPooling(c);return d};a.prototype.setInterval=function(a,b){var d=setInterval(a,b);this.inervals.push(d);return d}})();(function(){k.Define.namespace("qubit.opentag.Timed",new k.opentag.Timer({rate:37,dynamic:!0}));var a=k.opentag.Timed;a.tillTrue=function(b,h,c){var d=function(){b()?h():a.setTimeout(d,c||33)};d()}})();s.fileLoader={};s.fileLoader.load=function(a,b,h,c,d,e){var f,k,n,g;g=!1;n=function(d){return function(){g||
(g=!0,d&&!k&&(k={url:document.location.href}),h(a,k,d))}};try{b&&(f=b(a))}catch(m){f=!1,h(a,"Exception loading pre",!0)}finally{!1!==f&&(b=s.fileLoader.createScriptEl(a,d,!1,e),h&&(b.onload=n(!1),b.onerror=n(!0),b.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||setTimeout(function(){n(!1)()},1)}),c||(c=window.document.getElementsByTagName("head")[0]),c.appendChild(b))}};s.fileLoader.createScriptEl=function(a,b,h,c){var d,e=document.createElement("script");e.type=
"text/javascript";e.src=s.fileLoader.tidyUrl(a)+(h?"?"+(new Date).getTime():"");!1!==b?(e.async="true",e.defer="true"):(e.async="false",!1!==e.async&&(e.async=!1),e.defer="false",!1!==e.defer&&(e.defer=!1));for(d in c)c.hasOwnProperty(d)&&e.setAttribute(d,c[d]);return e};s.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.calls={}}var b=k.Define,h=k.opentag.Utils;a.prototype.on=function(a,d){this.calls[a]||(this.calls[a]=
[]);return h.addToArrayIfNotExist(this.calls[a],d)};a.prototype.call=function(a,d){var b=this.calls[a];if(b)for(var h=0;h<b.length;h++)try{b[h](d)}catch(c){}};a.prototype.remove=function(a,d){return this.calls[a]?h.removeFromArray(this.calls[a],d):null};a.prototype.removeAll=function(a){var d=0,b;for(b in this.calls)this.calls.hasOwnProperty(b)&&(d+=h.removeFromArray(this.calls[b],a));return d};a.prototype.clear=function(){this.calls={}};b.clazz("qubit.Events",a)})();(function(){function a(a){this.log=
new k.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:!0,name:"Filter-"+h++,script:void 0,session:void 0,restartable:!0};this.runtimeId=b.UUID();this.session=null;if(a){for(var e in a)a.hasOwnProperty(e)&&(this.config[e]=a[e]);a.session&&this.setSession(a.session);this.register(this)}this.events=new k.Events({})}var b=k.opentag.Utils,h=0,c=[];k.Define.clazz("qubit.opentag.filter.BaseFilter",a);a.state={DISABLED:-3,SESSION:-2,
PASS:-1,FAIL:0};a.prototype.EVENT_TYPES={RESTART_EVENT:"restart"};a.prototype.prepareForRestart=function(){this.config.restartable&&(this.events.call("restart",this),this.reset())};a.prototype.onRestart=function(a){this.events.on("restart",a)};a.prototype.reset=function(){this.runtimeId=b.UUID();this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=
a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var d=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;this.config.script&&(d=this.config.script.call(this,d));isNaN(+d)&&(d=a.state.FAIL);this.lastState=+d;return d};a.getFilters=function(){return c};a.prototype.register=function(){a.register(this)};a.register=function(a){b.addToArrayIfNotExist(c,a)}})();k.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",
STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(b){this._lockObject={};var d={patternType:h.CONTAINS,pattern:""};if(b)for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);a.SUPER.call(this,d)}var b=k.opentag.Utils,h=k.opentag.filter.pattern.PatternType;k.Define.clazz("qubit.opentag.filter.URLFilter",a,k.opentag.filter.BaseFilter);a.prototype.PATTERNS=h;a.prototype.getURL=function(a){return a||b.getUrl()};a.prototype.match=
function(a){a=this.getURL(a);var d=!0,b=this.config.pattern;switch(this.config.patternType){case h.CONTAINS:d=0<=a.toLowerCase().indexOf(b.toLowerCase());break;case h.MATCHES_EXACTLY:d=a.toLowerCase()===this.config.pattern.toLowerCase();break;case h.STARTS_WITH:d=0===a.toLowerCase().indexOf(b.toLowerCase());break;case h.ENDS_WITH:d=a.lastIndexOf(b.toLowerCase())+b.length===a.length;break;case h.REGULAR_EXPRESSION:d=(new RegExp(b)).test(a);break;case h.ALL_URLS:d=!0}return d}})();(function(){function a(d){var b=
{};if(d){for(var h in d)d.hasOwnProperty(h)&&("customStarter"===h&&d[h]?this.customStarter=d[h]:"customScript"===h&&d[h]&&(this.customScript=d[h]),b[h]=d[h]);this.uid="f"+c++}this.tagsToRun=[];a.SUPER.call(this,b)}var b=k.opentag.filter.BaseFilter,h=k.opentag.Utils,c=0;k.Define.clazz("qubit.opentag.filter.Filter",a,k.opentag.filter.URLFilter);a.prototype.customStarter=function(a,b,h){b(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?
!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(b){var e=!0;try{this.customScript&&(void 0===this._matchState&&(this._matchState=!!this.customScript(this.getSession())),e=this._matchState)}catch(h){e=!1}return e&&a.SUPER.prototype.match.call(this,b)};a.prototype.runTag=function(b){h.addToArrayIfNotExist(this.tagsToRun,b);if(this.starterExecuted)this._triggerTag(b);else if(!this._starterWasRun){this._starterWasRun=!0;var e=this.runtimeId,c=function(a){e===this.runtimeId&&
(this.reRun=a,this.starterExecuted=(new Date).valueOf(),this._processQueuedTagsToRun())}.bind(this);this.customStarter?this.customStarter(this.getSession(),c,b):a.prototype.customStarter.call(this,this.getSession(),c,b)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++)this._triggerTag(this.tagsToRun[a])};a.prototype._triggerTag=function(a){!0===this.reRun?a.run():a.runOnce()};a.prototype.getState=function(d){d&&this.setSession(d);d=a.SUPER.prototype.getState.call(this);
if(d===b.state.DISABLED)return b.state.DISABLED;d===b.state.PASS&&this.isSession()&&(d=b.state.SESSION);this.config.script&&(d=this.config.script.call(this,d,this.getSession()));return this.lastState=d};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=this._matchState=void 0;this.tagsToRun=[];this.reRun=void 0}})();s.GlobalEval={};s.GlobalEval.globalEval=function(a){window.execScript?window.execScript(""===a?" ":a):window.eval.call(window,a)};
s.HtmlInjector={};s.HtmlInjector.inject=function(a,b,h,c,d){var e,f,k,n;if(0<=h.toLowerCase().indexOf("<script")){d=document.createElement("div");d.innerHTML="a"+h;f=d.getElementsByTagName("script");k=[];h=0;for(e=f.length;h<e;h+=1)k.push(f[h]);n=[];h=0;for(e=k.length;h<e;h+=1){f=k[h];var g={attributes:s.HtmlInjector.getAttributes(f)};f.src?g.src=f.src:g.script=f.innerHTML;n.push(g);f.parentNode.removeChild(f)}d.innerHTML&&0<d.innerHTML.length&&(d.innerHTML=d.innerHTML.substring(1));s.HtmlInjector.doInject(a,
b,d);s.HtmlInjector.loadScripts(n,0,c,a)}else d=document.createElement("div"),d.innerHTML=h,s.HtmlInjector.doInject(a,b,d),c&&c()};s.HtmlInjector.doInject=function(a,b,h){if(0<h.childNodes.length){for(var c=document.createDocumentFragment();0<h.childNodes.length;)c.appendChild(h.removeChild(h.childNodes[0]));b?s.HtmlInjector.injectAtStart(a,c):s.HtmlInjector.injectAtEnd(a,c)}};s.HtmlInjector.injectAtStart=function(a,b){0===a.childNodes.length?a.appendChild(b):a.insertBefore(b,a.childNodes[0])};s.HtmlInjector.injectAtEnd=
function(a,b,h){h||(h=1);a===document.body&&"complete"!==document.readyState&&50>h?setTimeout(function(){s.HtmlInjector.injectAtEnd(a,b,h+1)},100):a.appendChild(b)};s.HtmlInjector.loadScripts=function(a,b,h,c){var d,e,f=!1;for(d=a.length;b<d;b+=1)if(e=a[b],e.src){f=!0;break}else s.GlobalEval.globalEval(e.script);f&&s.fileLoader.load(e.src,null,function(){s.HtmlInjector.loadScripts(a,b+1,h,c)},c,!1,e.attributes);h&&b===d&&h()};s.HtmlInjector.getAttributes=function(a){var b,h,c,d,e={};if(a){h=a.attributes;
b=h.length;for(a=0;a<b;a++)c=h[a].value,d=h[a].name.toLowerCase(),""===c||"id"!==d&&"class"!==d&&"charset"!==d&&"data-"!==d.substr(0,5)||(e[d]=c);return e}};(function(){function a(){I=I||{write:document.write,writeln:document.writeln}}function b(){document.write=I.write;document.writeln=I.writeln;I=null}var h=k.opentag.filter.BaseFilter,c=k.opentag.Utils,d=s.HtmlInjector,e=s.fileLoader,f=k.opentag.filter.Filter,g=function(){};k.Define.clazz("qubit.opentag.TagsUtils",g);var n=!1;g.bodyLoaded=function(){return n?
!0:n=!(!document.body||"loading"===document.readyState)};g.bodyAvailable=function(a){return!!document.body};var y={};g.loadScript=function(a){var l=a.url,b=function(b,d,e){y[l].error=d;e?(y[l].state="failure",a.onerror()):(y[l].state="success",a.onsuccess())};if(y[l]){if(a.noMultipleLoad)return b(l,y[l].error,"failure"===y[l].state);y[l].count+=1}else y[l]={count:1,state:null};var d=!a.async,h=g.bodyLoaded();d&&!h?g.writeScriptURL(l,function(a,d){b(l,d,!a)}):e.load(l,!1,b,a.node,a.async)};var I=null;
g.redirectDocumentWritesToArray=function(l,b){a();document.write=function(a){l.push(a)};document.writeln=function(a){l.push(a)}};g.flushDocWritesArray=function(a,l,b,d,e){if(l&&a){a=a.splice(0,a.length);try{return g.injectHTML(l,b,a.join("\n"),e||v),!0}catch(h){}}else return!1;e&&e();return!0};g.unlockDocumentWrites=function(){I&&b()};var A=g.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",r={};k.Define.namespace(A,r,m,!0);var l=0,x=(new Date).valueOf();g.writeScriptURL=function(d,h){var n=
"_"+x+"_"+l++,u=A+"."+n,f=!1;r[n]=function(a){f||(f=!0,a?h(!1,"error while loading script "+d):h(!0),r[n]=void 0,delete g.writeScriptURL.callbacks[n])};var k='if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+u+"(true)} catch (ex) {}}",y="try{"+u+"(false)}catch(ex){}",u="try{"+u+"(true)}catch(ex){}";d=e.tidyUrl(d);k="<script onload='"+y+"'  onerror='"+u+"' onreadystatechange='"+k+"' type='text/javascript'  src='"+d+"'>\x3c/script>";I?(b(),document.write(k),a()):document.write(k);
c.bodyReady(function(){f||(f=!0,h(!0))})};g.writeScriptURL.callbacks={};var u=h.state.SESSION,J=h.state.PASS,p=h.state.FAIL;g.filtersState=function(a,l,b,d){a=a.sort(function(a,l){try{var b=l.config.order,d=a.config.order;isNaN(-d)&&(d=0);isNaN(-b)&&(b=0);return b-d}catch(e){return 0}});var e=J;if(!a||0===a.length)return e;for(var e=null,n=!1,c=!1,x=0,k,g,y=[],w,m,t=0;t<a.length;t++)if(w=a[t],w.setSession(l),w.match())if(k=w.getState(),0<k){if(0===x||x>k)x=k}else k===h.state.DISABLED?n=!0:k===u?(c=
!0,g=e=w,y.push(w)):e=w;else m=w;a=!1;null===e?(a=!0,e=n?J:p):e=e.config.include?k:k===J?p:J;0<x&&(e===J||a)&&(e=x);if(e===u||e===J&&c){if(!g.config.include)return p;e=u;if(g instanceof f&&g.isSession()&&d)for(d=0;d<y.length;d++)try{y[d].runTag(b)}catch(I){}}b.config.dedupe&&e===J&&m&&m instanceof f&&m.isSession()&&(b.sendDedupePing=!0,e=p);return e};g.injectHTML=function(a,l,b,e){return d.inject(a,l?0:1,b,e||v)};g.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);
switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();(function(){function a(b){this.config={};this.handlers=[];this.parameters=null;this.callHandlersOnRead=!1;if(b){this.uniqueId="BV"+d++;a.ALL_VARIABLES[this.uniqueId]=this;for(var e in b)b.hasOwnProperty(e)&&(this.config[e]=b[e],"value"===e&&(this.value=b.value));return a.register(this)}}function b(){if(f)return!1;for(var d=0;d<
e.length;d++)try{e[d].getValue()}catch(h){}c.setTimeout(b,a.CHECK_POLL_RATE);return!0}var h=k.opentag.Utils,c=k.opentag.Timed,d=0;k.Define.clazz("qubit.opentag.pagevariable.BaseVariable",a);a.ALL_VARIABLES={};var e=[];a.OBSERVED_VARIABLES=e;a.pageVariables=[];a.register=function(b){if(b instanceof a){for(var d=0;d<a.pageVariables.length;d++){var e=a.pageVariables[d];if(b===e)return e}a.pageVariables.push(b);return b}return null};a.prototype.getValue=function(){this._updateCurrentValue(this.value);
return this.currentValue};a.prototype._updateCurrentValue=function(a){return this.valuesAreEqual(a,this.currentValue)?!1:(this.oldValue=this.currentValue,this.currentValue=a,f&&!this.callHandlersOnRead||this._handleValueChanged(),!0)};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var b=h.variableExists(this.getValue());a&&(b=b||h.variableExists(this.getDefaultValue()));return b};a.prototype.getRelativeValue=
function(a,b){var d=this.getValue();h.variableExists(d)||(d=b);var e;a&&!h.variableExists(d)&&(e=this.getDefaultValue(),h.variableExists(e)&&(d=e));return d};a.prototype.replaceToken=function(a,b,d,e){var c=this.exists();d=c?this.getValue():d;a="\\$\\{"+a+"\\}";return e||d instanceof Array?(e=c?this.getValueAccessorString():h.getAnonymousAcessor(d),b.replace(new RegExp(a,"g"),e)):b.replace(new RegExp(a,"g"),d)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+
this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};a.prototype.onValueChanged=function(a,b){h.addToArrayIfNotExist(this.handlers,a);!1!==b&&this.startObservingForChanges()};a.prototype.deatchOnValueChanged=function(a){h.removeFromArray(this.handlers,a)};a.prototype._handleValueChanged=function(){for(var a={oldValue:this.oldValue,newValue:this.currentValue,variable:this},b=0;b<this.handlers.length;b++)try{this.handlers[b](a)}catch(d){}};var f=
!0;a.CHECK_POLL_RATE=333;a.prototype.startObservingForChanges=function(){this.addToObservedVariables();f&&(f=!1,b())};a.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();0===e.length&&(f=!0)};a.prototype.addToObservedVariables=function(){h.addToArrayIfNotExist(e,this)};a.prototype.removeFromObservedVariables=function(){h.removeFromArray(e,this)};a.prototype.getObservedVariables=function(){return e};a.prototype.valuesAreEqual=function(a,b){return a===b}})();(function(){function a(b){this._lockExprObject=
{};a.SUPER.apply(this,arguments)}var b=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.Expression",a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var h,c,d=this.value;try{if(d&&-1===d.indexOf("[#]")){var e=b.gevalAndReturn(d);h=e.result;this.failMessage=null;c=e.error}else h=a.parseUVArray(d)}catch(f){c=f}c&&(h="could not read value of expression: \n"+d+"\nexact cause: "+c,this.failMessage!==h&&(this.failMessage=h),h=null);this._updateCurrentValue(h);return h};a.parseUVArray=
function(a){var c=a.split("[#]");a=b.gevalAndReturn(c[0]).result;var d=[],c=c[1];0===c.indexOf(".")&&(c=c.replace(".",""));for(var e=0;e<a.length;e++){var f=b.getObjectUsingPath(c,a[e]);d.push(f)}return d};a.prototype.replaceToken=function(b,c,d,e){this.getValue()instanceof Array&&(e=!0);return a.SUPER.prototype.replaceToken.call(this,b,c,d,e)}})();(function(){function a(b){a.SUPER.apply(this,arguments)}var b=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.DOMText",a,k.opentag.pagevariable.BaseVariable);
a.prototype.getValue=function(){var a=b.getElementValue(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(b){a.SUPER.apply(this,arguments);this._lockObject={}}k.Define.clazz("qubit.opentag.pagevariable.Cookie",a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=k.Cookie.get(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(b){a.SUPER.apply(this,arguments)}var b=k.opentag.Utils;k.Define.clazz("qubit.opentag.pagevariable.URLQuery",
a,k.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=b.getQueryParam(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(b){a.SUPER.apply(this,arguments)}k.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,k.opentag.pagevariable.Expression)})();(function(){function a(){function a(b){m.level=b}function b(a){m.info("Calling event handlers");g++;try{a()}catch(l){m.error("UV API Error",l.stack)}g--;c()}function c(){0===n.length&&m.info("No more events to process");
0<n.length&&0<g&&m.info("Event will be processed later");if(0<n.length&&0===g){m.info("Processing event");var a=n.shift();A.events.push(a);b(function(){d(A.listeners,function(l){if(!l.disposed&&f(l.type,a.meta.type))try{l.callback.call(l.context,a)}catch(b){m.error("Error emitting UV event",b.stack)}})})}}function d(a,l){for(var b=a.length,d=0;d<b;d++)l(a[d],d)}function e(a){var l={},b;for(b in a)a.hasOwnProperty(b)&&(l[b]=a[b]);return l}function f(a,l){return"string"===typeof a?a===l:a.test(l)}function k(a,
l){for(var b=a.length,d=[],e=0;e<b;e++)l(a[e])&&d.push(a[e]);return d}var n=[],g=0,m={info:function(){m.level>a.INFO||console&&console.info&&console.info.apply(console,arguments)},error:function(){m.level>a.ERROR||console&&console.error&&console.error.apply(console,arguments)}};a.ALL=0;a.INFO=1;a.ERROR=2;a.OFF=3;a(a.ERROR);var A={on:function(a,l,e){m.info("Attaching event handler for",a);var c={type:a,callback:l,disposed:!1,context:e||window};A.listeners.push(c);var n={replay:function(){m.info("Replaying events");
b(function(){d(A.events,function(b){c.disposed||f(a,b.meta.type)&&l.call(e,b)})});return n},dispose:function(){m.info("Disposing event handler");c.disposed=!0;return n}};return n},emit:function(a,l){m.info(a,"event emitted");l=e(l||{});l.meta=l.meta||{};l.meta.type=a;n.push(l);c();A.listeners=k(A.listeners,function(a){return!a.disposed})},once:function(a,l,b){var d=A.on(a,function(){l.apply(b||window,arguments);d.dispose()});return d},events:[],listeners:[],logLevel:a};return A}"object"===typeof module&&
module.exports?module.exports=a:window&&void 0===window.uv&&(window.uv=a())})();var E={},C=[],D=!1,H=!1,F=k.Define.global(),K={allEventsByType:E,subscribe:function(a,b){if(H)F.uv.on(a,b);else C.push({on:[a,b]})},getEventHistory:function(a){return this.allEventsByType[a]},publish:function(a,b){H?F.uv.emit(a,b):C.push({emit:[a,b]})},connect:function(){c()}};K.connect();k.Define.namespace("qubit.qprotocol.PubSub",K);(function(){function a(b){a.SUPER.apply(this,arguments)}var b=k.qprotocol.PubSub,h=k.opentag.Utils;
k.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",a,k.opentag.pagevariable.BaseVariable);a.prototype.init=function(){if(this.initialized)return!1;this.initialized=(new Date).valueOf();this.callHandlersOnRead=!0;if(!this.handlerAttached){var a=this,d=this.getValueAndPath(this.value);this.eventName=d[0];this.objectPath=d[1];this.updateValue();b.subscribe(this.eventName,function(b){a.updateValue(b)});this.handlerAttached=(new Date).valueOf()}};a.prototype.getValueAndPath=function(a){var b=
a,e;if(b){var h=a.indexOf(":");-1!==h&&(b=a.substring(0,h),e=a.substring(h+1))}return[b,e]};a.prototype.getValue=function(){this.init();return this.currentValue};a.prototype.getEventsHistory=function(){return b.getEventHistory(this.eventName)};a.prototype.updateValue=function(a){if(!a){var b=this.getEventsHistory();b&&(a=b.current)}b=this.objectPath;a=a&&b?h.getObjectUsingPath(b,a):a;this._updateCurrentValue(a);return a};a.prototype.startObservingForChanges=function(){};a.prototype.stopObservingForChanges=
function(){}})();(function(){function a(){}function b(a,d){var e=[];try{var h=a.parameters;if(h)for(var l=0;l<h.length;l++)a.getVariableForParameter(h[l])===d&&e.push(h[l])}catch(c){}return e}var h=k.opentag.Utils,c=k.opentag.TagsUtils,d=k.opentag.pagevariable.BaseVariable,e=k.opentag.pagevariable.Expression,f=k.opentag.pagevariable.DOMText,g=k.opentag.pagevariable.Cookie,n=k.opentag.pagevariable.URLQuery;k.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,b,d,e){if(e=void 0!==
e?e:a.getHtml()){var l="END"===a.config.locationPlaceHolder,h=c.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{h?c.injectHTML(h,l,e,function(){a.injectHTMLNotFinished=!1;if(b)try{b()}catch(l){}}.bind(a)):d&&"loading"===document.readyState?(document.write(e),a.injectHTMLNotFinished=!1):a.injectHTMLFailed=(new Date).valueOf()}catch(n){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(a){for(var d=a.getPageVariables(),e=[],h=0;h<d.length;h++)for(var l=
d[h],c=b(a,l),n=0;n<c.length;n++)e.push({parameter:c[n],variable:l});return e};a.allParameterVariablesReadyForTag=function(a,d){for(var e=!0,h=a.getPageVariables(),l=0;l<h.length;l++){var c=h[l];try{var n=b(a,c),f=c.exists();!f&&d&&(0<n.length&&(f=!!n[0].defaultValue),f=f||c.exists(!0));if(!f){e=!1;break}}catch(k){e=!1;break}}return e};a.validateAndGetVariableForParameter=function(b){b.hasOwnProperty("variable")&&b.variable&&(b.variable=a.initPageVariable(b.variable));return b.variable};a.initPageVariable=
function(a){if(!a||a instanceof d)return a;if("string"===typeof a){var b=h.getObjectUsingPath(a);if(b&&b instanceof d)return b}switch(a.type){case "2":return new e(a);case "3":return new n(a);case "4":return new g(a);case "5":return new f(a);case "EPRESSION":return new e(a);case "URL_PARAMETER":return new n(a);case "COOKIE_VALUE":return new g(a);case "DOM_VALUE":return new f(a);default:return new d(a)}}})();(function(){function a(a){this.log=new g("",function(){return this.CLASS_NAME+"["+this.config.name+
"]"}.bind(this),"collectLogs");this.runCounter=this.urlsFailed=this.urlsLoaded=0;this.events=new k.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+f++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1,restartable:!0};
this.restartCounter=0;this.cancelled=!1;this.runtimeId=h.UUID();this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=[];if(a){if(!a.name){var b="Tag-"+f++;this.config.name=b}this.addState("INITIAL");for(var d in a)this.config[d]=a[d];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&(this.dependencies=a.dependencies.concat(this.dependencies));a.PACKAGE&&(this._package=
a.PACKAGE);this.onInit()}}function b(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),d=this._bodyNeededButNotAvailable();a||d?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?this._markLoadedSuccesfuly():
(this.addState("TIMED_OUT"),this._markLoadingDependenciesFailed(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(b.bind(this),65)}}var h=k.opentag.Utils,c=k.opentag.TagsUtils,d=k.opentag.Timed,e=k.opentag.TagHelper,f=0,g=k.opentag.Log;k.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.EVENT_TYPES={AFTER_EVENT:"after",BEFORE_EVENT:"before",RESTART_EVENT:"restart"};a.prototype.onInit=
v;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?this.config.html:this.htmlContent?h.trim(this.htmlContent):null};a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(b){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this._onError(b)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var b=+this.config.timeout,d=this.dependencies;
if(-1!==b&&0<d.length){var e=0;a=a||[];if(-1===h.indexInArray(a,this)){a[a.length]=this;for(var c=0;c<d.length;c++){var l=d[c]._getTimeout(a);l>e&&(e=l)}0<e&&(b+=e)}else return 0}return b};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=v;a.prototype._flushDocWrites=function(a){var b=!0;this._docWriteNotFlushed=!1;try{var d=c.getHTMLLocationForTag(this);d&&this._securedWrites&&0<this._securedWrites.length&&((b=c.flushDocWritesArray(this._securedWrites,d,"END"===this.config.locationPlaceHolder,
this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=(new Date).valueOf())}catch(e){this._onError(e)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(b=!1,this._docWriteNotFlushed=(new Date).valueOf());return b};a.prototype.log=v;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.events.call("before",this)}catch(a){this._onError(a)}};a.prototype.onBefore=
function(a){this.events.on("before",a)};a.prototype.after=function(a){this.afterRun=(new Date).valueOf();try{this.events.call("after",{success:a,tag:this})}catch(b){this._onError(b)}};a.prototype.onAfter=function(a){this.events.on("after",a)};a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.run=function(){if(!isNaN(this.config.runningLimit)&&this.config.runningLimit<=this.runCounter)return!1;
if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();
return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=(new Date).valueOf();for(var a=this.dependencies,b=0;b<a.length;b++)try{a[b].events.on("success",this._depLoadedHandler)}catch(d){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,b=0;b<a.length;b++)if(a[b]!==this&&!(0<+a[b].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,b){this._wasTimed=(new Date).valueOf();var e=this.runtimeId,h=function(){if(this.runtimeId===e)return a()}.bind(this);
return d.setTimeout(h,b)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=function(){this.loadedDependencies?this.execute():this.loadingDependenciesFailed?(this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();
else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=(new Date).valueOf();a=!1;try{a=this.before()}catch(b){this._onError(b)}if(a){this._markFailure();this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=
(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(d){this.executedWithErrors=(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();
this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),c.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};a.prototype.onFinished=v;a.prototype.onCancel=v;a.prototype.onFinished=v;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==
this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),
this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,
FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];try{this.onStateChange(a)}catch(b){this._onError(b)}}};a.prototype.onStateChange=v;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.unCancel=function(){this.cancelled=!1};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=
(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=function(){this._securedWrites||(this._securedWrites=[],c.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");this.loadingDependenciesFailed=(new Date).valueOf()};a.prototype.allDependenciesLoaded=function(a,b){return 0===this.getDependenciesToBeLoaded(a,b).length};a.prototype.getDependenciesToBeLoaded=
function(a,b){var d=b||[];this.injectionLocationReady()||d.push("injection location");var e,h=this.dependencies;for(e=0;e<h.length;e++)h[e]!==this&&(0<+h[e].scriptExecuted||d.push("dependant Tag with name -> "+(h[e].config?h[e].config.name:"anonymous")));for(e=0;e<this.genericDependencies.length;e++)this.genericDependencies[e](this)||d.push("this.genericDependencies["+e+"] (index: "+e+")");return d};a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};
a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?!1:this._isBodyLocationNeeded()&&!c.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;
var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!h.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!c.getHTMLLocationForTag(this):
!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,b){return this.addDependenciesList(a,k.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(b,d){if(b&&0!==b.length){this.failedDependenciesToParse||(this.failedDependenciesToParse=[]);for(var e=this.dependencies,c=0;c<
b.length;c++){var f=b[c],l=!1;if(f instanceof a)e.push(f);else if("string"===typeof f){var x=f;d&&(f=d+"."+f);var u=h.getObjectUsingPath(f);u?u instanceof a?e.push(u):l=!0:this.failedDependenciesToParse.push(x)}else l=!0;l&&(this.badDepsObjects=this.badDepsObjects||[],h.addToArrayIfNotExist(this.badDepsObjects,f))}}};a.prototype._loadDependencies=function(a){a=a||[];var b=this.dependencies;if(-1===h.indexInArray(a,this)){a[a.length]=this;for(var d=0;d<b.length;d++)b[d].load(a)}};a.prototype.onError=
v;a.prototype._onError=function(a){try{this.onError(a)}catch(b){}};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=v;a.prototype.onScriptsLoadSuccess=v;a.prototype.onScriptLoadError=v;a.prototype.onAllDependenciesLoaded=v;a.prototype.onBeforeLoad=null;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");try{!this._ignoreDeps&&
this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(d){throw d;}b.call(this)}};a.prototype._singleUrlLoadHandler=function(a,b,d){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===b.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{d&&d(!0)}catch(e){this._onError(e)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);this.addState("FAILED_TO_LOAD_URL");
this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,d&&d(!1)}catch(h){this._onError(h)}finally{this.onScriptLoadError(a)}}};a.prototype.loadURLs=function(a,b){var d=a||this.config.url;this.addState("LOADING_URL");try{!d||d instanceof Array||(d=[d]);for(var e=0;e<d.length;e++){this.loadURLsNotFinished=!0;var h=d[e],h=this.prepareURL(h);this.loadURL(h,function(a){this._singleUrlLoadHandler(a,d,b)}.bind(this))}}catch(l){this.loadURLsNotFinished=!1,this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=
(new Date).valueOf(),this._onError(l)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,b,d){this.addState("LOADING_URL");c.loadScript({onsuccess:function(){try{b&&b(!0)}catch(a){}}.bind(this),onerror:function(){try{b&&b(!1)}catch(a){}}.bind(this),url:a,node:d||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};a.prototype.onRestart=
function(a){this.events.on("restart",a)};a.prototype.prepareForRestart=function(){if(this.config.restartable){var a=this.restartCounter+1;this.events.call("restart",this);this.reset();this.restartCounter=a}};a.prototype.restart=function(){this.config.restartable&&(this.prepareForRestart(),this.run())};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=this.loadingTimedOut=this.loadingDependenciesFailed=this.loadedDependencies=
this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=this.lastRun=this.isRunning=this.waitForDependenciesFinished=void 0;this.restartCounter=
0;this.runtimeId=h.UUID();this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(a){var b=!this.docWriteAsksToWaitForBody(),d=this.prepareHTML(this.getHtml());d&&e.injectHTMLForLoader(this,a,b,d)};a.prototype.clone=function(){return new a(this.config)}})();(function(){function a(b){h.setIfUnset(b,
{filterTimeout:b&&b.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:b&&b.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1,reRunOnVariableChange:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this._runtimeMarkers={};this.parameters=[];this.filters=[];this.session=null;this.owningContainers=[];this.oldDedupePingSent=this.dedupePingSent=this.oldPingSent=this.pingSent=!1;this.reRunCounter=0;if(b){this.addState("INITIAL");try{a.register(this)}catch(d){}this.setupConfig(b);
this.uniqueRefString=null;if(b.init)try{b.init.call(this,b)}catch(e){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}function b(a,d){var h=a.namedVariables,c=e.initPageVariable(h[d]);return h[d]=c}var h=k.opentag.Utils,c=k.opentag.TagsUtils,d=k.opentag.filter.BaseFilter,e=k.opentag.TagHelper,f=k.opentag.pagevariable.BaseVariable,g=k.Cookie,n=k.Define;n.clazz("qubit.opentag.BaseTag",a,k.opentag.GenericLoader);a.prototype.setupConfig=function(a){if(a){a.filters&&this.addFilters(a.filters);
a.parameters&&this.addParameters(a.parameters);if(a.variables)for(var b in a.variables)if(a.variables.hasOwnProperty(b)){var d=this.getParameterByTokenName(b);if(d){var e=a.variables[b];d.variable=e;void 0!==e.defaultValue&&(d.defaultValue=e.defaultValue);void 0!==e.uv&&(d.uv=e.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,d){var e=this.getParameterByTokenName(a);if(e)return void 0===d&&this.loadingTimedOut&&(d=!0),this.getParameterValue(e,d);if((e=this.namedVariables)&&e[a]&&
(e=b(this,a)))return e.getRelativeValue(d)};a.prototype.addParameters=function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype._isVariable=function(a){return null!==a&&void 0!==a};a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var a=this.parameters;if(a)for(var b=0;b<a.length;b++){var d=this.getVariableForParameter(a[b]);if(!this._isVariable(d)){this._markLoadingDependenciesFailed();
this._markFinished();return}}if(this.config.runner){a=!1;try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(e){}return a}this._runner=!1;return this.start()};a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):
a.SUPER.prototype.run.call(this)};a.prototype.startOnce=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";
this.resolveAllDynamicData();var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===d.state.SESSION)this.addState("AWAITING_CALLBACK"),this.awaitingCallback=(new Date).valueOf();else if(a===d.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(b){}this.run()}else if(a===d.state.FAIL)this._markFiltersFailed(),this._markFinished();else if(0<a){var e=this.config.filterTimeout;if(0>e||
(new Date).valueOf()-this.filtersRunTriggered>e){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(h){}}this._setTimeout(this.runIfFiltersPass.bind(this),a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(c){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE=
{INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(b){a.SUPER.prototype.addState.call(this,b);try{a.onStateChange(this)}catch(d){}this.stateStack=[];b=this.STATE;var e=this.state,h=this.stateStack;e&
b.INITIAL&&h.push("Initial state.");e&b.FILTER_ACTIVE&&h.push("Tag running with filters pass triggered.");e&b.FILTERS_FAILED&&h.push("Filters failed to pass.");e&b.AWAITING_CALLBACK&&h.push("Awaiting callback to run this tag. Not pooling.");e&b.STARTED&&h.push("Tag is initialized and loading has been started.");e&b.LOADING_DEPENDENCIES&&h.push("Dependencies are being loaded.");e&b.LOADED_DEPENDENCIES&&h.push("Dependencies loading process has been finished.");e&b.LOADING_URL&&h.push("External URL is being loaded.");
e&b.LOADED_URL&&h.push("External URL has been loaded.");e&b.EXECUTED&&h.push("Main script has been executed.");e&b.EXECUTED_WITH_ERRORS&&h.push("Main script has been executed but errors occured.");e&b.FAILED_TO_LOAD_DEPENDENCIES&&h.push("Dependencies has failed to load.");e&b.FAILED_TO_LOAD_URL&&h.push("URL location failed to load.");e&b.FAILED_TO_EXECUTE&&h.push("Script failed to execute.");e&b.TIMED_OUT&&h.push("Script timed out awaiting for dependencies.");e&b.UNEXPECTED_FAIL&&h.push("Script occured UNEXPECTED exception and is failed.");
e&b.CANCELLED&&h.push("Tag has been cancelled.")};a.prototype.onTagInit=v;a.onStateChange=v;a.prototype.onFiltersDelayed=v;a.prototype.onFiltersPassed=v;a.prototype.onFiltersCheck=v;a.prototype.state=a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return e.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(b,d){var e=d||[];this.arePageVariablesLoaded(b)||e.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,
b,e)};a.prototype.resolveAllDynamicData=function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,n.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=this._addVariablesMap(a,n.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=
this.unresolvedClientVariablesMap;a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));if(a=this.unresolvedVariablesMap)this.unresolvedVariablesMap=null,this.addVariablesMap(a);return this.getPageVariables()};a.prototype.addVariablesMap=function(a){return this.unresolvedVariablesMap=this._addVariablesMap(a)};a.prototype._addVariablesMap=function(a,b){if(a){var d={},e=this.namedVariables,c;for(c in a)if(a.hasOwnProperty(c)){var g=a[c];if(g instanceof f)e[c]=g;else if("string"===
typeof g){var k=g;b&&(g=b+"."+g);var n=h.getObjectUsingPath(g);n?e[c]=n instanceof f?n:g:d[c]=k}}return d}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===typeof this.config.script)this.script=this.config.script;else{var b=
this.replaceTokensWithValues(String(this.config.script));this.script=h.expressionToFunction(b).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var b=this.parameters;if(b)for(var d=0;d<b.length;d++){var e=this.getVariableForParameter(b[d]);if(e){var h=b[d].token,c=this.valueForToken(h);a=e.replaceToken(h,a,c)}}return a};a.prototype.getParameter=function(a){var b=this.parameters,d=null;if(b)for(var e=0;e<b.length;e++)b[e].name===
a&&(d=b[e]);return d};a.prototype.setParameterValueByTokenName=function(a,b){var d=this.getParameterByTokenName(a);return null!==d?(d.variable={value:b},!0):!1};a.prototype.getParameterValue=function(a,b){var d="string"===typeof a?this.getParameter(a):a;if(d){var e=this.getVariableForParameter(d);if(e)try{var c;b&&""!==d.defaultValue&&(c=h.gevalAndReturn(d.defaultValue).result);return c=e.getRelativeValue(b,c)}catch(f){}}};a.prototype.filtersState=function(a){return c.filtersState(this.filters,this.session,
this,a)};a.prototype.addFilter=function(a){h.addToArrayIfNotExist(this.filters,a)};a.prototype.addFilters=function(a){for(var b=0;b<a.length;b++)this.addFilter(a[b])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,n.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=
function(a,b){for(var e=[],c=0;c<a.length;c++)try{var f=a[c],g=null;"string"===typeof f&&(g=f,b&&(f=b+"."+f),f=h.getObjectUsingPath(f));"function"===typeof f&&(f=new f);!f instanceof d&&(f=null);f?this.addFilter(f):g&&h.addToArrayIfNotExist(e,g)}catch(k){this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[c])}return e};a.prototype.reset=function(b){a.SUPER.prototype.reset.call(this);this.filtersPassed=void 0;this.oldPingSent=this.pingSent=this.oldDedupePingSent=this.dedupePingSent=
!1;this._runner=this.filtersRunTriggered=this._runOnceIfFiltersPassTriggered=void 0;this.reRunCounter=0;this.detachVariablesChangedListeners();b||this.resetFilters()};a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=function(a){var b=null;if(this.parameters)for(var d=this.parameters,e=0;e<d.length;e++)d[e].token===a&&(b=d[e]);return b};a.prototype.removeFilter=function(a){h.removeFromArray(this.filters,a)};var m=
0,r=[],p={},s={};a.register=function(a){var b=h.addToArrayIfNotExist(r,a);a._tagIndex=-1===b?r.length-1:b;a.config.id?(b="Q"+a.config.id,s[b]=a,a.uniqueId=b):s[a.CLASSPATH]=a};a.getById=function(a){return s[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(b){a.unregister(b||this)};a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){h.removeFromArray(r,a);a._tagIndex=-1};a.getTags=function(){return r};a.getAccessorsMap=
function(){return p};a.prototype.getTags=function(){return r};a.prototype.getPageVariables=function(){var a=this.parameters,d=[];if(a)for(var e=0;e<a.length;e++){var c=this.getVariableForParameter(a[e]);this._isVariable(c)&&h.addToArrayIfNotExist(d,c)}if(this.namedVariables)for(var f in this.namedVariables)h.addToArrayIfNotExist(d,b(this,f));return d};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+m++,p[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+
this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var d,h=this.namedVariables;h&&h[a.token]&&(d=b(this,a.token));d||(d=e.validateAndGetVariableForParameter(a));return d};a.prototype.printVariablesState=function(){for(var a=[],b=e.getAllVariablesWithParameters(this),d=0;d<b.length;d++){var h=b[d].parameter,c=b[d].variable,f;f=h&&h.token?this.valueForToken(h.token):c.getRelativeValue(!0);h={name:c.config.name,exists:c.exists(),token:h?h.token:null,value:f,variable:c};a.push(h)}return a};
a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?this.config.id:0===String(this.CLASSPATH).indexOf(n.STANDARD_CS_NS)?this.CLASSPATH.substring(n.STANDARD_CS_NS.length+1):this.CLASSPATH+"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),b=!!g.get("qubit.tag.forceAllToRun");b||(b=!!g.get("qubit.tag.forceRunning_"+a));return b};
a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();g.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){g.set("qubit.tag.forceAllToRun","true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();g.set("qubit.tag.disableRunning_"+a,"true")};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();g.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!g.get("qubit.tag.disableRunning_"+
a)};a.rmCookieForcingTagsToRun=function(){g.rm("qubit.tag.forceAllToRun")};a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();g.rm("qubit.tag.forceRunning_"+a)};a.rmAllDisablingCookies=function(){h.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=function(){h.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()};a.prototype.onVariableChanged=function(a){this.attachVariablesChangedListeners(!0);this.events.on("variableChanged",
a)};a.prototype._handleVariableChange=function(a){this.events.call("variableChanged",a);this.isRunning||!this.config.reRunOnVariableChange||!isNaN(this.config.reRunLimit)&&this.config.reRunLimit<=this.reRunCounter||(a=this.reRunCounter+1,this.reset(),this.reRunCounter=a,this.resetFilters(),this.runIfFiltersPass())};a.prototype.attachVariablesChangedListeners=function(a){var b=this.getPageVariables();if(a=!!(this.config.reRunOnVariableChange||this.config.observeVariables||a))for(var d=0;d<b.length;d++)b[d].onValueChanged(this.handleVariableChange,
a)};a.prototype.detachVariablesChangedListeners=function(){for(var a=this.getPageVariables(),b=0;b<a.length;b++)a[b].deatchOnValueChanged(this.handleVariableChange)};a.prototype._markFinished=function(){a.SUPER.prototype._markFinished.call(this);this.attachVariablesChangedListeners()};a.prototype.prepareForRestart=function(b){if(this.config.restartable&&(a.SUPER.prototype.prepareForRestart.call(this,!1),!b)){b=this.getFilters();for(var d=0;d<b.length;d++)b[d].prepareForRestart()}};a.prototype.restart=
function(a){this.config.restartable&&(this.prepareForRestart(a),this.runIfFiltersPass())}})();(function(){function a(b){h.setIfUnset(b,a.defaultConfig);if(this.singleton){var e=k.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,g);if(e.__instance)return e.__instance;e.__instance=this}a.SUPER.call(this,b)}function b(a,e){var c=a.toString(),c=c.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,""),c=c.substring(0,c.lastIndexOf("}")),c=c.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,
'$1"${$2}"'),c=c.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),c=c.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),c=c.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),c=c.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3"),c=c.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3"),c=e.replaceTokensWithValues(c);h.geval(c)}
var h=k.opentag.Utils,c=k.Define;k.Define.clazz("qubit.opentag.LibraryTag",a,k.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var d=this.config;if(d&&d.pre)if("function"===typeof d.pre)this.pre=d.pre;else{var e=this.replaceTokensWithValues(String(d.pre));this.pre=
h.expressionToFunction(e).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?b(this.pre,this):this.pre()}catch(c){return!0}return!1};a.prototype.after=function(d){a.SUPER.prototype.after.call(this,d);try{var e=this.config;if(e&&e.post)if("function"===typeof e.post)this.post=e.post;else{var c=this.replaceTokensWithValues(String(e.post));this.post=h.expressionToFunction(c).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?
b(this.post,this):this.post(d)}catch(f){}};a.define=function(b,e){b=b.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");b=k.Define.vendorsSpaceClasspath(b);var f={};e.getDefaultConfig&&(f=e.getDefaultConfig());var g=e.CONSTRUCTOR,n={},r;for(r in e)"config"!==r&&(n[r]=e[r]);n=k.opentag.Utils.defineWrappedClass(b,a,n,m,function(a){a=a||{};a=h.overrideFromLeftToRight(f,a);var b=k.opentag.LibraryTag.call(this,a);g&&g.call(this,a);if(b)return b});r=c.STANDARD_VS_NS+".";0!==b.indexOf(r)&&
h.namespace(r+b,n);return n};a.getLibraryByClasspath=function(a){return h.getObjectUsingPath(a,k.Define.getVendorSpace())}})();(function(){function a(c){b.setIfUnset(c,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,c)}var b=k.opentag.Utils;k.Define.clazz("qubit.opentag.CustomTag",a,k.opentag.LibraryTag)})();(function(){var a=k.opentag.Utils,b=k.opentag.filter.BaseFilter,c=function(){};k.Define.clazz("qubit.opentag.Tags",c);c.getById=function(a){return k.opentag.BaseTag.getById(String(a))};
c.getAllTagsByState=function(){return k.opentag.Container.getAllTagsByState(c.getTags())};c.findTagByName=function(a){for(var b=this.getTags(),c=[],h=0;h<b.length;h++)b[h].config.name===a&&c.push(b[h]);return c};c.findTagByMatch=function(a){for(var b=this.getTags(),c=[],h=0;h<b.length;h++)b[h].config.name.match(a)&&c.push(b[h]);return c};c.findTagContainers=function(a){for(var b=c.getContainers(),f=[],g=0;g<b.length;g++){var k=b[g].tags,m;for(m in k)if(k[m]===a){f.push(b[g]);break}}return f};c.getTags=
function(){return k.opentag.BaseTag.getTags()};c.resetAllTags=function(a){for(var b=c.getTags(),f=0;f<b.length;f++)b[f].reset(),a||b[f].resetFilters()};c.getContainersPageVariables=function(){for(var a=c.getContainers(),b=[],f=0;f<a.length;f++)b=b.concat(a.getPageVariables());return b};c.getAllPageVariables=function(){for(var a=c.getTags(),b=[],f=0;f<a.length;f++)b=b.concat(a[f].getPageVariables());return b};c.cancelAll=function(){for(var a=c.getTags(),b=0;b<a.length;b++)a[b].cancel()};c.resetAll=
function(a){for(var b=c.getTags(),f=0;f<b.length;f++)b[f].reset(),a||b[f].resetFilters()};c.getPageVariableByName=function(a){for(var b=c.getAllPageVariables(),f=[],g=0;g<b.length;g++)b[g].config.name===a&&f.push(b[g]);return f};c.getLoadTime=function(a){var b=a.beforeRun,c=a.runIsFinished;return isNaN(c)?{tag:a,loadTime:null}:{tag:a,loadTime:c-b}};c.getLoadTimes=function(a){var b=[];if(a instanceof k.opentag.BaseTag)return b.push([c.getLoadTime(a[f])]),b;a=a||c.getTags();if(a instanceof Array)for(f=
0;f<a.length;f++)a[f]instanceof k.opentag.BaseTag&&b.push(c.getLoadTime(a[f]));else for(var f in a)a[f]instanceof k.opentag.BaseTag&&b.push(c.getLoadTime(a[f]));return b};c.forceAllContainersAndTagsToRunIfDisabled=function(){k.opentag.Container.setCookieForDisabledContainersToRun();k.opentag.BaseTag.setCookieForcingTagsToRun()};c.rmAllContainersAndTagsForcingFlags=function(){k.opentag.Container.rmCookieForDisabledContainersToRun();k.opentag.BaseTag.rmAllCookiesForcingTagToRun()};c.getContainers=function(){return k.opentag.Container.getContainers()};
c.findAllTagsByClassPath=function(b){var e=[],f=[];try{f.push(k.opentag.CustomTag),f.push(k.opentag.LibraryTag)}catch(g){}for(var n=c.getTags(),m=0;m<n.length;m++){var t=n[m];0>a.indexInArray(f,t)&&0===t.PACKAGE_NAME.indexOf(b)&&e.push(t)}return e};c.findAllTags=function(a,b){var f=k.opentag.BaseTag,g=[];try{g.push(k.opentag.CustomTag),g.push(k.opentag.LibraryTag)}catch(n){}return c.findAllInstances(a,f,g,b)};var f=function(b,e,c,h){var f=[];"string"===typeof b&&(b=a.getObjectUsingPath(b));if(b){var g=
{objectsOnly:!0};h&&(g.maxDeep=!0);h=function(b,d,h,l){if(e(b)){for(d=0;d<c.length;d++)if(c[d]===b)return!0;a.addToArrayIfNotExist(f,b);return!0}return!1}.bind(this);a.traverse(b,h,g)}return f};c.findAllInstances=function(a,b,c,h){return f(a,function(a){return a instanceof b},c,h)};c.findAllInheriting=function(a,b,c,h){return f(a,function(a){return a.prototype instanceof b},c,h)};c.findAllFilters=function(a,e){var f=[];try{f.push(k.opentag.filter.Filter),f.push(k.opentag.filter.URLFilter)}catch(g){}return c.findAllInheriting(a,
b,f,e)}})();b={};f=void 0;b.update=function(){var a,b;b=function(){return Math.floor(1+65536*Math.random()).toString(36).substring(1)};window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+b()+b()+b());return window.__pageViewId__};s.PostData=function(a,b,c,f){var d,e,g;d=navigator.userAgent.toLowerCase();e=-1!==d.indexOf("msie");d.indexOf("msie 9");d=-1!==d.indexOf("msie 7")||-1!==d.indexOf("msie 6");g=("https:"===document.location.protocol?"https:":"http:")+a;c=c||
"POST";a=function(){var a;try{a=null;try{a=new XMLHttpRequest}catch(d){}a&&!e?a.open(c,g,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(c,g)):a=null;try{a.withCredentials=!1}catch(k){}a.setRequestHeader&&(f?a.setRequestHeader("Content-Type",f):a.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));a.onload=function(){};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(b)}catch(m){try{try{s.fileLoader.load(g)}catch(r){window.console&&
window.console.log&&window.console.log(m)}}catch(p){}}};d?s.fileLoader.load(g):a()};(function(){function a(){}function c(a,f){var d={};d.clientId=""+f.clientId;d.containerId=""+a.getContainerId();d.classpath=""+a.PACKAGE_NAME;d.opentagStats=!0;a.sentPing?d.containerLoad=!1:(a.sentPing=(new Date).valueOf(),d.containerLoad=!0);d.isS3=!1;d.pageViewId=b.update();d.tags=[];return d}k.Define.clazz("qubit.opentag.Ping",a);a.prototype.sendErrors=function(a,b){};a.getPingID=function(a){if(a.config.id)return a.config.id;
var b=a.PACKAGE_NAME.lastIndexOf(".");return-1!==b?a.PACKAGE_NAME.substring(b+1):a.PACKAGE_NAME};a.prototype.send=function(b,f){for(var d=b.config,e=c(b,d),g=e.tags,d=d.pingServerUrl,k=0;k<f.length;k++){var n=f[k].tag,m=f[k].loadTime;if(null!==m&&!isNaN(m)){var p={},q=a.getPingID(n);!n.pingSent&&q&&null!==m&&void 0!==q&&(p.tagId=q,p.loadTime=m,p.fired=!0,g.push(p),n.pingSent=!0)}}d&&(0<g.length||e.containerLoad)&&(e=r.stringify(e),s.PostData("//"+d,e,"POST","text/plain;charset=UTF-8"))};a.prototype.sendDedupe=
function(b,f){for(var d=b.config,e=c(b,d),d=d.pingServerUrl,g=e.tags,k=0;k<f.length;k++){var n=f[k],m=a.getPingID(n),p={};void 0===m||n.dedupePingSent||(p.tagId=""+m,p.fired=!1,p.loadTime=0,g.push(p),n.dedupePingSent=!0)}d&&(0<g.length||e.containerLoad)&&(e=r.stringify(e),s.PostData("//"+d,e,"POST","text/plain;charset=UTF-8"))}})();f={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var b,c;b=k.Cookie.get(f._cookieName);c=k.Cookie.get(f._sessionCookie);if(b){if(b=parseInt(b,10),!c||
parseInt(c,10)<(new Date).getTime()-18E5)b+=1}else b=1;k.Cookie.set(f._cookieName,b,365,a);k.Cookie.set(f._sessionCookie,(new Date).getTime().toString(),null,a);return b}};(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=c,this.dict=e}function b(a,d){for(var e in d)if(a===d[e])return e;return null}for(var c=[],f=Math.pow(2,8),d=0;d<f;d++)c.push(String.fromCharCode(d));for(var e={},
f=0;f<c.length;f++)e[c[f]]=f;k.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var b=this.alphabet.length,d={},e=[],c=0,f=a.charAt(c++),h,l=this.dict;h=a.charAt(c++);){var g=f+h;if(l.hasOwnProperty(g)||d.hasOwnProperty(g))f=g;else{var k=l.hasOwnProperty(f)?l[f]:d[f];if(void 0===k)throw"Dictionary base is to small for those contents: "+f;e.push(k);d[g]=b++;f=h}}""!==f&&e.push(d.hasOwnProperty(f)?d[f]:l[f]);return e};a.prototype.decode=function(a){for(var d=this.dict,e=this.alphabet.length,
c,f={},h=b(a[0],d),g=h,l=[h],k=1;k<a.length;k++){var u=a[k];c=b(u,d);null===c&&(f.hasOwnProperty(u)&&(c=f[u]),null===c&&(c=g+h));l.push(c);h=c.charAt(0);f[e++]=g+h;g=c}return l.join("")}})();(function(){function a(a){}for(var b={},c=0;45>c;c++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(c)]=c;for(var f={},c=0;45>c;c++)f['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(c)]=c;for(var d={},c=0;45>c;c++)d["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(c)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(c);
var e="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),g=e.length,m=new k.compression.LZW({});k.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,b){for(var d=(b||m).encode(a),e=[],c=0;c<d.length;c++)e.push(String.fromCharCode(d[c]));return e.join("")};a.prototype.compressAnsi=function(a,b){for(var c=(b||m).encode(a),f=[],h=0;h<c.length;h++){var l;l=c[h];var k=0,u=0>l;u&&(l=-l);var r="",p=!0;do k=l%g,p?(r=d[e[k]],p=!1):r=e[k]+r,l=(l-k)/g;while(0<l);l=u?"-"+r:
r;f.push(l)}return f.join("")};a.prototype.decompressAnsi=function(a,d){for(var e=[],c="",h=0;h<a.length;h++){var l=a.charAt(h);if(f.hasOwnProperty(l)){for(var l=c+l,c="",k=0,u=0,r=!0,p=0;p<l.length;p++){var s=l.charAt(l.length-1-p);r&&(r=!1,s="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(f[s]));k+=b[s]*Math.pow(g,u++)}l=k;e.push(l)}else c+=l}return(d||m).decode(e)};a.prototype.decompress=function(a,b){for(var d=[],e=0;e<a.length;e++)d.push(a.charCodeAt(e));return(b||m).decode(d)}})();(function(){function a(a){for(var b=
[],e=0;e<a.length;e++){var c=d(a[e][0]);b.push([new RegExp(c,"g"),"*"+a[e][1]])}return b}function b(a,d){for(var e=0;e<d.length;e++)if(d[e][1]===a)return d[e][0];return null}function c(b){this._regexDefs=r;this._defs=n;b&&b.definitions&&(this._regexDefs=a(b.definitions),this._defs=b.definitions)}function f(a,b){for(var d=[],e=0;e<a.length;e++){var c=!0;b&&(c=a.charCodeAt(e)<=b);var h=m.cookieAlphabetMap.hasOwnProperty(a.charAt(e));c&&!h?d.push("*"+a.charCodeAt(e)+"."):d.push(a.charAt(e))}return d.join("")}
function d(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function e(a){for(var b={},d="",e=0;e<a.length;e++){var c=a.charAt(e);p[c]?d+=c:(isNaN(b[d])&&(b[d]=a.split(d).length-1),d="")}a=[];for(var f in b)b.hasOwnProperty(f)&&(d=b[f],d>=q&&f.length>=s&&a.push([f,d]));return a=a.sort(function(a,b){return a[0].length===b[0].length?0:b[0].length>a[0].length?1:-1})}var g=k.Define,m=k.Cookie,n=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',
"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww","10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],
["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'","i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],r=a(n);g.clazz("qubit.opentag.compression.Encoder",c);c.prototype.encode=function(a,b){for(var c=a.replace(/\*/g,"**"),h=e(c),g=0;g<this._regexDefs.length;g++)var k=this._regexDefs[g],c=c.replace(k[0],k[1]);c=c.replace(/;/g,
"*-");c=c.replace(/&/g,"*.");c=c.replace(/\\/g,"*/");c=c.replace(/=/g,"*+");c=c.replace(/\n/g,"*N");c=c.replace(/ /g,"*_");c=c.replace(/\t/g,"*T");c=c.replace(/"/g,"*Q");g=e(c);g.concat(h);for(var h=c.replace(/@/g,"@@"),k=[],m=0,n=0;m<g.length;m++){var r=new RegExp(d(g[m][0]),"g"),r=h.replace(r,"@"+n+"-");r!==h&&(k.push(g[m][0]),n++,h=r)}g=[h,k];h=g[1];(k=0<h.length)&&(c=g[0]);c=b?f(c,b):f(c);return k?"Y"+h.join("*")+"@"+c:"N"+c};for(var p={},g=0;65>g;g++)p["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(g)]=
!0;var s=4,q=2;c.prototype.decode=function(a){var d=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var c=a.indexOf("@");if(0<=c&&(d=a.substring(1,c),d=d.split("*"),a=a.substring(c+1),d&&0!==d.length&&a)){for(var c="",e=!1,f=!1,h="",g=0;g<a.length;g++){var k=a.charAt(g);"@"===k||e||f?e||f?(e=!1,"@"===k?c+="@":isNaN(+("-"+k))?f?(c=d&&"-"===k&&d[+h]?c+d[+h]:c+("@"+h+k),h="",f=!1):c+="@"+k:(f=!0,h+=k)):e=!0:c+=k}h&&(c+="@"+h);e&&(c+="@");a=c}}d="";e=c=!1;f="";for(h=0;h<a.length;h++)g=
a.charAt(h),"*"===g||c||e?c||e?(c=!1,isNaN(+("-"+g))?e?(d="."===g?d+String.fromCharCode(+f):"-"===g&&b(f+"-",this._defs)?d+b(f+"-",this._defs):d+("*"+f+g),f="",e=!1):"*"===g?d+="*":"-"===g?d+=";":"/"===g?d+="\\":"."===g?d+="&":"+"===g?d+="=":"N"===g?d+="\n":"_"===g?d+=" ":"T"===g?d+="\t":"Q"===g?d+='"':null!==b(g,this._defs)?(g=b(g,this._defs),d+=g):d+="*"+g:(f+=g,e=!0)):c=!0:d+=g;f&&(d+="*"+f);c&&(d+="*");return d}})();(function(){function a(a){this.testBinary=!1;this.binSupported=c;a&&(this.compressor=
new k.compression.Compressor,this.encoder=new k.opentag.compression.Encoder({}))}var b=k.Cookie,c=!1;k.Define.clazz("qubit.opentag.compression.CookieCompressor",a);a.prototype.compress=function(a,d){if("string"!==typeof a||""===a)return a;var c=this.encoder.encode(a),f;if(this.binSupported||this.testBinary){f=this.compressor.compress(c);f='"B'+this.encoder.encode(f,128)+'"';b.set("__qtag_test_bin__",f,void 0,void 0,!0);var h=b.get("__qtag_test_bin__",!0);b.rm("__qtag_test_bin__");h&&h!==f&&(f=null)}h=
this.encoder.encode(this.compressor.compressAnsi(c));c=!d&&c.length<=h.length?"E"+c:"C"+h;return f&&f.length<c.length?f:c};a.prototype.decompress=function(a){if("string"!==typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var b=a.charAt(0);a=a.substring(1);switch(b){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);
default:throw"This code is not supported! Code: "+b;}}})();(function(){var a=k.Cookie,b=k.opentag.Utils,c=function(){};k.Define.clazz("qubit.opentag.Session",c);var g=new k.opentag.compression.CookieCompressor({});c.readCompressedCookie=function(b){b=a.get(b,!0);return g.decompress(b)};c.setupSession=function(d){var e=d.config,k,m,n,p,s;k={};k.sessionCount=f.update(e.cookieDomain);s="qtag_"+d.getContainerId();var q="x_qtag_"+d.getContainerId();n=a.get(s);d=!!n;null===n&&(n=a.get(q,!0),n=g.decompress(n));
if(n)try{n=r.parse(n)}catch(z){n={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else n={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};m=(new Date).getTime();k.sessionCount!==parseInt(n.sc,10)?(n.sessionStartTime=m,n.sc=k.sessionCount,n.sessionCount+=1,n.referrer.push({url:c.getReferrer(),landing:b.getUrl().substring(0,300),time:m}),n.sessionLandingPage=b.getUrl().substring(0,300)):c.isReferrerDifferent()&&
!c.referrerIsSameAsPrevious(n.referrer,m,18E5)&&(n.referrer.push({url:c.getReferrer(),landing:b.getUrl().substring(0,300),time:m}),n.sessionLandingPage=b.getUrl().substring(0,300),n.sessionStartTime=m,n.sessionCount+=1);k.sessionCount=n.sessionCount;k.sessionStartTime=n.sessionStartTime;k.pageStartTime=m;n.pageViews+=1;k.pageViews=n.pageViews;k.sessionLandingPage=n.sessionLandingPage;k.referrer=n.referrer;5<k.referrer.length&&k.referrer.splice(2,k.referrer.length-5);p=r.stringify(n);for(m=0;g.compress(p).length>
e.maxCookieLength&&5>m;)3<=n.referrer.length?n.referrer.splice(2,1):2===n.referrer.length?n.referrer=[n.referrer[0]]:1===n.referrer.length&&(n.referrer=[]),p=r.stringify(n),m+=1;k.referrer=n.referrer;d&&a.rm(s);s=g.compress(p);a.rm(q);0<e.maxCookieLength&&a.set(q,s,365,e.cookieDomain,!0);k.setVariable=function(b,d,c){n.__v[b]=[d,c?c:0];b=g.compress(r.stringify(n));0<e.maxCookieLength?a.set(q,b,365,e.cookieDomain,!0):a.rm(q)};k.getCookie=function(b,d){var c=a.get(b,!0);if(c&&(d||0===b.indexOf("x_")))try{c=
g.decompress(c)}catch(e){}else null!==c&&(c=a.decode(c));return c};k.getVariable=function(a){var b;if(a=n.__v[a])if(b=a[1],0===b||b>(new Date).getTime())return a[0];return null};k.on=function(a,b,d){b.attachEvent?b.attachEvent("on"+a,d):b.addEventListener&&b.addEventListener(a,d,!1)};k.getTagCookie=function(){return c.readCompressedCookie(q)};return c.lastSession=k};c.referrerIsSameAsPrevious=function(a,e,f){var g,k;return 0<a.length?(g=c.getReferrer(),k=b.getUrl().substring(0,300),a=a[a.length-1],
a.url===g&&a.landing===k&&a.time+f>e):!1};c.isReferrerDifferent=function(){var a,b;b=c.getReferrer();a=b.indexOf("://");if(-1===a)return!0;try{return 0!==b.substring(a+3).indexOf(c.getDomain())?!0:!1}catch(f){return!0}};c.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};c.getDomain=function(){return document.location.host}})();(function(){function a(){}var b=k.opentag.LibraryTag,c=k.Define;a.library=function(){return b.define.apply(b,arguments)};a.libraryRef=
function(){return b.getLibraryByClasspath.apply(b.getLibraryByClasspath,arguments)};c.namespace("qubit.Quick",a)})();(function(){function a(b){this.runQueue=[];this.tags=[];this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1,restartable:!0};this.ignoreTagsState=!1;if(b){this.setConfig(b);b.name||(this.config.name="Cont-"+p++);a.register(this);
a.NO_PINGS&&(this.config.noPings=!0);this.ping=new k.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(b.init)try{b.init.call(this,b)}catch(d){}var c=this;this._tagLoadedHandler=function(a){c._containerAlreadySentPings&&c.sendPingsNotTooOften()}}this.events=new k.Events({});return this}function b(a,d,c,e){a[c]&&(e[c]=e[c]+1||1,c+="("+e[c]+")");a[c]=d}var c=k.opentag.Utils,f=k.opentag.filter.BaseFilter,d=k.opentag.filter.Filter,e=k.opentag.BaseTag,g=k.opentag.Timed,m=k.opentag.Tags,
n=k.opentag.Session,r=k.Cookie,p=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var b=a.getContainers(),d=0;d<b.length;d++)try{b[d].run()}catch(c){}}.bind(this)}catch(s){}k.Define.clazz("qubit.opentag.Container",a);var q=[];a.prototype.EVENT_TYPES={RESTART_EVENT:"restart"};a.register=function(a){c.addToArrayIfNotExist(q,a)};a.prototype.isTellingLoadTimes=function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=
!0;this.unregister();for(var b=0;b<this.tags.length;b++){var d=this.tags[b];c.removeFromArray(d.owningContainers,this);a&&d instanceof e&&d.destroy()}this.tags=[]};a.destroyAll=function(b){for(var d=a.getContainers(),c=0;c<d.length;c++)d[c].destroy(b)};a.findContainersByName=function(b){for(var d=a.getContainers(),c=[],e=0;e<d.length;e++)d[e].config.name===b&&c.push(d[e]);return c};a.getById=function(b){for(var d=a.getContainers(),c=0;c<d.length;c++)if(d[c].getContainerId()===b)return d[c];return null};
a.prototype.unregister=function(b){a.unregister(this,b)};a.unregister=function(a,b){c.addToArrayIfNotExist(q,a);c.removeFromArray(q,a);if(b){for(var d=0;d<a.tags.length;d++){var f=a.tags[d];f.owningContainers=[];f instanceof e&&f.unregister()}a.tags=[]}};a.prototype.hasConsent=function(){return"Accepted"===r.get("qubitconsent")};a.prototype.register=function(b){a.register(b||this)};a.getContainers=function(){return q};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=
function(a){};a.prototype.registerTag=function(a){if(c.existsInArray(a.owningContainers,this))return!1;this.tags.push(a);a.owningContainers.push(this);a.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(a)}catch(b){}return!0};a.prototype.unregisterTag=function(a){var b=a.owningContainers,d;for(d=0;d<b.length;)b[d]===this?b.splice(d,1):d++;for(d=0;d<this.tags.length;)this.tags[d]===a?this.tags.splice(d,1):d++};a.prototype.registerTags=function(a){for(var b=0;b<a.length;b++)this.registerTag(a[b])};
a.prototype.setConfig=function(a){for(var b in a)this.config[b]=a[b]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.containerScriptLoadedSynchronously=function(){var a,b,d,c,e;c=document.getElementsByTagName("script");a=0;for(b=c.length;a<b;a+=1)if(d=c[a],(e=d.getAttribute("src"))&&0<e.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===d.getAttribute("async")&&
(!1===d.getAttribute("defer")||""===d.getAttribute("defer")||null===d.getAttribute("defer"));return!0};a.prototype.prepareSessionIfNeeded=function(){var b=this.config.trackSession;if(!0!==b&&!1!==b)for(b=0;b<this.tags.length;b++){var c=this.tags[b];c.resolveAllDynamicData();for(var c=c.getFilters(),e=0;e<c.length;e++){var f=c[e];if(f instanceof d&&f.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}else this.trackSession=b;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&
(this.session=n.setupSession(this))};a.runtimeCounter=a.runtimeCounter||1;a.prototype.runTags=function(b,d){if(this.destroyed)throw"Container has been destroyed.";if(d||!a.LOCKED&&!c.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(e){}var f=!this.containerScriptLoadedSynchronously(),k="runIfFiltersPass";b&&b.command&&(k=b.command);this.runningStarted=(new Date).valueOf();this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());
this.prepareSessionIfNeeded();for(var m=this.getTagsInOrder(),n="___otctnmk"+a.runtimeCounter++,r=0;r<m.length;r++)try{var p=m[r];this.includedToRun(p)&&this._checkAndRun(p,k,f,n)}catch(s){}g.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),3100);this.waitForAllTagsToFinish();for(f=0;f<m.length;f++)m[f]._runtimeMarkers[n]=void 0,delete m[f]._runtimeMarkers[n]}};a.prototype.getTagsInOrder=function(){for(var a=[],b=0;b<this.tags.length;b++){var d=this.tags[b],c=d.config.priority;if(0<+c){for(var e=
0,f=0;f<a.length;f++){var h=a[f];if(h)if(h=+h.config.priority,0<h&&h>c)e++;else break}a.splice(e,0,d)}else a.push(d)}return a};a.prototype._checkAndRun=function(a,b,d,c){if(!a._runtimeMarkers[c]){a._runtimeMarkers[c]=!0;var e=a.resolveDependencies();if(0<e.length)for(var f=0;f<e.length;f++)this._checkAndRun(e[f],b,d,c);this._tagRunner(a,b,d)}};a.prototype._tagRunner=function(a,b,d){try{this.includedToRun(a)&&(d&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||
this.session,a[b]())}catch(c){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(b){if(!b)return!1;var d=b.config;if(d.inactive||d.disabled&&!b.cookieSaysToRunEvenIfDisabled()||b.disabledByCookie())return!1;d=a.consentIsGiven||!d.needsConsent||this.hasConsent();b=b.state===e.prototype.STATE.INITIAL;return this.ignoreTagsState||
d&&b};a.prototype.scanForTags=function(a,b){a&&(this.tags=[]);var d;d=b&&"object"===typeof b?this.findAllTags(b):this.findAllTagsByClassPath();this.registerTags(d);return d};a.prototype.findAllTags=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return m.findAllTags(a,b)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;return m.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return m.findAllFilters(a,
b)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=(new Date).valueOf(),this._containerAlreadySentPings=(new Date).valueOf(),this.sendPingsNotTooOften(),this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=
!0,this._showFinishedOnce=!1,g.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=v;a.prototype.resetAllTags=function(a){for(var b=0;b<this.tags.length;b++)this.tags[b].reset(a)};a.prototype._prepareTagsToRestart=function(a){for(var b=0;b<this.tags.length;b++)this.tags[b].prepareForRestart(a)};a.prototype.reset=function(a,b){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=
void 0;a||this.resetAllTags(b)};a.prototype.onRestart=function(a){this.events.on("restart",a)};a.prototype.restart=function(a,b){this.config.restartable&&(this.events.call("restart",this),this.reset(!0,!0),a||this._prepareTagsToRestart(b),this.run())};a.restartAll=function(b,d){for(var c=a.getContainers(),e=0;e<c.length;e++)try{c[e].restart(b,d)}catch(f){log.ERROR("Restart failed for container "+c[e].config.name,f)}};a.resetAll=function(b,d){for(var c=a.getContainers(),e=0;e<c.length;e++)try{c[e].reset(b,
d)}catch(f){log.ERROR("Reset failed for container "+c[e].config.name,f)}};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};g.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;if(this.isTellingLoadTimes()){var b=this.getAllTagsByState(),d=[];b.run&&(d=m.getLoadTimes(b.run));this.lastPingsSentTime=(new Date).valueOf();this.ping.send(this,d);var d=m.getLoadTimes(),c=[];for(a=0;a<d.length;a++){var e=d[a].tag;
e.config.dedupe&&e.sendDedupePing&&c.push(e)}0<c.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,c));if(b.other){d=m.getLoadTimes(b.other);c=[];for(a=0;a<d.length;a++)c.push(d[a]);0<c.length&&this.ping.send(this,c)}if(b.awaiting){d=m.getLoadTimes(b.awaiting);b=[];for(a=0;a<d.length;a++)b.push(d[a]);0<b.length&&this.ping.send(this,b)}}else this.ping.send(this,[])}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=
function(a){for(var d=null,c=null,h=null,g=null,k=null,m=null,n={},r=e.prototype.STATE.EXECUTED_WITH_ERRORS,p=0;p<a.length;p++){var s=a[p];if(s instanceof e){var q=s.config.name;0<s.scriptExecuted?(d=d||{},b(d,s,q,n)):s.locked?(m=m||{},b(m,s,q,n)):0>s.scriptExecuted||s.state>=r?(g=g||{},b(g,s,q)):s.filtersState()===f.state.SESSION||0<s.filtersState()?(h=h||{},b(h,s,q,n)):s.config.needsConsent?(k=k||{},b(k,s,q,n)):(c=c||{},b(c,s,q,n))}}return{run:d,failed:g,awaiting:h,consent:k,locked:m,other:c}};
a.prototype.allTagsFinished=function(){for(var a=0;a<this.tags.length;a++){var b=this.tags[a];if(b instanceof k.opentag.BaseTag){var d=b.filtersState();if(!b.config.disabled){var c=0>b.filtersState()&&!b.locked,e=!(b.finished()||b.config.runner&&!b.isRunning);if(c&&e&&(b=0<+b.awaitingDependencies,d!==f.state.SESSION&&!b))return!1}}}return!0};a.prototype.getPageVariables=function(){for(var a=[],b=0;b<this.tags.length;b++)for(var d=this.tags[b].getPageVariables(),e=0;e<d.length;e++)c.addToArrayIfNotExist(a,
d[e]);return a};a.getPageVariableByName=function(a){for(var b=this.getAllPageVariables(),d=[],c=0;c<b.length;c++)b[c].config.name===a&&d.push(b[c]);return d};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=function(){return!!r.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){r.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=
function(){r.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){c.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){r.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=function(){r.rm("qubit.opentag.forceContainerRunning")}})();(function(){function a(){}function b(a,c,f){!f||void 0!==a[c]&&""!==a[c]&&null!==a[c]||(a[c]=f)}var c=k.Cookie,f=k.opentag.Utils;k.opentag.Log.setLevelFromCookie();
a.run=function(){var b=!1,e;a:{try{var f=m.TAGSDK_MAIN_DISABLED_FUNCTION;if(f&&f()){e=!0;break a}}catch(g){}e=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1}if(!e){e=!1;if(c.get("opentag_debug_tool")||0<=document.location.href.indexOf("opentag_debug_tool"))e=!0;!e&&(e=!1,c.get("opentag_debug")||0<=document.location.href.indexOf("opentag_debug"))&&(e=!0);e&&(m.TAGSDK_NS_OVERRIDE=k.DEBUG_MODE?!1:!0,b=!0);k.DEBUG_MODE&&(m.TAGSDK_NS_OVERRIDE=!1);try{s.UVListener.init()}catch(n){}a.runAllContainers(b)}};
a.runAllContainers=function(d){try{for(var c=k.opentag.Container.getContainers(),h=0;h<c.length;h++){var g=c[h],n=g.config;if(!g.runningStarted&&!g.configuredInMain){n.scanTags=!0;var r=f.getParentObject(g.PACKAGE_NAME).ClientConfig;r&&b(g.config,"clientId",r.id);var p=f.getParentObject(g.PACKAGE_NAME).SystemDefaults;p&&(b(n,"pingServerUrl",p.pingServerUrl),b(n,"tellLoadTimesProbability",p.tellLoadTimesProbability));g.configuredInMain=!0;d?(g.destroy(!0),a.loadDebugVersion(g)):m.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?
function(){var a=k.opentag.RUN_STOPPED_EXECUTON;k.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{g.run()}}}(g):g.run()}}}catch(s){}};a.loadDebugVersion=function(a){var b=document.createElement("script"),c,f=a.config.scriptURL,h;(h=k.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&h.clientId?h=h.clientId:(h=a.PACKAGE_NAME.split("."),h=h[h.length-2].substring(1));a=a.getContainerId();f&&(c=f,c.lastIndexOf("-debug.js")!==c.length-9&&(c=c.substring(0,c.length-3),c+="-debug.js"));
b.src=c&&"//d3c3cq33003psk.cloudfront.net/opentag-"+h+"-"+a+"-debug.js"!==c?c:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+h+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(b)};k.Define.namespace("qubit.opentag.Main",a)})()})();
(function(){function b(c,f,g){this.collectLogs=!!b.COLLECT;this.collectLocally=g;this.collection=[];this.getPrefix=function(){var b="";f&&("function"===typeof f?b=f(this.ref):f.CLASS_NAME?b=f.CLASS_NAME:f.constructor&&f.constructor.name&&(b=f.constructor.name),b&&(b+=" -> "));return(c||"")+b}}function f(c,f,g,k,m,p,q,D){var H=b.LEVEL>=D;if(0<=b.COLLECT_LEVEL||H)f=m?[k,q,g]:[f+c.getPrefix()+k,p,g],f[3]=D,c.collect(f,D),H&&c.printMessage.apply(c,f)}var c=qubit.opentag.Utils,g=null;c.clazz("Log",b);
b.LEVEL_FINEST=4;b.LEVEL_FINE=3;b.LEVEL_INFO=2;b.LEVEL_WARN=1;b.LEVEL_ERROR=0;b.LEVEL_NONE=-1;b.MAX_LOG_LEN=1E4;b.prototype.MAX_LOG_LEN=-1;b.LEVEL=b.LEVEL_NONE;b.COLLECT_LEVEL=b.LEVEL_FINE;b.COLLECT=!0;var m=[];b.logsCollection=m;b.rePrintAll=function(c,f,k,m){var p=b.LEVEL;void 0!==c&&(b.LEVEL=c);try{if(b.COLLECT){try{k||g.clear()}catch(q){}var C=m||b.logsCollection,D=0;for(k=0;k<C.length;k++)(function(g){var k=C[g];g=k[3];void 0!==g&&b.LEVEL>=g&&(D++,f?setTimeout(function(){void 0!==c&&(b.LEVEL=
c);try{b.print.apply(b,k)}finally{b.LEVEL=p}},D*f):b.print.apply(b,k))})(k)}}catch(H){}finally{b.LEVEL=p}};var p=!!c.global().webkitURL;b.isStyleSupported=function(){return p};var q={};b.setConsole=function(b){return g=b=b||q};b.delayPrint=-1;var k=(new Date).valueOf();b.prototype.printMessage=function(c,f,g,m){if(0<b.delayPrint){var p=b.delayPrint,q=k-(new Date).valueOf();0<q&&(p+=q);try{setTimeout(function(){this.print(c,f,g,m)}.bind(this),p)}catch(C){setTimeout(function(){this.print(c,f,g,m)}.bind(this),
p)}k=(new Date).valueOf()+p}else this.print(c,f,g,m)};b.prototype.print=function(c,f,g,k){b.print(c,f,g,k)};b.print=function(c,f,k,m){if(!(void 0!==m&&b.LEVEL<m))try{if(g&&g.log)if(f&&b.isStyleSupported())if(k&&g[k])g[k]("%c"+c,f);else g.log("%c"+c,f);else if(k&&g[k])g[k](c);else g.log(c)}catch(p){}};b.prototype.collect=function(c,f){void 0===f&&(f=b.COLLECT_LEVEL);var g=!1,k=this.collectLogs&&b.COLLECT&&b.COLLECT_LEVEL>=+f;k&&(m.push(c),g=!0);this.collectLocally&&k&&(this.collection.push(c),g=!0);
0<b.MAX_LOG_LEN&&m.length>b.MAX_LOG_LEN&&m.splice(0,m.length-b.MAX_LOG_LEN);if(0<b.MAX_LOG_LEN||0<this.MAX_LOG_LEN)k=b.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(k=this.MAX_LOG_LEN),this.collection.length>k&&this.collection.splice(0,this.collection.length-k);return g?c:null};b.clearAllLogs=function(){try{g.clear()}catch(b){}finally{m.splice(0,m.length)}};b.getCollectedByLevel=function(b,c){c=c||m;for(var f=[],g=0;g<c.length;g++){var k=c[g];k[0][4]===b&&f.push(k)}return f};b.prototype.rePrint=function(c,f,g){b.rePrintAll(c,
f,!g,this.collection)};b.prototype.FINEST=function(c,g){f(this,"FINEST: ",!1,c,g,"color:#CCCCCC;",!1,b.LEVEL_FINEST)};b.prototype.FINE=function(c,g){f(this,"FINE: ",!1,c,g,"color:#999999;",!1,b.LEVEL_FINE)};b.prototype.INFO=function(c,g,k){f(this,"INFO: ","info",c,g,k,k,b.LEVEL_INFO)};b.prototype.WARN=function(c,g){f(this,"WARN: ","warn",c,g,"color:#26A110;",!1,b.LEVEL_WARN)};b.prototype.ERROR=function(c,g){f(this,"ERROR: ","error",c,g,"color:red;",!1,b.LEVEL_ERROR)};b.setConsole(c.global().console)})();
function fitTextarea(b){"textarea"===b.tagName.toLowerCase()&&(b.style.overflow="hidden",b.style.height="0px",b.scrollHeight,b.style.height=25+b.scrollHeight+"px",b.style.overflow="")}function nextNode(b){for(;!b.tagName;)b=b.nextSibling;return b}
function toggleShowSibling(b,f){for(var c=f||b.nextSibling;c&&!c.style;)c=c.nextSibling;if(c){var g=!1;c.cmNode&&"none"===c.cmNode.style.display?(c.cmNode.style.display="",g=!0):c.cmNode||"none"!==c.style.display?(c.style.display="none",c.cmNode&&(c.cmNode.style.display="none")):(c.style.display="",g=!0,"TEXTAREA"===c.tagName&&attachEditor(c),fitTextarea(c));(c=b.children[0])&&"true"===c.getAttribute("plus")&&(c.innerHTML=g?"-":"+")}}
function attachEditor(b){b.cm=CodeMirror.fromTextArea(b,{lineNumbers:!0,mode:"javascript",theme:"ambiance",tabMode:"indent",matchBrackets:!0,extraKeys:{"Ctrl-Q":function(b){b.foldCode(b.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]});b.cm.on("change",function(){b.value=b.cm.getValue()});b.cmNode=b.nextSibling}
function getParametersAndConfigForTagNode(b,f,c){var g=b.getElementsByTagName("input");b=b.reference.config;for(var m=0;m<g.length;m++){if(!f&&-1!==g[m].className.indexOf("red"))return"red";if(void 0!==g[m].pindex){var p=g[m].pindex;b.parameters[p].inputVariable=g[m].value;b.parameters[p].variable=void 0;if(g[m].value)try{var q=qubit.opentag.Utils.gevalAndReturn(g[m].value),q=q?q.result:q;b.parameters[p].variable={value:q}}catch(k){logError("Error reading configuration"+k)}}else if(!c&&void 0!==g[m].cname)switch(p=
g[m].cname,p){case "url":case "html":case "urlLocation":case "vendor":case "imageUrl":case "url":b[p]=g[m].value;break;default:try{b[p]=qubit.opentag.Utils.gevalAndReturn(g[m].value).result}catch(z){}}}return c?{parameters:b.parameters}:b}function applyParametersAndConfigToTag(b,f){b.parameters=f.parameters;for(var c in f)b[c]=f[c]}
function classPath(b){if(b){b=b.split(".");for(var f=0;f<b.length;f++){var c=b[f],c=c.replace(/\s+/g,"_"),c=c.replace(/[\W+]/g,"");c.match(/^\d+/)&&(c="_"+c);b[f]=c}return b.join(".").replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".")}return b}function getLibraryReferenceNode(b){for(;null!==b&&!b.reference;)b=b.parentNode;return b}window.__tmp__qubit__test_page_8_=null;
function extractFunctionOrString(b){var f=qubit.opentag.Utils.trim(b);return 0===f.indexOf("function")?(qubit.opentag.Utils.geval("window.__tmp__qubit__test_page_8_="+f),window.__tmp__qubit__test_page_8_):b}var IS_IE=!1;-1!==navigator.appName.indexOf("Internet Explorer")&&(IS_IE=!0);
function getXMLHttpRequest(){var b;try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{b=new XMLHttpRequest}catch(g){throw"Your browser does not support AJAX!";}}}IS_IE?window.onerror=function(){}:b.onerror=function(){};return b}
function GET(b,f,c){var g=getXMLHttpRequest();g.onreadystatechange=function(){4===g.readyState&&f(g.responseText,g)};c=void 0===c?!0:c;try{g.onerror=function(b){logError("Error while sending GET:"+b)}}catch(m){}b=fakeParam(b);g.open("GET",b,c);g.send()}
function POST(b,f,c,g){var m=getXMLHttpRequest();m.onreadystatechange=function(){4===m.readyState&&c(m.responseText,m)};g=void 0===g?!0:g;try{m.onerror=function(b){logError("Error while sending POST:"+b)}}catch(p){}b=fakeParam(b);m.open("POST",b,g);m.setRequestHeader("Content-type","application/x-www-form-urlencoded");m.send(f)}function fakeParam(b){return b&&-1!==b.lastIndexOf("?")?b+"&fparam="+(new Date).getTime()*Math.random():b+"?fparam="+(new Date).getTime()*Math.random()}
function theProgressBar(b,f){var c=!1,g=document.getElementById("progress-bar-template").innerHTML;if(c)return!1;theProgressBar.title=b;var c=!0,m=document.createElement("div");m.className="progress-bar";m.innerHTML=g;document.body.appendChild(m);m.bar=m.children[0].children[0];m.titleNode=m.bar.children[0];m.titleNode.innerHTML=theProgressBar.title;m.progress=m.bar.children[1];var p=function(){var b=f();100<=b?(m.titleNode.innerHTML=theProgressBar.title+" 100% Done.",m.progress.style.width="100%",
setTimeout(function(){c=!1;document.body.removeChild(m)},200)):(m.titleNode.innerHTML=theProgressBar.title+" "+Math.floor(b)+"%",m.progress.style.width=Math.floor(b)+"%",setTimeout(p,20))};p();return!0}
function qconsole(){this.init=function(){if(!this.initialized){this.initialized=!0;var b=document.getElementById("console-template").innerHTML;this.container=document.createElement("div");this.container.className="qconsole";this.container.innerHTML=b;this.msgContainer=this.container.children[1];document.body.appendChild(this.container);this.msgContainer.scrollTop=this.msgContainer.scrollHeight;var f=this;this.container.ondblclick=function(){info("[double click] Clearing & hiding console...");f.clear();
f.hide()}}};this.log=function(b){var f=document.getElementById("console-msg-template").innerHTML,c=document.createElement("div");c.className="msg";c.innerHTML=f;c.msg=c.children[1];c.header=c.children[0];c.msg.innerHTML=" >>> "+b;this.msgContainer.appendChild(c);this.msgContainer.scrollTop=this.msgContainer.scrollHeight};this.clear=function(){this.msgContainer.innerHTML=""};this.show=function(){qubit.opentag.Utils.addClass(this.container,"shown");qubit.opentag.Utils.removeClass(this.container,"hidden");
this.hidden=!1};this.hide=function(){qubit.opentag.Utils.removeClass(this.container,"shown");qubit.opentag.Utils.addClass(this.container,"hidden");this.hidden=!0};this.init()}var Utils=qubit.opentag.Utils;
function runTagHandler(b){var f=getParametersAndConfigForTagNode(b);if("red"===f)logError("Please fill all highlighed parameter values.\n They are required for tag to run.",2E3);else{var c=APP_PATH+"getClassPath?classPath=libraries."+b.reference.PACKAGE_NAME+".local&file=UVConf.js";GET(c,function(g,m){var p=!0;200!==m.status&&(p=!1,log("UVConfig not found. Proceeding normally."));try{p&&(log("Evaluating UVConf.js from "+c),qubit.opentag.Utils.geval(g))}catch(q){error("Exception while running UVConf.js: "+
q)}finally{runTag(b,f)}})}}
function runTag(b,f){try{var c={},g=b.classReference,m=b.reference;applyParametersAndConfigToTag(c,f);try{for(var p=c.parameters,q=0;q<p.length;q++)for(var k=p[q],z=0;z<m.config.parameters.length;z++){var B=m.config.parameters[z];if(B.token===k.token){k.uv=B.uv;break}}}catch(v){}var r=m.preNode.value;String(r)!==m.config.pre&&String(r)!==String(m.pre)&&(c.pre=extractFunctionOrString(r));var s=m.postNode.value;String(s)!==m.config.post&&String(s)!==String(m.post)&&(c.post=extractFunctionOrString(s));
var E=m.scriptNode.value;String(E)!==m.config.script&&String(E)!==String(m.script)&&(c.script=extractFunctionOrString(E));var C=new g(c);info("triggering run() for "+C.config.name+" ...");C.run();C.log.INFO("Currently executed tag instance is exposed as <pre>window.instance<pre>");info("Currently executed tag instance is exposed as <pre>window.instance<pre>Please open web console to see more logs.<br/>To view library the logs run:<pre>instance.log.rePrint(5);</pre>in web console.",5E3);window.instance=
C}catch(D){logError("Error while executing configuration:"+D)}}
function saveConfig(b){b=getLibraryReferenceNode(b);var f=b.reference;b=getParametersAndConfigForTagNode(b,!0,!0);for(var c=0;c<b.parameters.length;c++)b.parameters[c].variable=void 0,delete b.parameters[c].variable;b=json.serialize({parameters:b.parameters},{prettyPrint:!0});c=f.PACKAGE_NAME+".local";b=encodeURIComponent("//:import CurrentSDK\n"+("qubit.opentag.Utils.namespace('"+c+"');\n")+c+".Config = "+b+";");POST(APP_PATH+"saveConfig","classPath=libraries."+f.PACKAGE_NAME+".local&config="+b,
function(b,c){var f=qubit.opentag.Utils.gevalAndReturn(b);f&&f.result.ok?info("Saved"):logError(b)})}
function saveNewVersion(b,f){(f||window.event).ignoreEvent=!0;b=getLibraryReferenceNode(b);var c=b.reference,g=prompt("Please enter the name of the new version, eg 'v1'.\n\n");if(g){var g=classPath(g),c=c.PACKAGE_NAME,m=c.split(".");POST(APP_PATH+"saveNewVersion","location=libraries&classPath="+c+"&version="+(m[0]+"."+m[1])+"."+g,function(b,c){var f=qubit.opentag.Utils.gevalAndReturn(b);f&&f.result.ok?(info("Created new version."),info("Rebuilding system...",1E4),rebuildAndReload()):logError("Error while creating new version: "+
b)})}}function rebuildAndReload(){if(window.buildLocationString){var b="path="+encodeURIComponent(window.buildLocationString);GET(APP_PATH+"rebuild?"+b,function(b,c){var g=qubit.opentag.Utils.gevalAndReturn(b);g&&g.result.ok?(info("System has been rebuilt for "+window.buildLocationString,1E4),info("Reloading page."),location.reload()):logError("Rebuild failed! "+b)})}}var editUVURL=LIBRARIES_REPO_LOC+"shared/templates/UVConf.js";
function editUVURLHandler(b){GET(editUVURL,function(f,c){200!==c.status?logError(f):editUV(b,f)})}function editUV(b,f){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME+".local","UVConf.js",!0,f)}function openInEditorHandler(b){openInEditorAndCreate("libraries."+b.reference.PACKAGE_NAME,"Tag.js",!1)}
function openInEditorAndCreate(b,f,c,g){g="classPath="+b+"&file="+f+"&create="+!!c+"&data="+encodeURIComponent(g);POST(APP_PATH+"openInEditor",g,function(b,c){var f=qubit.opentag.Utils.gevalAndReturn(b);f&&f.result.ok||(logError(b),logError("Make sure that CLASSPATH of your library matches its location!"))})}
function reloadTagHandler(b){var f=qubit.opentag.Utils,c=b.reference,g=b.libraryWidget,m=b.classReference.versionClassPath,p="classPath=libraries."+c.PACKAGE_NAME+"&file=Tag.js";reloadTests(b);POST(APP_PATH+"getClassPath",p,function(p,k){200!==k.status&&logError("Error loading tag: "+p);try{var z=getParametersAndConfigForTagNode(b,!0,!0);try{f.getObjectUsingPath(c.PACKAGE_NAME).Tag=void 0}catch(B){}qubit.opentag.Utils.geval(p);var v=f.getObjectUsingPath(c.PACKAGE_NAME+".Tag");v.versionClassPath=m;
g.renderLibraryToNode(v,null,null,z)}catch(r){logError("Error loading tag: "+r)}})}function cancelEvent(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}var Utils=qubit.opentag.Utils,testSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/TestsSuite.js";function addEditTests(b){GET(testSuiteCodeTemplateURL,function(f,c){200!==c.status?logError(f):addEditStandardTests(b,f)})}
function addEditStandardTests(b,f){if(b=getLibraryReferenceNode(b)){var c=b.reference,g=f.replace("_PACKAGE_",c.PACKAGE_NAME),g=g.replace("_TAG_",c.PACKAGE_NAME+".Tag"),m=c.PACKAGE_NAME.split(".").join("/"),g=g.replace("_TAGPATH_",m+"/Tag.js");openInEditorAndCreate("libraries."+c.PACKAGE_NAME+".local","TestsSuite.js",!0,g)}}var bddSuiteCodeTemplateURL=LIBRARIES_REPO_LOC+"shared/templates/BDDSuite.js";
function addEditDescribeTests(b){GET(bddSuiteCodeTemplateURL,function(f,c){200!=c.status?logError(f):addEditBDDTests(b,f)})}function addEditBDDTests(b,f){if(b=getLibraryReferenceNode(b)){var c=b.reference,g=f.replace("_PACKAGE_",c.PACKAGE_NAME),g=g.replace("_TAG_",c.PACKAGE_NAME+".Tag"),m=c.PACKAGE_NAME.split(".").join("/"),g=g.replace("_TAGPATH_",m+"/Tag.js");openInEditorAndCreate("libraries."+c.PACKAGE_NAME+".local","BDDSuite.js",!0,g)}}function reloadTests(b){_reloadTest(b,"BDDSuite.js")}
function _reloadTest(b,f){var c=qubit.opentag.Utils,g=b.reference,m=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+g.PACKAGE_NAME+".local&file="+f,function(f,q){200!==q.status&&log("Error loading test (probably no tests). "+f);try{var k=getParametersAndConfigForTagNode(b,!0,!0);try{c.getObjectUsingPath(g.PACKAGE_NAME).local.TestsSuite=void 0}catch(z){}qubit.opentag.Utils.geval(f);var B=c.getObjectUsingPath(g.PACKAGE_NAME+".Tag");m.renderLibraryToNode(B,null,null,k)}catch(v){log("Error loading test: "+
v)}finally{reloadBDDTests(b)}})}
function reloadBDDTests(b){var f=qubit.opentag.Utils,c=b.reference,g=b.libraryWidget;POST(APP_PATH+"getClassPath","classPath=libraries."+c.PACKAGE_NAME+".local&file=BDDSuite.js",function(m,p){200!==p.status&&log("Error loading test (probably no tests). "+m);try{var q=getParametersAndConfigForTagNode(b,!0,!0);try{f.getObjectUsingPath(c.PACKAGE_NAME).local.BDDSuite=void 0}catch(k){}qubit.opentag.Utils.geval(m);var z=f.getObjectUsingPath(c.PACKAGE_NAME+".Tag");g.renderLibraryToNode(z,null,null,q)}catch(B){log("Error loading test: "+
B)}})}var testsRunning=!1;
function runAllTests(b){if(testsRunning)info("Wait for currently running tests to finish.");else{testsRunning=!0;for(var f=document.getElementsByTagName("div"),c=0,g=0,m=[],p=0;p<f.length;p++){var q=f[p];"true"===q.getAttribute("library-node")&&(++c,m.push(q))}var k=function(f){try{var p=m[f];p&&runTestsHandler(p,function(){++g;g<c&&setTimeout(function(){k(g)},5);g===c&&(testsRunning=!1,b&&b())})}catch(q){}};k(0);theProgressBar("Running test suites...",function(){return 0===g?0:g/c*100})}}
function runTestsHandler(b,f){try{var c=b.reference,g=qubit.opentag.Utils,m=g.getObjectUsingPath(c.PACKAGE_NAME+".local.TestsSuite"),p=g.getObjectUsingPath(c.PACKAGE_NAME+".local.BDDSuite"),q=function(){var c=!1;m&&!m.isFinished()?c=!0:p&&!p.isFinished&&(c=!0);if(!c){c=!1;if(p)for(var k=p.children,q=0;q<k.length;q++)if("failed"===k[q].result.status){c=!0;break}k=!1;m&&m.failedTests&&0<m.failedTests.length&&(k=!0);if(p||m)k||c?g.addClass(b,"tests-failed"):g.addClass(b,"tests-passed");f&&f()}};m||p?
(m&&runSuite(m,q),p&&runBDDSuite(p,q)):(f&&f(),g.addClass(b,"tests-notests"),log("No tests detected for "+c.config.name))}catch(k){logError("Error while executing tests suite:"+k)}}function runSuite(b,f){b?(b.onFinished=function(){f&&f()},b.run()):f&&f()}function runBDDSuite(b,f){if(b){var c=b.resultCallback;b.resultCallback=function(){c.apply(b,arguments);b.isFinished=!0;if(f)try{f()}catch(g){window.log("Error while running test:"+g)}};b.execute()}else f&&(b.isFinished=!0,f())}Utils=qubit.opentag.Utils;
function toggleUVSelector(b){"Close UV Browser"===b.innerHTML?(document.getElementById("uv-selector-holder").innerHTML="",b.innerHTML="Browse UV"):(openUVVariableSelector(),b.innerHTML="Close UV Browser")}function openUVVariableSelector(){var b=document.getElementById("uv-selector-holder");b.innerHTML="";renderUVSelector(b)}var uvPopupTemplate=document.getElementById("uv-popup-template").innerHTML;
function renderUVSelector(b,f){b.innerHTML="";var c=document.createElement("div");c.innerHTML=uvPopupTemplate;b.appendChild(c);var g=c.children[0].children[1].children[0].children[0],m=c.children[0].children[2];loadUVVariables(function(){for(var b=window.UVS,c=0;c<b.length;c++)(function(b){b.onclick=function(){m.value=b.expr;m.className="result";f&&f(b.expr)}})(renderUVSelectorItemYoNode(g,b[c]))})}var uvPopupItemTemplate=document.getElementById("uv-popup-item-template").innerHTML;
function renderUVSelectorItemYoNode(b,f){var c=document.createElement("div");c.innerHTML=uvPopupItemTemplate;var g=c.children[0].children[1];c.children[0].children[0].innerHTML=f.name;g.innerHTML=f.description;c.expr=f.expression;b.appendChild(c);return c}
function loadUVVariables(b){window.UVS?b&&b(UVS):GET(LIBRARIES_REPO_LOC+"shared/bin/html/data/uv.data",function(f,c){200!==c.status&&log("Error loading UV data: "+f);try{for(var g=f.split("\n"),m=[],p={},q=0;q<g.length;q++){var k=g[q].split("\t"),z={name:k[1],expression:k[2],description:k[3]};p[z.expression]=z;m.push(z)}window.UVS=m;window.EUVS=p;b(m)}catch(B){logError("Error loading UVs: "+B)}})}
(function(){function b(b,c){for(var f=0;f<c.length;f++)if("function"===typeof c[f]&&b instanceof c[f])return!0;return!1}function f(b,c){for(var f=0;f<c.length;f++)if(typeof b===c[f])return!0;return!1}function c(b,c){for(var f=0;f<c.length;f++)c[f]===b&&c.splice(f,1);return c}function g(b){return'"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}function m(b,c){return b?" "+c:c}function p(b,c,f,g,m){var p=" ";""===f&&(p="");return(f||g?0===m.length?[p,b,m.join(","),c]:[p,b,"\n",f,k,m.join(",\n"+
f+k),"\n",f,c]:[b,m.join(","),c]).join("")}var q={};q.checkIfInstanceOf=b;var k="  ",z=function(r,q,v,C,D){if(isNaN(D)||!(C>=D)){var B,F,K,a,G=!1,h,t=!0,d=!1,e=!1,L=!1,w=!1;q&&(q.prettyPrint&&(w=!0),q.raw&&(d=q.raw),q.excludedInstances&&(B=q.excludedInstances),q.excludedTypes&&(F=q.excludedTypes),q.excludedNames&&(K=q.excludedNames),q.own&&(a=q.hasOwn),q.fakeFunctions&&(e=q.fakeFunctions),q.realFunctions&&(L=q.realFunctions),q.includeFunctions&&(G=q.includeFunctions),q.excludeOnTrue&&(h=q.excludeOnTrue),
q.dateAsString&&(t=q.dateAsString));var n="",y="";if(w){for(w=0;w<C;w++)n+=k;y="\n"}if(r instanceof Date)return!d||t?g(r.toISOString()):r.valueOf();if(G||"function"!==typeof r){if("number"===typeof r)return m(n,String(r));if("string"===typeof r)return m(n,g(r));if(null===r)return m(n,"null");if(void 0===r)return d?m(n,"undefined"):void 0;if("boolean"===typeof x)return m(n,String(r));if(G&&"function"===typeof r&&e)return"(function(){})";if(G&&"function"===typeof r&&L)return m(n,r.toString());a:{if(r instanceof
Object)for(x=0;x<v.length;x++)if(v[x]===r){x=!0;break a}x=!1}if(!x){v.push(r);++C;if(r instanceof Array){K=[];for(w=0;w<r.length;w++){if(h)try{if(h(r))continue}catch(I){}if(!B||!b(r,B))if(!F||!f(r,F)){try{var A=z(r[w],q,v,C,D)}catch(M){return c(r,v),g(String(M))}void 0!==A&&K.push(A)}}c(r,v);return p("[","]",n,y,K)}var A=[],l;for(l in r){var x=r[l];if(!a||r.hasOwnProperty(l)){if(h)try{if(h(r))continue}catch(u){}if(!B||!b(x,B))if(!F||!f(x,F)){if(G=K)a:{for(G=0;G<K.length;G++)if(l===K[G]){G=!0;break a}G=
!1}if(!G)try{var J=z(x,q,v,C,D);if(void 0!==J){var N='"'+l.replace(/\"/g,'\\"')+'":'+J;A.push(N)}}catch(O){return c(r,v),g(String(O))}}}}c(r,v);return p("{","}",n,y,A)}}}};q.serialize=function(b,c){var f;c&&(f=c.level);return z(b,c,[],0,f)};var B=(0,eval("this"))||function(){return this}()||this.window;q.parse=function(b){if(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(b.replace(/"(\\.|[^"\\])*"/g,"")))throw"insecure json!";b="json.___tmp = ("+b+")";B.execScript?B.execScript(b):B.eval.call(B,b);return q.___tmp};
B.json=q;try{module.exports=q}catch(v){}})();
(function(){function b(b){b&&(this.parentContainer=b.parentContainer,this.container=b.container,this.className=b.className,this.maxTime=b.maxTime,this.closeable=b.closeable,this.init())}b.prototype.init=function(){this.container=this.container||document.createElement("div");this.container.className+=" qubit-notification "+(this.className?this.className:"")};b.prototype.drawCloseButton=function(){var b=this;this.closeable&&(this.closeButton=document.createElement("div"),0===this.container.childNodes.length?
this.container.appendChild(this.closeButton):this.container.insertBefore(this.closeButton,this.container.childNodes[0]),this.closeButton.className="notification-close-button",this.closeButton.onclick=function(){b.destroy()})};b.prototype.show=function(){this.container.style.display=""};b.prototype.hide=function(){this.container.style.display="none"};b.prototype.setContent=function(b){this.content!==b&&(this.content=b,this.container.innerHTML="","object"===typeof b?this.container.appendChild(b):this.container.innerHTML=
b,this.drawCloseButton());return b};b.prototype.paint=function(){this.painted||(this.parentContainer.appendChild(this.container),this.painted=!0)};b.prototype.destroy=function(){try{if(this.onDestroy)this.onDestroy()}finally{this.container.parentNode&&this.container.parentNode.removeChild(this.container)}};window.Notification=b})();
(function(){function b(b){b&&(this.maxTime=+b.maxTime||6E4,this.notifiers={},this.className=b.className,this.parentContainer=b.parentContainer||document.body,this.container=b.container||document.createElement("div"),this.init())}var f=window.Notification;b.prototype.notify=function(b,g,m,p,q){if(!this.notifiers[b]){m=new f({parentContainer:this.container,maxTime:m,className:p,closeable:q});var k=this;m.onDestroy=function(){delete k.notifiers[b]};this.notifiers[b]=m;m.paint()}this.notifiers[b].show();
this.notifiers[b].setContent(g);this.notifiers[b].timestamp=(new Date).valueOf()};b.prototype.done=function(b,f,m){this.notify(b,f);var p=this;setTimeout(function(){p.notifiers[b]&&(p.notifiers[b].destroy(),delete p.notifiers[b])},m)};b.prototype.init=function(){this.setParentContainer(this.parentContainer);var b=this,f;f=function(){b.container&&b.container.parentNode&&(b.oldNotifiersCheck(),setTimeout(f,500))};f()};b.prototype.setParentContainer=function(b){this.parentContainer=b;this.parentContainer.appendChild(this.container);
this.container.className.lastIndexOf(" qubit-notificationmanager"===-1)&&(this.container.className+=" qubit-notificationmanager "+this.className)};b.prototype.oldNotifiersCheck=function(){var b,f;for(b in this.notifiers)this.notifiers.hasOwnProperty(b)&&(f=this.notifiers[b].maxTime||this.maxTime,(new Date).valueOf()-this.notifiers[b].timestamp>f&&this.notifiers[b].destroy())};b.prototype.clear=function(){for(var b in this.notifiers)this.notifiers.hasOwnProperty(b)&&this.notifiers[b].destroy()};window.NotificationManager=
b})();var Utils=qubit.opentag.Utils,parameterTemplate=document.getElementById("parameter-template").innerHTML,parametersTemplate=document.getElementById("parameters-template").innerHTML;function Parameters(b){b&&(this.config=b,this.init())}Utils.clazz("ui.Parameters",Parameters);Parameters.prototype.paint=function(){this.painted=!0;this.config.parentContainer.appendChild(this.container)};
Parameters.prototype.init=function(){var b=document.createElement("div");b.innerHTML=parametersTemplate;b.className="parameters-container";this.container=b;for(var f=b.children[1].children[0],c=b.children[1].children[1],g=this.config.params,m=0;m<g.length;m++){var b=document.createElement("div"),p=g[m];b.innerHTML=parameterTemplate;var q=b.getElementsByTagName("input")[0];q.pindex=m;b.paramNode=q;b.uvNode=b.getElementsByTagName("input")[1];b.getElementsByTagName("label")[0].innerHTML=p.name+" (token: <pre style='display:inline'>"+
p.token+"</pre>)";var k=!1;p.uv?(k=!0,b.uvNode.value=p.uv):(Utils.addClass(b.uvNode,"no-uv"),b.uvNode.value="edit script to set universal variable");p=void 0!==p.inputVariable?p.inputVariable:"";q.value=p;q.className=p||k?"":"red";k&&(q.setAttribute("onfocus",null),q.setAttribute("onblur",null));f.appendChild(b)}0===g.length?(c.style.display="none",f.innerHTML="<div class='no-params'>No parameters defined.</div>"):c.style.display=""};var excluded="parameters PACKAGE dependencies CONSTRUCTOR dedupe priv name description inactive vendor loadDependenciesOnLoad variables".split(" ");
function propertyExcludedFromConfig(b){for(var f=0;f<excluded.length;f++)if(b===excluded[f])return!0;return!1}var hidden=["filterTimeout","isPrivate",,"usesDocumentWrite","timeout","singleton","locationPlaceHolder","locationDetail","locationObject","noMultipleLoad","__proto__"];function propertyHiddenFromConfig(b){for(var f=0;f<hidden.length;f++)if(b===hidden[f])return!0;return!1}
function prepareConfigElement(b,f,c){var g=document.createElement("div");g.innerHTML=c;g.children[0].className="config";g.getElementsByTagName("input")[0].cname=b;g.getElementsByTagName("label")[0].innerHTML=b;void 0!==f&&(g.getElementsByTagName("input")[0].value=f);g.getElementsByTagName("input")[0].entered=!0;return g}var configTemplate=document.getElementById("config-template").innerHTML,hiddenConfigTemplate=document.getElementById("toggled-config-template").innerHTML;
function addConfig(b,f){var c=document.createElement("div");c.innerHTML=hiddenConfigTemplate;c.className="config-header";var g=c.children[0].children[0];g.innerHTML="<span plus='true'>+</span> Configuration";toggleShowSibling(g);var m=c.children[0].children[1];b.appendChild(c);for(var p in f)propertyExcludedFromConfig(p)||propertyHiddenFromConfig(p)||(g=prepareConfigElement(p,f[p],configTemplate),m.appendChild(g));c=document.createElement("div");c.innerHTML=hiddenConfigTemplate;c.className="config-header";
m.appendChild(c);g=c.children[0].children[0];m=c.children[0].children[1];toggleShowSibling(g);g.innerHTML="<span plus='true'>+</span> Advanced";for(p in f)!propertyExcludedFromConfig(p)&&propertyHiddenFromConfig(p)&&(g=prepareConfigElement(p,f[p],configTemplate),m.appendChild(g))}var prePostTemplate=document.getElementById("pre-post-script-template").innerHTML;
function addPrePostTemplate(b,f){var c=document.createElement("div");c.innerHTML=prePostTemplate;var g=c.getElementsByTagName("textarea"),m=g[0],p=g[1],g=g[2],q=f.config.post?f.config.post:String(f.post),k=f.config.script?f.config.script:String(f.script);m.value=String(f.config.pre?f.config.pre:String(f.pre));p.value=String(q);g.value=String(k);m.style.display="none";p.style.display="none";g.style.display="none";f.preNode=m;f.postNode=p;f.scriptNode=g;b.appendChild(c)}var testTemplate=document.getElementById("unit-test-template").innerHTML;
function addTest(b,f){var c=document.createElement("div");c.innerHTML=testTemplate;c.className="unit-test";f.testNode=c;f.statusNode=c.children[0];f.nameNode=c.children[1];f.nameNode.innerHTML=f.name;f.onFinished=function(){this.failed?Utils.addClass(this.statusNode,"failed"):this.passed&&Utils.addClass(this.statusNode,"passed")};b.appendChild(c)}
function addBDDTest(b,f){var c=document.createElement("div");c.innerHTML=testTemplate;c.className="unit-test";f.testNode=c;f.statusNode=c.children[0];f.nameNode=c.children[1];f.nameNode.innerHTML=f.description;var g=f.resultCallback;f.resultCallback=function(b){g.apply(f,arguments);"failed"===f.result.status?Utils.addClass(f.statusNode,"failed"):"passed"===f.result.status&&Utils.addClass(f.statusNode,"passed")};b.appendChild(c)}var testsSuiteTemplate=document.getElementById("unit-tests-suite-template").innerHTML;
function addTestsSuite(b,f){var c=document.createElement("div");c.className="unit-tests-suite";c.innerHTML=testsSuiteTemplate;var g=Utils.getObjectUsingPath(f.PACKAGE_NAME+".local.TestsSuite"),m=Utils.getObjectUsingPath(f.PACKAGE_NAME+".local.BDDSuite");b.appendChild(c);renderTestsToNode(c.children[1],g,m)}
function renderTestsToNode(b,f,c){b.innerHTML="";if(c){c.unitTestsNode=b;c=c.children;for(var g=0;g<c.length;g++)addBDDTest(b,c[g])}if(f)for(f.unitTestsNode=b,c=f.tests,g=0;g<c.length;g++)addTest(b,c[g])}function prepareVendorNode(b){var f=document.createElement("div");f.innerHTML="<a class='plain' href='#-2'>"+b+"</a>";f.className="vendor";f.children[0].onclick=function(){var b=this.ishidden?"show":"hide";this.ishidden=!this.ishidden;this.parentNode.className="vendor "+b};return f}
function findTags(b,f){f=f||[];Utils.traverse(b,function(c,g,m,p){c&&c.prototype&&"superclass"!==m&&c.prototype instanceof qubit.opentag.BaseTag&&c!==qubit.opentag.BaseTag&&c!==qubit.opentag.LibraryTag&&c!==qubit.opentag.CustomTag&&b.Tag!==c&&f.push(c)},{objectsOnly:!0,track:!0});return f}
(function(){function b(b){this.config=b||{};b&&(this.libraryNode=document.createElement("div"),this.config.parentContainer.appendChild(this.libraryNode),this.init(this.paint.bind(this)))}new Log("Library");var f=document.getElementById("library-template").innerHTML,c=qubit.opentag.Utils;c.clazz("ui.Library",b);b.prototype.paint=function(b){this.painted=!0;this.renderLibraryToNode(this.config.libraryClass,this.libraryNode,b||"hide")};b.prototype.init=function(b){var f=APP_PATH+"getClassPath?classPath=libraries."+
this.config.libraryClass.prototype.PACKAGE_NAME+".local&file=Config.js";try{GET(f,function(f){try{c.geval(f)}catch(k){}b&&b()})}catch(p){(b,p)&&b()}};b.prototype.renderLibraryToNode=function(b,m,p,q){q=q||{};var k=new b;k.unregister();if(q.parameters&&k.config.parameters)for(var z=0;z<q.parameters.length;z++)for(var B=q.parameters[z].token,v=0;v<k.config.parameters.length;v++)k.config.parameters[v].token===B&&(k.config.parameters[v].inputVariable=q.parameters[z].inputVariable);q=k.PACKAGE_NAME+"."+
k.CLASS_NAME;m||(m=document.getElementById(q),c.removeClass(m,"tests-failed"),c.removeClass(m,"tests-passed"),c.removeClass(m,"tests-notests"));m.setAttribute("library-node","true");m.innerHTML=f;z="";b.versionClassPath&&(z=b.prototype.PACKAGE_NAME.replace(b.versionClassPath+".",""),z=z.replace(/\._(\d)/g,".$1"),z="<span class='version-title'> ("+z+") </span>");m.children[0].children[1].innerHTML=k.config.name+z+"<a href='#-3' onclick='saveNewVersion(this, arguments[0]);'> clone </a>";c.addClass(m,
"library");p&&c.addClass(m,p);m.reference=k;m.libraryWidget=this;m.classReference=b;m.id=q;b=k.config.parameters;p=m.children[7].children[0];m=m.children[7].children[1];try{var r=c.getObjectUsingPath(k.PACKAGE_NAME+".local.Config");if(r&&r.parameters)for(var s=r.parameters,r=0;r<b.length;r++){var E=b[r];for(q=0;q<s.length;q++)if(E.token&&E.token===s[q].token){var C=b[r].inputVariable,D=b[r].uv;b[r]=s[q];C&&(b[r].inputVariable=C);D&&(b[r].uv=D);break}}}catch(H){}p.children[0].innerHTML=(k.config.imageUrl?
"<img class='logo' src='"+k.config.imageUrl+"' align='right' />":"")+k.config.description;(new ui.Parameters({parentContainer:m,params:b})).paint();addConfig(m,k.config);addPrePostTemplate(m,k);addTestsSuite(m,k)}})();qubit.VENDOR_SPACE_CP="";var Utils=qubit.opentag.Utils,log=new Log("Main");window.LIBRARIES={};
function renderAllLibrariesToPage(){var b=document.getElementById("libraries");b.innerHTML="";var f=[],c=qubit.vs;if(!c)try{c=qubit.vs}catch(g){}for(var m in c)if("PACKAGE_NAME"!==m&&"CLASSPATH"!==m){var p=c[m],q=prepareVendorNode(m),k;for(k in p)try{var z=p[k].Tag,B=[m,k].join(".");if(z){var v=new z({}),B=z.prototype.PACKAGE_NAME;v.unregister();v instanceof qubit.opentag.LibraryTag&&f.push([q,z,v])}for(var r=findTags(p[k]),s=0;s<r.length;s++){var E=new r[s]({});E.unregister();r[s].versionClassPath=
B;f.push([q,r[s],E])}}catch(C){window.console&&console.log?(console.log("Failed to load tag configuration, possible syntax error:"+C),info("Failed to load tag configuration, possible syntax error:"+C)):logError("Failed to load tag configuration, possible syntax error:"+C)}f.sort(function(b,a){var c=b[1],f=a[1],g=b[2].config,d=a[2].config;return g.name===d.name?(d=g="",c.versionClassPath&&(g=c.prototype.PACKAGE_NAME.replace(c.versionClassPath+".","")),f.versionClassPath&&(d=f.prototype.PACKAGE_NAME.replace(f.versionClassPath+
".","")),compareVersions(g,d)):g.name>d.name?1:g.name===d.name?0:-1});D+=f.length;b.appendChild(q)}var D=f.length,H=0;theProgressBar("Rendering...",function(){return H/D*100});var F=!1;(function(b){var a=0,c=function(){for(var f=0;8>f;f++){H++;if(a===b.length){F||setTimeout(bodyLoaded,200);F=!0;return}var g=b[a][1],d=new ui.Library({parentContainer:b[a][0],libraryClass:g});LIBRARIES[g.PACKAGE_NAME+"."+g.CLASS_NAME]=d;a++}setTimeout(c,4)};c()})(f)}var total=1,counted=0;
function loadAllLibs(b){GET(LIBRARIES_REPO_LOC+"shared/bin/html/scripts.txt",function(f){var c=[];f=f.split(",");f.push("shared/bin/html/js/build-location.js");total=1;counted=0;if(!b){b=[];for(var g=0;g<f.length;g++)f[g]&&-1==f[g].indexOf("CurrentSDK")&&b.push(f[g])}theProgressBar("Loading scipts",function(){return 0===counted?0:counted/(b.length+total)*100});var m=0,p=function(){if(m!==b.length){var f=m;m++;var g=LIBRARIES_REPO_LOC+b[f];setTimeout(function(){_loadSingle(g,f,p,b,c)},0)}};p()})}
function compareVersions(b,f){var c=b.replace(/\./g,".").split("."),g=f.replace(/\./g,".").split("."),m=null;if(c.length&&g.length){var p=c[0].replace(/[^\d+]/g,".").split("."),p=p[p.length-1],q=g[0].replace(/[^\d+]/g,".").split("."),q=q[q.length-1],k=c[0].substring(0,c[0].lastIndexOf(p)),z=g[0].substring(0,g[0].lastIndexOf(q));k!==z||isNaN(+p)||isNaN(+q)?c[0]>g[0]?m=!0:c[0]<g[0]&&(m=!1):+p<+q?m=!0:+p>+q&&(m=!1)}if(null===m)for(p=1;p<c.length&&p<g.length;p++)if(q=g[p],k=c[p],"0"!==k.charAt(0)&&"0"!==
q.charAt(0)||0===p||(k="0."+k,q="0."+q),!isNaN(+k)&&!isNaN(+q))if(+k<+q){m=!0;break}else{if(+k>+q){m=!1;break}}else if(k<q){m=!0;break}else if(k>q){m=!1;break}c.length!==g.length&&null===m&&(m=c.length<g.length);return!0===m?1:null===m?0:-1}function _loadSingle(b,f,c,g,m){GET(b,function(p,q){try{m[f]={expr:p,url:b},log(b),counted++,g.length===counted&&_allScriptsFetched(m)}finally{c&&c()}})}
function _allScriptsFetched(b){for(var f=0;f<b.length;f++)try{eval(b[f].expr)}catch(c){logError("Failed to load: "+b[f].url+"\nException: "+c)}theProgressBar.title+=", rendering... ";listScripts(b);setTimeout(function(){counted++;renderAllLibrariesToPage();window.toggleConsole();qubit.opentag.Log.LEVEL=3;qubit.opentag.Log.COLLECT_LEVEL=5},50)}
function keepRunningTests(){-1!==location.href.indexOf("runTests=true")&&(info("Running tests..."),runAllTests(function(){countdown("Automatically running tests... ",10);setTimeout(keepRunningTests,1E4)}))}function countdown(b,f,c){if(!(0>=f)){info(b+f+(c||""),1E3,"countdown");var g=f-1;setTimeout(function(){countdown(b,g)},1E3)}}function listScripts(b){}function bodyLoaded(){setTimeout(keepRunningTests,1E3)}
window.Main=function(){window.qlog=new qconsole;window.toggleConsole=function(){qlog.hidden?qlog.show():qlog.hide()};window.logError=function(b,f){log("<span style='color: red'>"+b+"</span>");info("<span style='color: #FF766F'>"+b+"</span>",f||5E3)};window.info=function(b,f,c){DefaultNotificationsMgr.notify(c||(new Date).valueOf(),b,f||2800,"",!0);log(b)};window.log=function(b){qlog.log(b)};Suite.log=Test.log=function(b){log(b)};loadAllLibs();window.DefaultNotificationsMgr=new NotificationManager({maxTime:4E3})};
